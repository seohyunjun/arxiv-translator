<html lang="en" data-theme="light"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1310.4546] Distributed Representations of Words and Phrases and their Compositionality</title><meta property="og:description" content="The recently introduced continuous Skip-gram model is an
efficient method for learning high-quality distributed vector representations that
capture a large number of precise syntactic and semantic word
relationships. I…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Distributed Representations of Words and Phrases and their Compositionality">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Distributed Representations of Words and Phrases and their Compositionality">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1310.4546">

<!--Generated on Mon Dec 19 10:00:48 2022 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.7.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.1.css">
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
  text-align: left;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

_::-webkit-full-page-media, _:future, :root mjx-container {
  will-change: opacity;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-math {
  display: inline-block;
  text-align: left;
  line-height: 0;
  text-indent: 0;
  font-style: normal;
  font-weight: normal;
  font-size: 100%;
  font-size-adjust: none;
  letter-spacing: normal;
  border-collapse: collapse;
  word-wrap: normal;
  word-spacing: normal;
  white-space: nowrap;
  direction: ltr;
  padding: 1px 0;
}

mjx-container[jax="CHTML"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="CHTML"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="CHTML"][display="true"] mjx-math {
  padding: 0;
}

mjx-container[jax="CHTML"][justify="left"] {
  text-align: left;
}

mjx-container[jax="CHTML"][justify="right"] {
  text-align: right;
}

mjx-semantics {
  display: inline-block;
  text-align: left;
}

mjx-mrow {
  display: inline-block;
  text-align: left;
}

mjx-msub {
  display: inline-block;
  text-align: left;
}

mjx-mi {
  display: inline-block;
  text-align: left;
}

mjx-c {
  display: inline-block;
}

mjx-utext {
  display: inline-block;
  padding: .75em 0 .2em 0;
}

mjx-mn {
  display: inline-block;
  text-align: left;
}

mjx-mo {
  display: inline-block;
  text-align: left;
}

mjx-stretchy-h {
  display: inline-table;
  width: 100%;
}

mjx-stretchy-h > * {
  display: table-cell;
  width: 0;
}

mjx-stretchy-h > * > mjx-c {
  display: inline-block;
  transform: scalex(1.0000001);
}

mjx-stretchy-h > * > mjx-c::before {
  display: inline-block;
  width: initial;
}

mjx-stretchy-h > mjx-ext {
  /* IE */ overflow: hidden;
  /* others */ overflow: clip visible;
  width: 100%;
}

mjx-stretchy-h > mjx-ext > mjx-c::before {
  transform: scalex(500);
}

mjx-stretchy-h > mjx-ext > mjx-c {
  width: 0;
}

mjx-stretchy-h > mjx-beg > mjx-c {
  margin-right: -.1em;
}

mjx-stretchy-h > mjx-end > mjx-c {
  margin-left: -.1em;
}

mjx-stretchy-v {
  display: inline-block;
}

mjx-stretchy-v > * {
  display: block;
}

mjx-stretchy-v > mjx-beg {
  height: 0;
}

mjx-stretchy-v > mjx-end > mjx-c {
  display: block;
}

mjx-stretchy-v > * > mjx-c {
  transform: scaley(1.0000001);
  transform-origin: left center;
  overflow: hidden;
}

mjx-stretchy-v > mjx-ext {
  display: block;
  height: 100%;
  box-sizing: border-box;
  border: 0px solid transparent;
  /* IE */ overflow: hidden;
  /* others */ overflow: visible clip;
}

mjx-stretchy-v > mjx-ext > mjx-c::before {
  width: initial;
  box-sizing: border-box;
}

mjx-stretchy-v > mjx-ext > mjx-c {
  transform: scaleY(500) translateY(.075em);
  overflow: visible;
}

mjx-mark {
  display: inline-block;
  height: 0px;
}

mjx-mfrac {
  display: inline-block;
  text-align: left;
}

mjx-frac {
  display: inline-block;
  vertical-align: 0.17em;
  padding: 0 .22em;
}

mjx-frac[type="d"] {
  vertical-align: .04em;
}

mjx-frac[delims] {
  padding: 0 .1em;
}

mjx-frac[atop] {
  padding: 0 .12em;
}

mjx-frac[atop][delims] {
  padding: 0;
}

mjx-dtable {
  display: inline-table;
  width: 100%;
}

mjx-dtable > * {
  font-size: 2000%;
}

mjx-dbox {
  display: block;
  font-size: 5%;
}

mjx-num {
  display: block;
  text-align: center;
}

mjx-den {
  display: block;
  text-align: center;
}

mjx-mfrac[bevelled] > mjx-num {
  display: inline-block;
}

mjx-mfrac[bevelled] > mjx-den {
  display: inline-block;
}

mjx-den[align="right"], mjx-num[align="right"] {
  text-align: right;
}

mjx-den[align="left"], mjx-num[align="left"] {
  text-align: left;
}

mjx-nstrut {
  display: inline-block;
  height: .054em;
  width: 0;
  vertical-align: -.054em;
}

mjx-nstrut[type="d"] {
  height: .217em;
  vertical-align: -.217em;
}

mjx-dstrut {
  display: inline-block;
  height: .505em;
  width: 0;
}

mjx-dstrut[type="d"] {
  height: .726em;
}

mjx-line {
  display: block;
  box-sizing: border-box;
  min-height: 1px;
  height: .06em;
  border-top: .06em solid;
  margin: .06em -.1em;
  overflow: hidden;
}

mjx-line[type="d"] {
  margin: .18em -.1em;
}

mjx-munderover {
  display: inline-block;
  text-align: left;
}

mjx-munderover:not([limits="false"]) {
  padding-top: .1em;
}

mjx-munderover:not([limits="false"]) > * {
  display: block;
}

mjx-msubsup {
  display: inline-block;
  text-align: left;
}

mjx-script {
  display: inline-block;
  padding-right: .05em;
  padding-left: .033em;
}

mjx-script > mjx-spacer {
  display: block;
}

mjx-munder {
  display: inline-block;
  text-align: left;
}

mjx-over {
  text-align: left;
}

mjx-munder:not([limits="false"]) {
  display: inline-table;
}

mjx-munder > mjx-row {
  text-align: left;
}

mjx-under {
  padding-bottom: .1em;
}

mjx-mmultiscripts {
  display: inline-block;
  text-align: left;
}

mjx-prescripts {
  display: inline-table;
  padding-left: .05em;
}

mjx-scripts {
  display: inline-table;
  padding-right: .05em;
}

mjx-prescripts > mjx-row > mjx-cell {
  text-align: right;
}

[script-align="left"] > mjx-row > mjx-cell {
  text-align: left;
}

[script-align="center"] > mjx-row > mjx-cell {
  text-align: center;
}

[script-align="right"] > mjx-row > mjx-cell {
  text-align: right;
}

mjx-msup {
  display: inline-block;
  text-align: left;
}

mjx-mpadded {
  display: inline-block;
  text-align: left;
}

mjx-rbox {
  display: inline-block;
  position: relative;
}

mjx-msqrt {
  display: inline-block;
  text-align: left;
}

mjx-root {
  display: inline-block;
  white-space: nowrap;
}

mjx-surd {
  display: inline-block;
  vertical-align: top;
}

mjx-sqrt {
  display: inline-block;
  padding-top: .07em;
}

mjx-sqrt > mjx-box {
  border-top: .07em solid;
}

mjx-sqrt.mjx-tall > mjx-box {
  padding-left: .3em;
  margin-left: -.3em;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}

mjx-c.mjx-c1D464.TEX-I::before {
  padding: 0.443em 0.716em 0.011em 0;
  content: "w";
}

mjx-c.mjx-c31::before {
  padding: 0.666em 0.5em 0 0;
  content: "1";
}

mjx-c.mjx-c2C::before {
  padding: 0.121em 0.278em 0.194em 0;
  content: ",";
}

mjx-c.mjx-c32::before {
  padding: 0.666em 0.5em 0 0;
  content: "2";
}

mjx-c.mjx-c33::before {
  padding: 0.665em 0.5em 0.022em 0;
  content: "3";
}

mjx-c.mjx-c2026::before {
  padding: 0.12em 1.172em 0 0;
  content: "\2026";
}

mjx-c.mjx-c1D447.TEX-I::before {
  padding: 0.677em 0.704em 0 0;
  content: "T";
}

mjx-c.mjx-c2211.TEX-S2::before {
  padding: 0.95em 1.444em 0.45em 0;
  content: "\2211";
}

mjx-c.mjx-c1D461.TEX-I::before {
  padding: 0.626em 0.361em 0.011em 0;
  content: "t";
}

mjx-c.mjx-c3D::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "=";
}

mjx-c.mjx-c2212::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "\2212";
}

mjx-c.mjx-c1D450.TEX-I::before {
  padding: 0.442em 0.433em 0.011em 0;
  content: "c";
}

mjx-c.mjx-c2264::before {
  padding: 0.636em 0.778em 0.138em 0;
  content: "\2264";
}

mjx-c.mjx-c1D457.TEX-I::before {
  padding: 0.661em 0.412em 0.204em 0;
  content: "j";
}

mjx-c.mjx-c2260::before {
  padding: 0.716em 0.778em 0.215em 0;
  content: "\2260";
}

mjx-c.mjx-c30::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "0";
}

mjx-c.mjx-c6C::before {
  padding: 0.694em 0.278em 0 0;
  content: "l";
}

mjx-c.mjx-c6F::before {
  padding: 0.448em 0.5em 0.01em 0;
  content: "o";
}

mjx-c.mjx-c67::before {
  padding: 0.453em 0.5em 0.206em 0;
  content: "g";
}

mjx-c.mjx-c2061::before {
  padding: 0 0 0 0;
  content: "";
}

mjx-c.mjx-c1D45D.TEX-I::before {
  padding: 0.442em 0.503em 0.194em 0;
  content: "p";
}

mjx-c.mjx-c28::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: "(";
}

mjx-c.mjx-c2B::before {
  padding: 0.583em 0.778em 0.082em 0;
  content: "+";
}

mjx-c.mjx-c7C::before {
  padding: 0.75em 0.278em 0.249em 0;
  content: "|";
}

mjx-c.mjx-c29::before {
  padding: 0.75em 0.389em 0.25em 0;
  content: ")";
}

mjx-c.mjx-c1D442.TEX-I::before {
  padding: 0.704em 0.763em 0.022em 0;
  content: "O";
}

mjx-c.mjx-c1D43C.TEX-I::before {
  padding: 0.683em 0.504em 0 0;
  content: "I";
}

mjx-c.mjx-c65::before {
  padding: 0.448em 0.444em 0.011em 0;
  content: "e";
}

mjx-c.mjx-c78::before {
  padding: 0.431em 0.528em 0 0;
  content: "x";
}

mjx-c.mjx-c70::before {
  padding: 0.442em 0.556em 0.194em 0;
  content: "p";
}

mjx-c.mjx-c28.TEX-S1::before {
  padding: 0.85em 0.458em 0.349em 0;
  content: "(";
}

mjx-c.mjx-c1D463.TEX-I::before {
  padding: 0.443em 0.485em 0.011em 0;
  content: "v";
}

mjx-c.mjx-c2032::before {
  padding: 0.56em 0.275em 0 0;
  content: "\2032";
}

mjx-c.mjx-c22A4::before {
  padding: 0.668em 0.778em 0 0;
  content: "\22A4";
}

mjx-c.mjx-c29.TEX-S1::before {
  padding: 0.85em 0.458em 0.349em 0;
  content: ")";
}

mjx-c.mjx-c2211.TEX-S1::before {
  padding: 0.75em 1.056em 0.25em 0;
  content: "\2211";
}

mjx-c.mjx-c1D44A.TEX-I::before {
  padding: 0.683em 1.048em 0.022em 0;
  content: "W";
}

mjx-c.mjx-c2207::before {
  padding: 0.683em 0.833em 0.033em 0;
  content: "\2207";
}

mjx-c.mjx-c35::before {
  padding: 0.666em 0.5em 0.022em 0;
  content: "5";
}

mjx-c.mjx-c37::before {
  padding: 0.676em 0.5em 0.022em 0;
  content: "7";
}

mjx-c.mjx-c1D45B.TEX-I::before {
  padding: 0.442em 0.6em 0.011em 0;
  content: "n";
}

mjx-c.mjx-c1D43F.TEX-I::before {
  padding: 0.683em 0.681em 0 0;
  content: "L";
}

mjx-c.mjx-c72::before {
  padding: 0.442em 0.392em 0 0;
  content: "r";
}

mjx-c.mjx-c74::before {
  padding: 0.615em 0.389em 0.01em 0;
  content: "t";
}

mjx-c.mjx-c63::before {
  padding: 0.448em 0.444em 0.011em 0;
  content: "c";
}

mjx-c.mjx-c68::before {
  padding: 0.694em 0.556em 0 0;
  content: "h";
}

mjx-c.mjx-c5B::before {
  padding: 0.75em 0.278em 0.25em 0;
  content: "[";
}

mjx-c.mjx-c1D465.TEX-I::before {
  padding: 0.442em 0.572em 0.011em 0;
  content: "x";
}

mjx-c.mjx-c5D::before {
  padding: 0.75em 0.278em 0.25em 0;
  content: "]";
}

mjx-c.mjx-c220F.TEX-S2::before {
  padding: 0.95em 1.278em 0.45em 0;
  content: "\220F";
}

mjx-c.mjx-c1D70E.TEX-I::before {
  padding: 0.431em 0.571em 0.011em 0;
  content: "\3C3";
}

mjx-c.mjx-c28.TEX-S2::before {
  padding: 1.15em 0.597em 0.649em 0;
  content: "(";
}

mjx-c.mjx-c22C5::before {
  padding: 0.31em 0.278em 0 0;
  content: "\22C5";
}

mjx-c.mjx-c29.TEX-S2::before {
  padding: 1.15em 0.597em 0.649em 0;
  content: ")";
}

mjx-c.mjx-c2F::before {
  padding: 0.75em 0.5em 0.25em 0;
  content: "/";
}

mjx-c.mjx-c1D458.TEX-I::before {
  padding: 0.694em 0.521em 0.011em 0;
  content: "k";
}

mjx-c.mjx-c1D456.TEX-I::before {
  padding: 0.661em 0.345em 0.011em 0;
  content: "i";
}

mjx-c.mjx-c1D53C.TEX-A::before {
  padding: 0.683em 0.667em 0 0;
  content: "E";
}

mjx-c.mjx-c223C::before {
  padding: 0.367em 0.778em 0 0;
  content: "\223C";
}

mjx-c.mjx-c1D443.TEX-I::before {
  padding: 0.683em 0.751em 0 0;
  content: "P";
}

mjx-c.mjx-c5B.TEX-S1::before {
  padding: 0.85em 0.417em 0.349em 0;
  content: "[";
}

mjx-c.mjx-c5D.TEX-S1::before {
  padding: 0.85em 0.417em 0.349em 0;
  content: "]";
}

mjx-c.mjx-c1D448.TEX-I::before {
  padding: 0.683em 0.767em 0.022em 0;
  content: "U";
}

mjx-c.mjx-c34::before {
  padding: 0.677em 0.5em 0 0;
  content: "4";
}

mjx-c.mjx-c1D44D.TEX-I::before {
  padding: 0.683em 0.723em 0 0;
  content: "Z";
}

mjx-c.mjx-c221A.TEX-S4::before {
  padding: 1.75em 1.02em 1.25em 0;
  content: "\221A";
}

mjx-c.mjx-c1D453.TEX-I::before {
  padding: 0.705em 0.55em 0.205em 0;
  content: "f";
}

mjx-c.mjx-c1D431.TEX-B::before {
  padding: 0.444em 0.607em 0 0;
  content: "x";
}

mjx-c.mjx-c73::before {
  padding: 0.448em 0.394em 0.011em 0;
  content: "s";
}

mjx-c.mjx-c75::before {
  padding: 0.442em 0.556em 0.011em 0;
  content: "u";
}

mjx-c.mjx-c6E::before {
  padding: 0.442em 0.556em 0 0;
  content: "n";
}

mjx-c.mjx-c1D6FF.TEX-I::before {
  padding: 0.717em 0.444em 0.01em 0;
  content: "\3B4";
}

mjx-c.mjx-cD7::before {
  padding: 0.491em 0.778em 0 0;
  content: "\D7";
}

mjx-c.mjx-c2E::before {
  padding: 0.12em 0.278em 0 0;
  content: ".";
}
</style></head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Distributed Representations of Words and Phrases 
<br class="ltx_break">and their Compositionality</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Tomas Mikolov
<br class="ltx_break">Google Inc.
<br class="ltx_break">Mountain View 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">mikolov@google.com</span> 
<br class="ltx_break">&amp;Ilya Sutskever 
<br class="ltx_break">Google Inc. 
<br class="ltx_break">Mountain View 
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">ilyasu@google.com</span> 
<br class="ltx_break">&amp;Kai Chen 
<br class="ltx_break">Google Inc. 
<br class="ltx_break">Mountain View 
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">kai@google.com</span> 
<br class="ltx_break">&amp;Greg Corrado 
<br class="ltx_break">Google Inc. 
<br class="ltx_break">Mountain View 
<br class="ltx_break"><span id="id4.4.id4" class="ltx_text ltx_font_typewriter">gcorrado@google.com</span> 
<br class="ltx_break">&amp;Jeffrey Dean 
<br class="ltx_break">Google Inc. 
<br class="ltx_break">Mountain View 
<br class="ltx_break"><span id="id5.5.id5" class="ltx_text ltx_font_typewriter">jeff@google.com</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id6.id1" class="ltx_p">The recently introduced continuous Skip-gram model is an
efficient method for learning high-quality distributed vector representations that
capture a large number of precise syntactic and semantic word
relationships. In this paper we present several extensions that improve both
the quality of the vectors and the training speed.
By subsampling of the frequent words we obtain significant speedup
and also learn more regular word representations. We also describe a simple
alternative to the hierarchical softmax called negative sampling.</p>
<p id="id7.id2" class="ltx_p">An inherent limitation of word representations is their indifference
to word order and their inability to represent idiomatic phrases. For
example, the meanings of “Canada” and “Air” cannot be easily
combined to obtain “Air Canada”. Motivated by
this example, we present a simple method for finding
phrases in text, and show that learning good vector
representations for millions of phrases is possible.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Distributed representations of words in a vector space
help learning algorithms to achieve
better performance in natural language processing tasks by grouping
similar words. One of the earliest use of word representations
dates back to 1986 due to Rumelhart, Hinton, and Williams&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.
This idea has since been applied to statistical language modeling with considerable
success&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The follow up work includes
applications to automatic speech recognition and machine translation&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>,
and a wide range of NLP tasks&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Recently, Mikolov et al.&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> introduced the Skip-gram
model, an efficient method for learning high-quality vector
representations of words from large amounts of unstructured text data.
Unlike most of the previously used neural network architectures
for learning word vectors, training of the Skip-gram model (see Figure&nbsp;<a href="#S2.F1" title="Figure 1 ‣ 2 The Skip-gram Model ‣ Distributed Representations of Words and Phrases and their Compositionality" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>)
does not involve dense matrix multiplications. This makes the training
extremely efficient: an optimized single-machine implementation can train
on more than 100 billion words in one day.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">The word representations computed using neural networks are
very interesting because the learned vectors explicitly
encode many linguistic regularities and patterns.
Somewhat surprisingly, many of these patterns can be represented
as linear translations.
For example, the result of a vector calculation
vec(“Madrid”) - vec(“Spain”) + vec(“France”) is closer to
vec(“Paris”) than to any other word vector&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">In this paper we present several extensions of the
original Skip-gram model. We show that subsampling of frequent
words during training results in a significant speedup (around 2x - 10x), and improves
accuracy of the representations of less frequent words.
In addition, we present a simplified variant of Noise Contrastive
Estimation (NCE)&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> for training the Skip-gram model that
results in faster training and better vector representations for
frequent words, compared to more complex hierarchical softmax that
was used in the prior work&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">Word representations are limited by their inability to
represent idiomatic phrases that are not compositions of the individual
words. For example, “Boston Globe” is a newspaper, and so it is not a
natural combination of the meanings of “Boston” and “Globe”.
Therefore, using vectors to represent
the whole phrases makes the Skip-gram model considerably more
expressive. Other techniques that aim to represent meaning of sentences
by composing the word vectors, such as the
recursive autoencoders&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, would also benefit from using
phrase vectors instead of the word vectors.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">The extension from word based to phrase based models is relatively simple.
First we identify a large number of
phrases using a data-driven approach, and then we treat the phrases as
individual tokens during the training. To evaluate the quality of the
phrase vectors, we developed a test set of analogical reasoning tasks that
contains both words and phrases. A typical analogy pair from our test set
is “Montreal”:“Montreal Canadiens”::“Toronto”:“Toronto Maple Leafs”.
It is considered to have been answered correctly if the
nearest representation to vec(“Montreal Canadiens”) - vec(“Montreal”)
+ vec(“Toronto”) is vec(“Toronto Maple Leafs”).</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p">Finally, we describe another interesting property of the Skip-gram
model. We found that simple vector addition can often produce meaningful
results. For example, vec(“Russia”) + vec(“river”)
is close to vec(“Volga River”), and
vec(“Germany”) + vec(“capital”) is close to vec(“Berlin”).
This compositionality suggests that a non-obvious degree of
language understanding can be obtained by using basic mathematical
operations on the word vector representations.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>The Skip-gram Model</h2>

<figure id="S2.F1" class="ltx_figure">
<p id="S2.F1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S2.F1.1.1" class="ltx_text"><img src="/html/1310.4546/assets/x1.png" id="S2.F1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="380" height="492" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The Skip-gram model architecture. The training objective
is to learn word vector representations that are good at predicting the nearby words.</figcaption>
</figure>
<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">The training objective of the Skip-gram model is to find word
representations that are useful for predicting the surrounding words in a sentence
or a document.
More formally, given a sequence of training words <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="0" style="font-size: 121.1%; position: relative;"><mjx-math id="S2.p1.1.m1.5" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.1.m1.5a"><mjx-mrow id="S2.p1.1.m1.5.5.4" xref="S2.p1.1.m1.5.5.5.cmml"><mjx-msub id="S2.p1.1.m1.2.2.1.1" xref="S2.p1.1.m1.2.2.1.1.cmml"><mjx-mi class="mjx-i" id="S2.p1.1.m1.2.2.1.1.2" xref="S2.p1.1.m1.2.2.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s" id="S2.p1.1.m1.2.2.1.1.3" xref="S2.p1.1.m1.2.2.1.1.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.p1.1.m1.5.5.4.5" xref="S2.p1.1.m1.5.5.5.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2" id="S2.p1.1.m1.3.3.2.2" xref="S2.p1.1.m1.3.3.2.2.cmml"><mjx-mi class="mjx-i" id="S2.p1.1.m1.3.3.2.2.2" xref="S2.p1.1.m1.3.3.2.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s" id="S2.p1.1.m1.3.3.2.2.3" xref="S2.p1.1.m1.3.3.2.2.3.cmml"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.p1.1.m1.5.5.4.6" xref="S2.p1.1.m1.5.5.5.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2" id="S2.p1.1.m1.4.4.3.3" xref="S2.p1.1.m1.4.4.3.3.cmml"><mjx-mi class="mjx-i" id="S2.p1.1.m1.4.4.3.3.2" xref="S2.p1.1.m1.4.4.3.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mn class="mjx-n" size="s" id="S2.p1.1.m1.4.4.3.3.3" xref="S2.p1.1.m1.4.4.3.3.3.cmml"><mjx-c class="mjx-c33"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.p1.1.m1.5.5.4.7" xref="S2.p1.1.m1.5.5.5.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="2" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mjx-c class="mjx-c2026"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.p1.1.m1.5.5.4.8" xref="S2.p1.1.m1.5.5.5.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2" id="S2.p1.1.m1.5.5.4.4" xref="S2.p1.1.m1.5.5.4.4.cmml"><mjx-mi class="mjx-i" id="S2.p1.1.m1.5.5.4.4.2" xref="S2.p1.1.m1.5.5.4.4.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.p1.1.m1.5.5.4.4.3" xref="S2.p1.1.m1.5.5.4.4.3.cmml"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w_{1},w_{2},w_{3},\ldots,w_{T}" display="inline" class="ltx_Math"><semantics><mrow xref="S2.p1.1.m1.5.5.5.cmml"><msub xref="S2.p1.1.m1.2.2.1.1.cmml"><mi xref="S2.p1.1.m1.2.2.1.1.2.cmml">w</mi><mn xref="S2.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo xref="S2.p1.1.m1.5.5.5.cmml">,</mo><msub xref="S2.p1.1.m1.3.3.2.2.cmml"><mi xref="S2.p1.1.m1.3.3.2.2.2.cmml">w</mi><mn xref="S2.p1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo xref="S2.p1.1.m1.5.5.5.cmml">,</mo><msub xref="S2.p1.1.m1.4.4.3.3.cmml"><mi xref="S2.p1.1.m1.4.4.3.3.2.cmml">w</mi><mn xref="S2.p1.1.m1.4.4.3.3.3.cmml">3</mn></msub><mo xref="S2.p1.1.m1.5.5.5.cmml">,</mo><mi mathvariant="normal" xref="S2.p1.1.m1.1.1.cmml">…</mi><mo xref="S2.p1.1.m1.5.5.5.cmml">,</mo><msub xref="S2.p1.1.m1.5.5.4.4.cmml"><mi xref="S2.p1.1.m1.5.5.4.4.2.cmml">w</mi><mi xref="S2.p1.1.m1.5.5.4.4.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content"><list xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.1.m1.5.5.5.cmml" xref="S2.p1.1.m1.5.5.4"><apply id="S2.p1.1.m1.2.2.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.2.2.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S2.p1.1.m1.2.2.1.1.2.cmml" xref="S2.p1.1.m1.2.2.1.1.2">𝑤</ci><cn type="integer" id="S2.p1.1.m1.2.2.1.1.3.cmml" xref="S2.p1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S2.p1.1.m1.3.3.2.2.cmml" xref="S2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.3.3.2.2.1.cmml" xref="S2.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S2.p1.1.m1.3.3.2.2.2.cmml" xref="S2.p1.1.m1.3.3.2.2.2">𝑤</ci><cn type="integer" id="S2.p1.1.m1.3.3.2.2.3.cmml" xref="S2.p1.1.m1.3.3.2.2.3">2</cn></apply><apply id="S2.p1.1.m1.4.4.3.3.cmml" xref="S2.p1.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S2.p1.1.m1.4.4.3.3.1.cmml" xref="S2.p1.1.m1.4.4.3.3">subscript</csymbol><ci id="S2.p1.1.m1.4.4.3.3.2.cmml" xref="S2.p1.1.m1.4.4.3.3.2">𝑤</ci><cn type="integer" id="S2.p1.1.m1.4.4.3.3.3.cmml" xref="S2.p1.1.m1.4.4.3.3.3">3</cn></apply><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">…</ci><apply id="S2.p1.1.m1.5.5.4.4.cmml" xref="S2.p1.1.m1.5.5.4.4"><csymbol cd="ambiguous" id="S2.p1.1.m1.5.5.4.4.1.cmml" xref="S2.p1.1.m1.5.5.4.4">subscript</csymbol><ci id="S2.p1.1.m1.5.5.4.4.2.cmml" xref="S2.p1.1.m1.5.5.4.4.2">𝑤</ci><ci id="S2.p1.1.m1.5.5.4.4.3.cmml" xref="S2.p1.1.m1.5.5.4.4.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex">w_{1},w_{2},w_{3},\ldots,w_{T}</annotation><annotation encoding="application/x-llamapun">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container>, the objective of the Skip-gram model is to maximize
the average log probability</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="1" style="font-size: 121.1%; position: relative;"><mjx-math id="S2.E1.m1.3" class="ltx_Math MJX-TEX" display="true" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-semantics id="S2.E1.m1.3a"><mjx-mrow id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml"><mjx-mfrac id="S2.E1.m1.3.3.3" xref="S2.E1.m1.3.3.3.cmml"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mn class="mjx-n" id="S2.E1.m1.3.3.3.2" xref="S2.E1.m1.3.3.3.2.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mi class="mjx-i" id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.3.cmml"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac><mjx-mo class="mjx-n" id="S2.E1.m1.3.3.2" xref="S2.E1.m1.3.3.2.cmml"></mjx-mo><mjx-mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.cmml"><mjx-munderover space="1" id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.2.cmml"><mjx-over style="padding-bottom: 0.2em; padding-left: 0.473em;"><mjx-mi class="mjx-i" size="s" id="S2.E1.m1.3.3.1.2.3" xref="S2.E1.m1.3.3.1.2.3.cmml"><mjx-c class="mjx-c1D447 TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop" id="S2.E1.m1.3.3.1.2.2.2" xref="S2.E1.m1.3.3.1.2.2.2.cmml"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.143em;"><mjx-mrow size="s" id="S2.E1.m1.3.3.1.2.2.3" xref="S2.E1.m1.3.3.1.2.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E1.m1.3.3.1.2.2.3.2" xref="S2.E1.m1.3.3.1.2.2.3.2.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E1.m1.3.3.1.2.2.3.1" xref="S2.E1.m1.3.3.1.2.2.3.1.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.E1.m1.3.3.1.2.2.3.3" xref="S2.E1.m1.3.3.1.2.2.3.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mjx-munder id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><mjx-row><mjx-base style="padding-left: 1.251em;"><mjx-mo class="mjx-lop" id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em;"><mjx-mrow size="s" id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.3.cmml"><mjx-mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mjx-mrow id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml"><mjx-mo class="mjx-n" id="S2.E1.m1.1.1.1.1.1.2a" xref="S2.E1.m1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E1.m1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E1.m1.1.1.1.1.1.4" xref="S2.E1.m1.1.1.1.1.1.4.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E1.m1.1.1.1.1.1.5" xref="S2.E1.m1.1.1.1.1.1.5.cmml"><mjx-c class="mjx-c2264"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E1.m1.1.1.1.1.1.6" xref="S2.E1.m1.1.1.1.1.1.6.cmml"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.E1.m1.2.2.2.2.3" xref="S2.E1.m1.2.2.2.3a.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mrow id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.cmml"><mjx-mi class="mjx-i" id="S2.E1.m1.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E1.m1.2.2.2.2.2.1" xref="S2.E1.m1.2.2.2.2.2.1.cmml"><mjx-c class="mjx-c2260"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.E1.m1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.3.cmml"><mjx-c class="mjx-c30"></mjx-c></mjx-mn></mjx-mrow></mjx-mrow></mjx-under></mjx-row></mjx-munder><mjx-mrow space="2" id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml"><mjx-mrow id="S2.E1.m1.3.3.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.3.cmml"><mjx-mi class="mjx-n" id="S2.E1.m1.3.3.1.1.1.3.1" xref="S2.E1.m1.3.3.1.1.1.3.1.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="2" id="S2.E1.m1.3.3.1.1.1.3a" xref="S2.E1.m1.3.3.1.1.1.3.cmml" style="margin-right: 0.056em;"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E1.m1.3.3.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.E1.m1.3.3.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E1.m1.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E1.m1.3.3.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mjx-msub id="S2.E1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mrow size="s" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.1.cmml"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.E1.m1.3.3.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.E1.m1.3.3.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\frac{1}{T}\sum_{t=1}^{T}\sum_{-c\leq j\leq c,j\neq 0}\log p(w_{t+j}|w_{t})" display="block" class="ltx_Math"><semantics><mrow xref="S2.E1.m1.3.3.cmml"><mfrac xref="S2.E1.m1.3.3.3.cmml"><mn xref="S2.E1.m1.3.3.3.2.cmml">1</mn><mi xref="S2.E1.m1.3.3.3.3.cmml">T</mi></mfrac><mo xref="S2.E1.m1.3.3.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E1.m1.3.3.1.cmml"><munderover xref="S2.E1.m1.3.3.1.2.cmml"><mo movablelimits="false" rspace="0em" xref="S2.E1.m1.3.3.1.2.2.2.cmml">∑</mo><mrow xref="S2.E1.m1.3.3.1.2.2.3.cmml"><mi xref="S2.E1.m1.3.3.1.2.2.3.2.cmml">t</mi><mo xref="S2.E1.m1.3.3.1.2.2.3.1.cmml">=</mo><mn xref="S2.E1.m1.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi xref="S2.E1.m1.3.3.1.2.3.cmml">T</mi></munderover><mrow xref="S2.E1.m1.3.3.1.1.cmml"><munder xref="S2.E1.m1.3.3.1.1.2.cmml"><mo movablelimits="false" xref="S2.E1.m1.3.3.1.1.2.2.cmml">∑</mo><mrow xref="S2.E1.m1.2.2.2.3.cmml"><mrow xref="S2.E1.m1.1.1.1.1.1.cmml"><mrow xref="S2.E1.m1.1.1.1.1.1.2.cmml"><mo xref="S2.E1.m1.1.1.1.1.1.2.cmml">−</mo><mi xref="S2.E1.m1.1.1.1.1.1.2.2.cmml">c</mi></mrow><mo xref="S2.E1.m1.1.1.1.1.1.3.cmml">≤</mo><mi xref="S2.E1.m1.1.1.1.1.1.4.cmml">j</mi><mo xref="S2.E1.m1.1.1.1.1.1.5.cmml">≤</mo><mi xref="S2.E1.m1.1.1.1.1.1.6.cmml">c</mi></mrow><mo xref="S2.E1.m1.2.2.2.3a.cmml">,</mo><mrow xref="S2.E1.m1.2.2.2.2.2.cmml"><mi xref="S2.E1.m1.2.2.2.2.2.2.cmml">j</mi><mo xref="S2.E1.m1.2.2.2.2.2.1.cmml">≠</mo><mn xref="S2.E1.m1.2.2.2.2.2.3.cmml">0</mn></mrow></mrow></munder><mrow xref="S2.E1.m1.3.3.1.1.1.cmml"><mrow xref="S2.E1.m1.3.3.1.1.1.3.cmml"><mi xref="S2.E1.m1.3.3.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" xref="S2.E1.m1.3.3.1.1.1.3.cmml">⁡</mo><mi xref="S2.E1.m1.3.3.1.1.1.3.2.cmml">p</mi></mrow><mo xref="S2.E1.m1.3.3.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><msub xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><mi xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml">w</mi><mrow xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">+</mo><mi xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo fence="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml">|</mo><msub xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3"><times id="S2.E1.m1.3.3.2.cmml" xref="S2.E1.m1.3.3.2"></times><apply id="S2.E1.m1.3.3.3.cmml" xref="S2.E1.m1.3.3.3"><divide id="S2.E1.m1.3.3.3.1.cmml" xref="S2.E1.m1.3.3.3"></divide><cn type="integer" id="S2.E1.m1.3.3.3.2.cmml" xref="S2.E1.m1.3.3.3.2">1</cn><ci id="S2.E1.m1.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3">𝑇</ci></apply><apply id="S2.E1.m1.3.3.1.cmml" xref="S2.E1.m1.3.3.1"><apply id="S2.E1.m1.3.3.1.2.cmml" xref="S2.E1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.2.1.cmml" xref="S2.E1.m1.3.3.1.2">superscript</csymbol><apply id="S2.E1.m1.3.3.1.2.2.cmml" xref="S2.E1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.2">subscript</csymbol><sum id="S2.E1.m1.3.3.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.2.2.2"></sum><apply id="S2.E1.m1.3.3.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.2.2.3"><eq id="S2.E1.m1.3.3.1.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.2.2.3.1"></eq><ci id="S2.E1.m1.3.3.1.2.2.3.2.cmml" xref="S2.E1.m1.3.3.1.2.2.3.2">𝑡</ci><cn type="integer" id="S2.E1.m1.3.3.1.2.2.3.3.cmml" xref="S2.E1.m1.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.3.3.1.2.3.cmml" xref="S2.E1.m1.3.3.1.2.3">𝑇</ci></apply><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1"><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"></sum><apply id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.3a.cmml" xref="S2.E1.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><and id="S2.E1.m1.1.1.1.1.1a.cmml" xref="S2.E1.m1.1.1.1.1.1"></and><apply id="S2.E1.m1.1.1.1.1.1b.cmml" xref="S2.E1.m1.1.1.1.1.1"><leq id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3"></leq><apply id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"><minus id="S2.E1.m1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2"></minus><ci id="S2.E1.m1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2">𝑐</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.1.1.1.1.1.4">𝑗</ci></apply><apply id="S2.E1.m1.1.1.1.1.1c.cmml" xref="S2.E1.m1.1.1.1.1.1"><leq id="S2.E1.m1.1.1.1.1.1.5.cmml" xref="S2.E1.m1.1.1.1.1.1.5"></leq><share href="#S2.E1.m1.1.1.1.1.1.4.cmml" id="S2.E1.m1.1.1.1.1.1d.cmml" xref="S2.E1.m1.1.1.1.1.1"></share><ci id="S2.E1.m1.1.1.1.1.1.6.cmml" xref="S2.E1.m1.1.1.1.1.1.6">𝑐</ci></apply></apply><apply id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2"><neq id="S2.E1.m1.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.1"></neq><ci id="S2.E1.m1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2">𝑗</ci><cn type="integer" id="S2.E1.m1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.3">0</cn></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.2"></times><apply id="S2.E1.m1.3.3.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.3"><log id="S2.E1.m1.3.3.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.3.1"></log><ci id="S2.E1.m1.3.3.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2">𝑤</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3"><plus id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.1"></plus><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">\frac{1}{T}\sum_{t=1}^{T}\sum_{-c\leq j\leq c,j\neq 0}\log p(w_{t+j}|w_{t})</annotation><annotation encoding="application/x-llamapun">divide start_ARG 1 end_ARG start_ARG italic_T end_ARG ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT - italic_c ≤ italic_j ≤ italic_c , italic_j ≠ 0 end_POSTSUBSCRIPT roman_log italic_p ( italic_w start_POSTSUBSCRIPT italic_t + italic_j end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.5" class="ltx_p">where <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="2" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.2.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.2.m1.1a"><mjx-mi class="mjx-i" id="S2.p1.2.m1.1.1" xref="S2.p1.2.m1.1.1.cmml"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline" class="ltx_Math"><semantics><mi xref="S2.p1.2.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.2.m1.1.1.cmml" xref="S2.p1.2.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex">c</annotation><annotation encoding="application/x-llamapun">italic_c</annotation></semantics></math></mjx-assistive-mml></mjx-container> is the size of the training context (which can be a function
of the center word <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="3" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.3.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.3.m2.1a"><mjx-msub id="S2.p1.3.m2.1.1" xref="S2.p1.3.m2.1.1.cmml"><mjx-mi class="mjx-i" id="S2.p1.3.m2.1.1.2" xref="S2.p1.3.m2.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.p1.3.m2.1.1.3" xref="S2.p1.3.m2.1.1.3.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w_{t}" display="inline" class="ltx_Math"><semantics><msub xref="S2.p1.3.m2.1.1.cmml"><mi xref="S2.p1.3.m2.1.1.2.cmml">w</mi><mi xref="S2.p1.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.3.m2.1.1.cmml" xref="S2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m2.1.1.1.cmml" xref="S2.p1.3.m2.1.1">subscript</csymbol><ci id="S2.p1.3.m2.1.1.2.cmml" xref="S2.p1.3.m2.1.1.2">𝑤</ci><ci id="S2.p1.3.m2.1.1.3.cmml" xref="S2.p1.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex">w_{t}</annotation><annotation encoding="application/x-llamapun">italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container>). Larger <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="4" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.4.m3.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.4.m3.1a"><mjx-mi class="mjx-i" id="S2.p1.4.m3.1.1" xref="S2.p1.4.m3.1.1.cmml"><mjx-c class="mjx-c1D450 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="c" display="inline" class="ltx_Math"><semantics><mi xref="S2.p1.4.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.4.m3.1.1.cmml" xref="S2.p1.4.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex">c</annotation><annotation encoding="application/x-llamapun">italic_c</annotation></semantics></math></mjx-assistive-mml></mjx-container> results in more
training examples and thus can lead to a higher accuracy, at the
expense of the training time. The basic Skip-gram formulation defines
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="5" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.5.m4.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.5.m4.1a"><mjx-mrow id="S2.p1.5.m4.1.1" xref="S2.p1.5.m4.1.1.cmml"><mjx-mi class="mjx-i" id="S2.p1.5.m4.1.1.3" xref="S2.p1.5.m4.1.1.3.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.p1.5.m4.1.1.2" xref="S2.p1.5.m4.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.p1.5.m4.1.1.1.1" xref="S2.p1.5.m4.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.p1.5.m4.1.1.1.1.2" xref="S2.p1.5.m4.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.p1.5.m4.1.1.1.1.1" xref="S2.p1.5.m4.1.1.1.1.1.cmml"><mjx-msub id="S2.p1.5.m4.1.1.1.1.1.2" xref="S2.p1.5.m4.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.p1.5.m4.1.1.1.1.1.2.2" xref="S2.p1.5.m4.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mrow size="s" id="S2.p1.5.m4.1.1.1.1.1.2.3" xref="S2.p1.5.m4.1.1.1.1.1.2.3.cmml"><mjx-mi class="mjx-i" id="S2.p1.5.m4.1.1.1.1.1.2.3.2" xref="S2.p1.5.m4.1.1.1.1.1.2.3.2.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.p1.5.m4.1.1.1.1.1.2.3.1" xref="S2.p1.5.m4.1.1.1.1.1.2.3.1.cmml"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.p1.5.m4.1.1.1.1.1.2.3.3" xref="S2.p1.5.m4.1.1.1.1.1.2.3.3.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.p1.5.m4.1.1.1.1.1.1" xref="S2.p1.5.m4.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.p1.5.m4.1.1.1.1.1.3" xref="S2.p1.5.m4.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.p1.5.m4.1.1.1.1.1.3.2" xref="S2.p1.5.m4.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.p1.5.m4.1.1.1.1.1.3.3" xref="S2.p1.5.m4.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.p1.5.m4.1.1.1.1.3" xref="S2.p1.5.m4.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="p(w_{t+j}|w_{t})" display="inline" class="ltx_Math"><semantics><mrow xref="S2.p1.5.m4.1.1.cmml"><mi xref="S2.p1.5.m4.1.1.3.cmml">p</mi><mo xref="S2.p1.5.m4.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.p1.5.m4.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.p1.5.m4.1.1.1.1.1.cmml">(</mo><mrow xref="S2.p1.5.m4.1.1.1.1.1.cmml"><msub xref="S2.p1.5.m4.1.1.1.1.1.2.cmml"><mi xref="S2.p1.5.m4.1.1.1.1.1.2.2.cmml">w</mi><mrow xref="S2.p1.5.m4.1.1.1.1.1.2.3.cmml"><mi xref="S2.p1.5.m4.1.1.1.1.1.2.3.2.cmml">t</mi><mo xref="S2.p1.5.m4.1.1.1.1.1.2.3.1.cmml">+</mo><mi xref="S2.p1.5.m4.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo fence="false" xref="S2.p1.5.m4.1.1.1.1.1.1.cmml">|</mo><msub xref="S2.p1.5.m4.1.1.1.1.1.3.cmml"><mi xref="S2.p1.5.m4.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.p1.5.m4.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" xref="S2.p1.5.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.5.m4.1.1.cmml" xref="S2.p1.5.m4.1.1"><times id="S2.p1.5.m4.1.1.2.cmml" xref="S2.p1.5.m4.1.1.2"></times><ci id="S2.p1.5.m4.1.1.3.cmml" xref="S2.p1.5.m4.1.1.3">𝑝</ci><apply id="S2.p1.5.m4.1.1.1.1.1.cmml" xref="S2.p1.5.m4.1.1.1.1"><csymbol cd="latexml" id="S2.p1.5.m4.1.1.1.1.1.1.cmml" xref="S2.p1.5.m4.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p1.5.m4.1.1.1.1.1.2.cmml" xref="S2.p1.5.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.1.1.1.2.1.cmml" xref="S2.p1.5.m4.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p1.5.m4.1.1.1.1.1.2.2.cmml" xref="S2.p1.5.m4.1.1.1.1.1.2.2">𝑤</ci><apply id="S2.p1.5.m4.1.1.1.1.1.2.3.cmml" xref="S2.p1.5.m4.1.1.1.1.1.2.3"><plus id="S2.p1.5.m4.1.1.1.1.1.2.3.1.cmml" xref="S2.p1.5.m4.1.1.1.1.1.2.3.1"></plus><ci id="S2.p1.5.m4.1.1.1.1.1.2.3.2.cmml" xref="S2.p1.5.m4.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S2.p1.5.m4.1.1.1.1.1.2.3.3.cmml" xref="S2.p1.5.m4.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.p1.5.m4.1.1.1.1.1.3.cmml" xref="S2.p1.5.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.5.m4.1.1.1.1.1.3.1.cmml" xref="S2.p1.5.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p1.5.m4.1.1.1.1.1.3.2.cmml" xref="S2.p1.5.m4.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.p1.5.m4.1.1.1.1.1.3.3.cmml" xref="S2.p1.5.m4.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">p(w_{t+j}|w_{t})</annotation><annotation encoding="application/x-llamapun">italic_p ( italic_w start_POSTSUBSCRIPT italic_t + italic_j end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container> using the softmax function:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="6" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.E2.m1.5" class="ltx_Math MJX-TEX" display="true" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-semantics id="S2.E2.m1.5a"><mjx-mrow id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml"><mjx-mrow id="S2.E2.m1.5.5.1" xref="S2.E2.m1.5.5.1.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.5.5.1.3" xref="S2.E2.m1.5.5.1.3.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E2.m1.5.5.1.2" xref="S2.E2.m1.5.5.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E2.m1.5.5.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E2.m1.5.5.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.E2.m1.5.5.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><mjx-msub id="S2.E2.m1.5.5.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.5.5.1.1.1.1.2.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E2.m1.5.5.1.1.1.1.2.3" xref="S2.E2.m1.5.5.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.E2.m1.5.5.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.E2.m1.5.5.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.5.5.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E2.m1.5.5.1.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.E2.m1.5.5.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S2.E2.m1.5.5.2" xref="S2.E2.m1.5.5.2.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4" id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml"><mjx-mi class="mjx-n" id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c78"></mjx-c><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E2.m1.2.2.2.2a" xref="S2.E2.m1.2.2.2.3.cmml"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mrow space="2" id="S2.E2.m1.2.2.2.2.1" xref="S2.E2.m1.2.2.2.3.cmml"><mjx-mo class="mjx-sop" id="S2.E2.m1.2.2.2.2.1.2" xref="S2.E2.m1.2.2.2.3.cmml"><mjx-c class="mjx-c28 TEX-S1"></mjx-c></mjx-mo><mjx-mrow id="S2.E2.m1.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><mjx-mmultiscripts id="S2.E2.m1.2.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.2.2.2.2.1.1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-scripts style="vertical-align: 0.363em;"><mjx-row><mjx-cell><mjx-mo class="mjx-var" size="s" id="S2.E2.m1.2.2.2.2.1.1.2.2.2.3" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.3.cmml"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-cell><mjx-cell><mjx-mo class="mjx-n" size="s" id="S2.E2.m1.2.2.2.2.1.1.2.3" xref="S2.E2.m1.2.2.2.2.1.1.2.3.cmml"><mjx-c class="mjx-c22A4"></mjx-c></mjx-mo></mjx-cell></mjx-row><mjx-row style="height: 0.297em;"></mjx-row><mjx-row><mjx-cell><mjx-msub size="s" id="S2.E2.m1.2.2.2.2.1.1.2.2.3" xref="S2.E2.m1.2.2.2.2.1.1.2.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.2.2.2.2.1.1.2.2.3.2" xref="S2.E2.m1.2.2.2.2.1.1.2.2.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E2.m1.2.2.2.2.1.1.2.2.3.3" xref="S2.E2.m1.2.2.2.2.1.1.2.2.3.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-cell><mjx-cell><mjx-mrow size="s" id="S2.E2.m1.2.2.2.2.1.1.2a" xref="S2.E2.m1.2.2.2.2.1.1.2.cmml"></mjx-mrow></mjx-cell></mjx-row></mjx-scripts></mjx-mmultiscripts><mjx-mo class="mjx-n" id="S2.E2.m1.2.2.2.2.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.cmml"></mjx-mo><mjx-msub id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.2.2.2.2.1.1.3.2" xref="S2.E2.m1.2.2.2.2.1.1.3.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-msub size="s" id="S2.E2.m1.2.2.2.2.1.1.3.3" xref="S2.E2.m1.2.2.2.2.1.1.3.3.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.2.2.2.2.1.1.3.3.2" xref="S2.E2.m1.2.2.2.2.1.1.3.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E2.m1.2.2.2.2.1.1.3.3.3" xref="S2.E2.m1.2.2.2.2.1.1.3.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-sop" id="S2.E2.m1.2.2.2.2.1.3" xref="S2.E2.m1.2.2.2.3.cmml"><mjx-c class="mjx-c29 TEX-S1"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow id="S2.E2.m1.4.4.4" xref="S2.E2.m1.4.4.4.cmml"><mjx-msubsup id="S2.E2.m1.4.4.4.3" xref="S2.E2.m1.4.4.4.3.cmml"><mjx-mo class="mjx-sop" id="S2.E2.m1.4.4.4.3.2.2" xref="S2.E2.m1.4.4.4.3.2.2.cmml"><mjx-c class="mjx-c2211 TEX-S1"></mjx-c></mjx-mo><mjx-script style="vertical-align: -0.285em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s" id="S2.E2.m1.4.4.4.3.3" xref="S2.E2.m1.4.4.4.3.3.cmml"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.276em;"></mjx-spacer><mjx-mrow size="s" id="S2.E2.m1.4.4.4.3.2.3" xref="S2.E2.m1.4.4.4.3.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.4.4.4.3.2.3.2" xref="S2.E2.m1.4.4.4.3.2.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E2.m1.4.4.4.3.2.3.1" xref="S2.E2.m1.4.4.4.3.2.3.1.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.E2.m1.4.4.4.3.2.3.3" xref="S2.E2.m1.4.4.4.3.2.3.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-script></mjx-msubsup><mjx-mrow space="2" id="S2.E2.m1.4.4.4.2.1" xref="S2.E2.m1.4.4.4.2.2.cmml"><mjx-mi class="mjx-n" id="S2.E2.m1.3.3.3.1" xref="S2.E2.m1.3.3.3.1.cmml"><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c78"></mjx-c><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E2.m1.4.4.4.2.1a" xref="S2.E2.m1.4.4.4.2.2.cmml"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mrow space="2" id="S2.E2.m1.4.4.4.2.1.1" xref="S2.E2.m1.4.4.4.2.2.cmml"><mjx-mo class="mjx-n" id="S2.E2.m1.4.4.4.2.1.1.2" xref="S2.E2.m1.4.4.4.2.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.E2.m1.4.4.4.2.1.1.1" xref="S2.E2.m1.4.4.4.2.1.1.1.cmml"><mjx-mmultiscripts id="S2.E2.m1.4.4.4.2.1.1.1.2" xref="S2.E2.m1.4.4.4.2.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-scripts style="vertical-align: 0.289em;"><mjx-row><mjx-cell><mjx-mo class="mjx-var" size="s" id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3.cmml"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-cell><mjx-cell><mjx-mo class="mjx-n" size="s" id="S2.E2.m1.4.4.4.2.1.1.1.2.3" xref="S2.E2.m1.4.4.4.2.1.1.1.2.3.cmml"><mjx-c class="mjx-c22A4"></mjx-c></mjx-mo></mjx-cell></mjx-row><mjx-row style="height: 0.223em;"></mjx-row><mjx-row><mjx-cell><mjx-mi class="mjx-i" size="s" id="S2.E2.m1.4.4.4.2.1.1.1.2.2.3" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-cell><mjx-cell><mjx-mrow size="s" id="S2.E2.m1.4.4.4.2.1.1.1.2a" xref="S2.E2.m1.4.4.4.2.1.1.1.2.cmml"></mjx-mrow></mjx-cell></mjx-row></mjx-scripts></mjx-mmultiscripts><mjx-mo class="mjx-n" id="S2.E2.m1.4.4.4.2.1.1.1.1" xref="S2.E2.m1.4.4.4.2.1.1.1.1.cmml"></mjx-mo><mjx-msub id="S2.E2.m1.4.4.4.2.1.1.1.3" xref="S2.E2.m1.4.4.4.2.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.4.4.4.2.1.1.1.3.2" xref="S2.E2.m1.4.4.4.2.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-msub size="s" id="S2.E2.m1.4.4.4.2.1.1.1.3.3" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.cmml"><mjx-mi class="mjx-i" id="S2.E2.m1.4.4.4.2.1.1.1.3.3.2" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E2.m1.4.4.4.2.1.1.1.3.3.3" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.E2.m1.4.4.4.2.1.1.3" xref="S2.E2.m1.4.4.4.2.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="p(w_{O}|w_{I})=\frac{\exp\left({v^{\prime}_{w_{O}}}^{\top}v_{w_{I}}\right)}{\sum_{w=1}^{W}\exp\left({v^{\prime}_{w}}^{\top}v_{w_{I}}\right)}" display="block" class="ltx_Math"><semantics><mrow xref="S2.E2.m1.5.5.cmml"><mrow xref="S2.E2.m1.5.5.1.cmml"><mi xref="S2.E2.m1.5.5.1.3.cmml">p</mi><mo xref="S2.E2.m1.5.5.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E2.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.cmml">(</mo><mrow xref="S2.E2.m1.5.5.1.1.1.1.cmml"><msub xref="S2.E2.m1.5.5.1.1.1.1.2.cmml"><mi xref="S2.E2.m1.5.5.1.1.1.1.2.2.cmml">w</mi><mi xref="S2.E2.m1.5.5.1.1.1.1.2.3.cmml">O</mi></msub><mo fence="false" xref="S2.E2.m1.5.5.1.1.1.1.1.cmml">|</mo><msub xref="S2.E2.m1.5.5.1.1.1.1.3.cmml"><mi xref="S2.E2.m1.5.5.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.E2.m1.5.5.1.1.1.1.3.3.cmml">I</mi></msub></mrow><mo stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo xref="S2.E2.m1.5.5.2.cmml">=</mo><mfrac xref="S2.E2.m1.4.4.cmml"><mrow xref="S2.E2.m1.2.2.2.3.cmml"><mi xref="S2.E2.m1.1.1.1.1.cmml">exp</mi><mo xref="S2.E2.m1.2.2.2.3.cmml">⁡</mo><mrow xref="S2.E2.m1.2.2.2.3.cmml"><mo xref="S2.E2.m1.2.2.2.3.cmml">(</mo><mrow xref="S2.E2.m1.2.2.2.2.1.1.cmml"><mmultiscripts xref="S2.E2.m1.2.2.2.2.1.1.2.cmml"><mi xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.2.cmml">v</mi><msub xref="S2.E2.m1.2.2.2.2.1.1.2.2.3.cmml"><mi xref="S2.E2.m1.2.2.2.2.1.1.2.2.3.2.cmml">w</mi><mi xref="S2.E2.m1.2.2.2.2.1.1.2.2.3.3.cmml">O</mi></msub><mo xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.3.cmml">′</mo><mrow xref="S2.E2.m1.2.2.2.2.1.1.2.cmml"></mrow><mo xref="S2.E2.m1.2.2.2.2.1.1.2.3.cmml">⊤</mo></mmultiscripts><mo xref="S2.E2.m1.2.2.2.2.1.1.1.cmml" lspace="0px" rspace="0px"></mo><msub xref="S2.E2.m1.2.2.2.2.1.1.3.cmml"><mi xref="S2.E2.m1.2.2.2.2.1.1.3.2.cmml">v</mi><msub xref="S2.E2.m1.2.2.2.2.1.1.3.3.cmml"><mi xref="S2.E2.m1.2.2.2.2.1.1.3.3.2.cmml">w</mi><mi xref="S2.E2.m1.2.2.2.2.1.1.3.3.3.cmml">I</mi></msub></msub></mrow><mo xref="S2.E2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow xref="S2.E2.m1.4.4.4.cmml"><msubsup xref="S2.E2.m1.4.4.4.3.cmml"><mo xref="S2.E2.m1.4.4.4.3.2.2.cmml">∑</mo><mrow xref="S2.E2.m1.4.4.4.3.2.3.cmml"><mi xref="S2.E2.m1.4.4.4.3.2.3.2.cmml">w</mi><mo xref="S2.E2.m1.4.4.4.3.2.3.1.cmml">=</mo><mn xref="S2.E2.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi xref="S2.E2.m1.4.4.4.3.3.cmml">W</mi></msubsup><mrow xref="S2.E2.m1.4.4.4.2.2.cmml"><mi xref="S2.E2.m1.3.3.3.1.cmml">exp</mi><mo xref="S2.E2.m1.4.4.4.2.2.cmml">⁡</mo><mrow xref="S2.E2.m1.4.4.4.2.2.cmml"><mo xref="S2.E2.m1.4.4.4.2.2.cmml">(</mo><mrow xref="S2.E2.m1.4.4.4.2.1.1.1.cmml"><mmultiscripts xref="S2.E2.m1.4.4.4.2.1.1.1.2.cmml"><mi xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2.cmml">v</mi><mi xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.3.cmml">w</mi><mo xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3.cmml">′</mo><mrow xref="S2.E2.m1.4.4.4.2.1.1.1.2.cmml"></mrow><mo xref="S2.E2.m1.4.4.4.2.1.1.1.2.3.cmml">⊤</mo></mmultiscripts><mo xref="S2.E2.m1.4.4.4.2.1.1.1.1.cmml" lspace="0px" rspace="0px"></mo><msub xref="S2.E2.m1.4.4.4.2.1.1.1.3.cmml"><mi xref="S2.E2.m1.4.4.4.2.1.1.1.3.2.cmml">v</mi><msub xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.cmml"><mi xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.2.cmml">w</mi><mi xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.3.cmml">I</mi></msub></msub></mrow><mo xref="S2.E2.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5"><eq id="S2.E2.m1.5.5.2.cmml" xref="S2.E2.m1.5.5.2"></eq><apply id="S2.E2.m1.5.5.1.cmml" xref="S2.E2.m1.5.5.1"><times id="S2.E2.m1.5.5.1.2.cmml" xref="S2.E2.m1.5.5.1.2"></times><ci id="S2.E2.m1.5.5.1.3.cmml" xref="S2.E2.m1.5.5.1.3">𝑝</ci><apply id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2">𝑤</ci><ci id="S2.E2.m1.5.5.1.1.1.1.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.3">𝑂</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3.2">𝑤</ci><ci id="S2.E2.m1.5.5.1.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3.3">𝐼</ci></apply></apply></apply><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><divide id="S2.E2.m1.4.4.5.cmml" xref="S2.E2.m1.4.4"></divide><apply id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2"><exp id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"></exp><apply id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1"><times id="S2.E2.m1.2.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1"></times><apply id="S2.E2.m1.2.2.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2">superscript</csymbol><apply id="S2.E2.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2">subscript</csymbol><apply id="S2.E2.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.2">𝑣</ci><ci id="S2.E2.m1.2.2.2.2.1.1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.2.3">′</ci></apply><apply id="S2.E2.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.2.2.3.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.2.2.3.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.3.2">𝑤</ci><ci id="S2.E2.m1.2.2.2.2.1.1.2.2.3.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.2.3.3">𝑂</ci></apply></apply><csymbol cd="latexml" id="S2.E2.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2.3">top</csymbol></apply><apply id="S2.E2.m1.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.2">𝑣</ci><apply id="S2.E2.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.3.2">𝑤</ci><ci id="S2.E2.m1.2.2.2.2.1.1.3.3.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.3.3">𝐼</ci></apply></apply></apply></apply><apply id="S2.E2.m1.4.4.4.cmml" xref="S2.E2.m1.4.4.4"><apply id="S2.E2.m1.4.4.4.3.cmml" xref="S2.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.3.1.cmml" xref="S2.E2.m1.4.4.4.3">superscript</csymbol><apply id="S2.E2.m1.4.4.4.3.2.cmml" xref="S2.E2.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.3.2.1.cmml" xref="S2.E2.m1.4.4.4.3">subscript</csymbol><sum id="S2.E2.m1.4.4.4.3.2.2.cmml" xref="S2.E2.m1.4.4.4.3.2.2"></sum><apply id="S2.E2.m1.4.4.4.3.2.3.cmml" xref="S2.E2.m1.4.4.4.3.2.3"><eq id="S2.E2.m1.4.4.4.3.2.3.1.cmml" xref="S2.E2.m1.4.4.4.3.2.3.1"></eq><ci id="S2.E2.m1.4.4.4.3.2.3.2.cmml" xref="S2.E2.m1.4.4.4.3.2.3.2">𝑤</ci><cn type="integer" id="S2.E2.m1.4.4.4.3.2.3.3.cmml" xref="S2.E2.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.4.4.4.3.3.cmml" xref="S2.E2.m1.4.4.4.3.3">𝑊</ci></apply><apply id="S2.E2.m1.4.4.4.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1"><exp id="S2.E2.m1.3.3.3.1.cmml" xref="S2.E2.m1.3.3.3.1"></exp><apply id="S2.E2.m1.4.4.4.2.1.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1"><times id="S2.E2.m1.4.4.4.2.1.1.1.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.1"></times><apply id="S2.E2.m1.4.4.4.2.1.1.1.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.2.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.4.4.4.2.1.1.1.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.2.2.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2">subscript</csymbol><apply id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2">superscript</csymbol><ci id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.2">𝑣</ci><ci id="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.2.3">′</ci></apply><ci id="S2.E2.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.2.3">𝑤</ci></apply><csymbol cd="latexml" id="S2.E2.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.2.3">top</csymbol></apply><apply id="S2.E2.m1.4.4.4.2.1.1.1.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3.2">𝑣</ci><apply id="S2.E2.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.4.2.1.1.1.3.3.1.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3">subscript</csymbol><ci id="S2.E2.m1.4.4.4.2.1.1.1.3.3.2.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.2">𝑤</ci><ci id="S2.E2.m1.4.4.4.2.1.1.1.3.3.3.cmml" xref="S2.E2.m1.4.4.4.2.1.1.1.3.3.3">𝐼</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">p(w_{O}|w_{I})=\frac{\exp\left({v^{\prime}_{w_{O}}}^{\top}v_{w_{I}}\right)}{\sum_{w=1}^{W}\exp\left({v^{\prime}_{w}}^{\top}v_{w_{I}}\right)}</annotation><annotation encoding="application/x-llamapun">italic_p ( italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ) = divide start_ARG roman_exp ( italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_w = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_W end_POSTSUPERSCRIPT roman_exp ( italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></mjx-assistive-mml></mjx-container></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.13" class="ltx_p">where <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="7" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.6.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.6.m1.1a"><mjx-msub id="S2.p1.6.m1.1.1" xref="S2.p1.6.m1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.p1.6.m1.1.1.2" xref="S2.p1.6.m1.1.1.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.p1.6.m1.1.1.3" xref="S2.p1.6.m1.1.1.3.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="v_{w}" display="inline" class="ltx_Math"><semantics><msub xref="S2.p1.6.m1.1.1.cmml"><mi xref="S2.p1.6.m1.1.1.2.cmml">v</mi><mi xref="S2.p1.6.m1.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.6.m1.1.1.cmml" xref="S2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m1.1.1.1.cmml" xref="S2.p1.6.m1.1.1">subscript</csymbol><ci id="S2.p1.6.m1.1.1.2.cmml" xref="S2.p1.6.m1.1.1.2">𝑣</ci><ci id="S2.p1.6.m1.1.1.3.cmml" xref="S2.p1.6.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">v_{w}</annotation><annotation encoding="application/x-llamapun">italic_v start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="8" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.7.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.7.m2.1a"><mjx-msubsup id="S2.p1.7.m2.1.1" xref="S2.p1.7.m2.1.1.cmml"><mjx-mi class="mjx-i" id="S2.p1.7.m2.1.1.2.2" xref="S2.p1.7.m2.1.1.2.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mo class="mjx-var" size="s" id="S2.p1.7.m2.1.1.2.3" xref="S2.p1.7.m2.1.1.2.3.cmml"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo><mjx-spacer style="margin-top: 0.327em;"></mjx-spacer><mjx-mi class="mjx-i" size="s" id="S2.p1.7.m2.1.1.3" xref="S2.p1.7.m2.1.1.3.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="v^{\prime}_{w}" display="inline" class="ltx_Math"><semantics><msubsup xref="S2.p1.7.m2.1.1.cmml"><mi xref="S2.p1.7.m2.1.1.2.2.cmml">v</mi><mi xref="S2.p1.7.m2.1.1.3.cmml">w</mi><mo xref="S2.p1.7.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.7.m2.1.1.cmml" xref="S2.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m2.1.1.1.cmml" xref="S2.p1.7.m2.1.1">subscript</csymbol><apply id="S2.p1.7.m2.1.1.2.cmml" xref="S2.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m2.1.1.2.1.cmml" xref="S2.p1.7.m2.1.1">superscript</csymbol><ci id="S2.p1.7.m2.1.1.2.2.cmml" xref="S2.p1.7.m2.1.1.2.2">𝑣</ci><ci id="S2.p1.7.m2.1.1.2.3.cmml" xref="S2.p1.7.m2.1.1.2.3">′</ci></apply><ci id="S2.p1.7.m2.1.1.3.cmml" xref="S2.p1.7.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">v^{\prime}_{w}</annotation><annotation encoding="application/x-llamapun">italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> are the “input” and “output” vector representations
of <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="9" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.8.m3.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.8.m3.1a"><mjx-mi class="mjx-i" id="S2.p1.8.m3.1.1" xref="S2.p1.8.m3.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w" display="inline" class="ltx_Math"><semantics><mi xref="S2.p1.8.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.8.m3.1.1.cmml" xref="S2.p1.8.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex">w</annotation><annotation encoding="application/x-llamapun">italic_w</annotation></semantics></math></mjx-assistive-mml></mjx-container>, and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="10" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.9.m4.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.9.m4.1a"><mjx-mi class="mjx-i" id="S2.p1.9.m4.1.1" xref="S2.p1.9.m4.1.1.cmml"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="W" display="inline" class="ltx_Math"><semantics><mi xref="S2.p1.9.m4.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.9.m4.1.1.cmml" xref="S2.p1.9.m4.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex">W</annotation><annotation encoding="application/x-llamapun">italic_W</annotation></semantics></math></mjx-assistive-mml></mjx-container> is the number of words in the vocabulary. This
formulation is impractical because the cost of computing <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="11" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.10.m5.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.10.m5.1a"><mjx-mrow id="S2.p1.10.m5.1.1" xref="S2.p1.10.m5.1.1.cmml"><mjx-mrow id="S2.p1.10.m5.1.1.3" xref="S2.p1.10.m5.1.1.3.cmml"><mjx-mrow id="S2.p1.10.m5.1.1.3.1" xref="S2.p1.10.m5.1.1.3.1.cmml"><mjx-mo class="mjx-n" space="2" rspace="2" id="S2.p1.10.m5.1.1.3.1.1" xref="S2.p1.10.m5.1.1.3.1.1.cmml"><mjx-c class="mjx-c2207"></mjx-c></mjx-mo><mjx-mi class="mjx-n" id="S2.p1.10.m5.1.1.3.1.2" xref="S2.p1.10.m5.1.1.3.1.2.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" space="2" id="S2.p1.10.m5.1.1.3a" xref="S2.p1.10.m5.1.1.3.cmml" style="margin-right: 0.056em;"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.p1.10.m5.1.1.3.2" xref="S2.p1.10.m5.1.1.3.2.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.p1.10.m5.1.1.2" xref="S2.p1.10.m5.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.p1.10.m5.1.1.1.1" xref="S2.p1.10.m5.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.p1.10.m5.1.1.1.1.2" xref="S2.p1.10.m5.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.p1.10.m5.1.1.1.1.1" xref="S2.p1.10.m5.1.1.1.1.1.cmml"><mjx-msub id="S2.p1.10.m5.1.1.1.1.1.2" xref="S2.p1.10.m5.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.p1.10.m5.1.1.1.1.1.2.2" xref="S2.p1.10.m5.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.p1.10.m5.1.1.1.1.1.2.3" xref="S2.p1.10.m5.1.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.p1.10.m5.1.1.1.1.1.1" xref="S2.p1.10.m5.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.p1.10.m5.1.1.1.1.1.3" xref="S2.p1.10.m5.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.p1.10.m5.1.1.1.1.1.3.2" xref="S2.p1.10.m5.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.p1.10.m5.1.1.1.1.1.3.3" xref="S2.p1.10.m5.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.p1.10.m5.1.1.1.1.3" xref="S2.p1.10.m5.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\nabla\log p(w_{O}|w_{I})" display="inline" class="ltx_Math"><semantics><mrow xref="S2.p1.10.m5.1.1.cmml"><mrow xref="S2.p1.10.m5.1.1.3.cmml"><mrow xref="S2.p1.10.m5.1.1.3.1.cmml"><mo rspace="0.167em" xref="S2.p1.10.m5.1.1.3.1.1.cmml">∇</mo><mi xref="S2.p1.10.m5.1.1.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" xref="S2.p1.10.m5.1.1.3.cmml">⁡</mo><mi xref="S2.p1.10.m5.1.1.3.2.cmml">p</mi></mrow><mo xref="S2.p1.10.m5.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.p1.10.m5.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.p1.10.m5.1.1.1.1.1.cmml">(</mo><mrow xref="S2.p1.10.m5.1.1.1.1.1.cmml"><msub xref="S2.p1.10.m5.1.1.1.1.1.2.cmml"><mi xref="S2.p1.10.m5.1.1.1.1.1.2.2.cmml">w</mi><mi xref="S2.p1.10.m5.1.1.1.1.1.2.3.cmml">O</mi></msub><mo fence="false" xref="S2.p1.10.m5.1.1.1.1.1.1.cmml">|</mo><msub xref="S2.p1.10.m5.1.1.1.1.1.3.cmml"><mi xref="S2.p1.10.m5.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.p1.10.m5.1.1.1.1.1.3.3.cmml">I</mi></msub></mrow><mo stretchy="false" xref="S2.p1.10.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.10.m5.1.1.cmml" xref="S2.p1.10.m5.1.1"><times id="S2.p1.10.m5.1.1.2.cmml" xref="S2.p1.10.m5.1.1.2"></times><apply id="S2.p1.10.m5.1.1.3.cmml" xref="S2.p1.10.m5.1.1.3"><apply id="S2.p1.10.m5.1.1.3.1.cmml" xref="S2.p1.10.m5.1.1.3.1"><ci id="S2.p1.10.m5.1.1.3.1.1.cmml" xref="S2.p1.10.m5.1.1.3.1.1">∇</ci><log id="S2.p1.10.m5.1.1.3.1.2.cmml" xref="S2.p1.10.m5.1.1.3.1.2"></log></apply><ci id="S2.p1.10.m5.1.1.3.2.cmml" xref="S2.p1.10.m5.1.1.3.2">𝑝</ci></apply><apply id="S2.p1.10.m5.1.1.1.1.1.cmml" xref="S2.p1.10.m5.1.1.1.1"><csymbol cd="latexml" id="S2.p1.10.m5.1.1.1.1.1.1.cmml" xref="S2.p1.10.m5.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p1.10.m5.1.1.1.1.1.2.cmml" xref="S2.p1.10.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.10.m5.1.1.1.1.1.2.1.cmml" xref="S2.p1.10.m5.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p1.10.m5.1.1.1.1.1.2.2.cmml" xref="S2.p1.10.m5.1.1.1.1.1.2.2">𝑤</ci><ci id="S2.p1.10.m5.1.1.1.1.1.2.3.cmml" xref="S2.p1.10.m5.1.1.1.1.1.2.3">𝑂</ci></apply><apply id="S2.p1.10.m5.1.1.1.1.1.3.cmml" xref="S2.p1.10.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p1.10.m5.1.1.1.1.1.3.1.cmml" xref="S2.p1.10.m5.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p1.10.m5.1.1.1.1.1.3.2.cmml" xref="S2.p1.10.m5.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.p1.10.m5.1.1.1.1.1.3.3.cmml" xref="S2.p1.10.m5.1.1.1.1.1.3.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">\nabla\log p(w_{O}|w_{I})</annotation><annotation encoding="application/x-llamapun">∇ roman_log italic_p ( italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container> is proportional to <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="12" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.11.m6.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.11.m6.1a"><mjx-mi class="mjx-i" id="S2.p1.11.m6.1.1" xref="S2.p1.11.m6.1.1.cmml"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="W" display="inline" class="ltx_Math"><semantics><mi xref="S2.p1.11.m6.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.11.m6.1.1.cmml" xref="S2.p1.11.m6.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex">W</annotation><annotation encoding="application/x-llamapun">italic_W</annotation></semantics></math></mjx-assistive-mml></mjx-container>, which is often large
(<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="13" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.12.m7.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.12.m7.1a"><mjx-msup id="S2.p1.12.m7.1.1" xref="S2.p1.12.m7.1.1.cmml"><mjx-mn class="mjx-n" id="S2.p1.12.m7.1.1.2" xref="S2.p1.12.m7.1.1.2.cmml"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mn class="mjx-n" size="s" id="S2.p1.12.m7.1.1.3" xref="S2.p1.12.m7.1.1.3.cmml"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="10^{5}" display="inline" class="ltx_Math"><semantics><msup xref="S2.p1.12.m7.1.1.cmml"><mn xref="S2.p1.12.m7.1.1.2.cmml">10</mn><mn xref="S2.p1.12.m7.1.1.3.cmml">5</mn></msup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.12.m7.1.1.cmml" xref="S2.p1.12.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.12.m7.1.1.1.cmml" xref="S2.p1.12.m7.1.1">superscript</csymbol><cn type="integer" id="S2.p1.12.m7.1.1.2.cmml" xref="S2.p1.12.m7.1.1.2">10</cn><cn type="integer" id="S2.p1.12.m7.1.1.3.cmml" xref="S2.p1.12.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex">10^{5}</annotation><annotation encoding="application/x-llamapun">10 start_POSTSUPERSCRIPT 5 end_POSTSUPERSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container>–<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="14" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.p1.13.m8.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.p1.13.m8.1a"><mjx-msup id="S2.p1.13.m8.1.1" xref="S2.p1.13.m8.1.1.cmml"><mjx-mn class="mjx-n" id="S2.p1.13.m8.1.1.2" xref="S2.p1.13.m8.1.1.2.cmml"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mn class="mjx-n" size="s" id="S2.p1.13.m8.1.1.3" xref="S2.p1.13.m8.1.1.3.cmml"><mjx-c class="mjx-c37"></mjx-c></mjx-mn></mjx-script></mjx-msup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="10^{7}" display="inline" class="ltx_Math"><semantics><msup xref="S2.p1.13.m8.1.1.cmml"><mn xref="S2.p1.13.m8.1.1.2.cmml">10</mn><mn xref="S2.p1.13.m8.1.1.3.cmml">7</mn></msup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.p1.13.m8.1.1.cmml" xref="S2.p1.13.m8.1.1"><csymbol cd="ambiguous" id="S2.p1.13.m8.1.1.1.cmml" xref="S2.p1.13.m8.1.1">superscript</csymbol><cn type="integer" id="S2.p1.13.m8.1.1.2.cmml" xref="S2.p1.13.m8.1.1.2">10</cn><cn type="integer" id="S2.p1.13.m8.1.1.3.cmml" xref="S2.p1.13.m8.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex">10^{7}</annotation><annotation encoding="application/x-llamapun">10 start_POSTSUPERSCRIPT 7 end_POSTSUPERSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> terms).</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Hierarchical Softmax</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.2" class="ltx_p">A computationally efficient approximation of the full softmax is the hierarchical softmax.
In the context of neural network language models, it was first
introduced by Morin and Bengio&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. The main
advantage is that instead of evaluating <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="15" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p1.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p1.1.m1.1a"><mjx-mi class="mjx-i" id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="W" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex">W</annotation><annotation encoding="application/x-llamapun">italic_W</annotation></semantics></math></mjx-assistive-mml></mjx-container> output nodes in the neural network to obtain
the probability distribution, it is needed to evaluate only about <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="16" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p1.2.m2.2" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p1.2.m2.2a"><mjx-mrow id="S2.SS1.p1.2.m2.2.2.1" xref="S2.SS1.p1.2.m2.2.2.2.cmml"><mjx-msub id="S2.SS1.p1.2.m2.2.2.1.1" xref="S2.SS1.p1.2.m2.2.2.1.1.cmml"><mjx-mi class="mjx-n" id="S2.SS1.p1.2.m2.2.2.1.1.2" xref="S2.SS1.p1.2.m2.2.2.1.1.2.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.241em;"><mjx-mn class="mjx-n" size="s" id="S2.SS1.p1.2.m2.2.2.1.1.3" xref="S2.SS1.p1.2.m2.2.2.1.1.3.cmml"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS1.p1.2.m2.2.2.1a" xref="S2.SS1.p1.2.m2.2.2.2.cmml"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p1.2.m2.2.2.1.2" xref="S2.SS1.p1.2.m2.2.2.2.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p1.2.m2.2.2.1.2.1" xref="S2.SS1.p1.2.m2.2.2.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p1.2.m2.2.2.1.2.2" xref="S2.SS1.p1.2.m2.2.2.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\log_{2}(W)" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p1.2.m2.2.2.2.cmml"><msub xref="S2.SS1.p1.2.m2.2.2.1.1.cmml"><mi xref="S2.SS1.p1.2.m2.2.2.1.1.2.cmml">log</mi><mn xref="S2.SS1.p1.2.m2.2.2.1.1.3.cmml">2</mn></msub><mo xref="S2.SS1.p1.2.m2.2.2.2.cmml">⁡</mo><mrow xref="S2.SS1.p1.2.m2.2.2.2.cmml"><mo stretchy="false" xref="S2.SS1.p1.2.m2.2.2.2.cmml">(</mo><mi xref="S2.SS1.p1.2.m2.1.1.cmml">W</mi><mo stretchy="false" xref="S2.SS1.p1.2.m2.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p1.2.m2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1"><apply id="S2.SS1.p1.2.m2.2.2.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1">subscript</csymbol><log id="S2.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.2"></log><cn type="integer" id="S2.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.2.2.1.1.3">2</cn></apply><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex">\log_{2}(W)</annotation><annotation encoding="application/x-llamapun">roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_W )</annotation></semantics></math></mjx-assistive-mml></mjx-container> nodes.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p">The hierarchical softmax uses a binary tree representation of the output layer
with the <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="17" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p2.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p2.1.m1.1a"><mjx-mi class="mjx-i" id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="W" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p2.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex">W</annotation><annotation encoding="application/x-llamapun">italic_W</annotation></semantics></math></mjx-assistive-mml></mjx-container> words as its leaves and, for each
node, explicitly represents the relative probabilities of its child
nodes. These define a random walk that assigns probabilities to words.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.p3.13" class="ltx_p">More precisely, each word <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="18" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.1.m1.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex">w</annotation><annotation encoding="application/x-llamapun">italic_w</annotation></semantics></math></mjx-assistive-mml></mjx-container> can be reached by an appropriate path
from the root of the tree. Let <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="19" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.2.m2.2" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.2.m2.2a"><mjx-mrow id="S2.SS1.p3.2.m2.2.3" xref="S2.SS1.p3.2.m2.2.3.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.2.m2.2.3.2" xref="S2.SS1.p3.2.m2.2.3.2.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.2.m2.2.3.1" xref="S2.SS1.p3.2.m2.2.3.1.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.2.m2.2.3.3.2" xref="S2.SS1.p3.2.m2.2.3.3.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.2.m2.2.3.3.2.1" xref="S2.SS1.p3.2.m2.2.3.3.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.2.m2.2.3.3.2.2" xref="S2.SS1.p3.2.m2.2.3.3.1.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2" id="S2.SS1.p3.2.m2.2.2" xref="S2.SS1.p3.2.m2.2.2.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.2.m2.2.3.3.2.3" xref="S2.SS1.p3.2.m2.2.3.3.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="n(w,j)" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.2.m2.2.3.cmml"><mi xref="S2.SS1.p3.2.m2.2.3.2.cmml">n</mi><mo xref="S2.SS1.p3.2.m2.2.3.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.2.m2.2.3.3.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.2.m2.2.3.3.1.cmml">(</mo><mi xref="S2.SS1.p3.2.m2.1.1.cmml">w</mi><mo xref="S2.SS1.p3.2.m2.2.3.3.1.cmml">,</mo><mi xref="S2.SS1.p3.2.m2.2.2.cmml">j</mi><mo stretchy="false" xref="S2.SS1.p3.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.2.m2.2.3.cmml" xref="S2.SS1.p3.2.m2.2.3"><times id="S2.SS1.p3.2.m2.2.3.1.cmml" xref="S2.SS1.p3.2.m2.2.3.1"></times><ci id="S2.SS1.p3.2.m2.2.3.2.cmml" xref="S2.SS1.p3.2.m2.2.3.2">𝑛</ci><interval closure="open" id="S2.SS1.p3.2.m2.2.3.3.1.cmml" xref="S2.SS1.p3.2.m2.2.3.3.2"><ci id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">𝑤</ci><ci id="S2.SS1.p3.2.m2.2.2.cmml" xref="S2.SS1.p3.2.m2.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex">n(w,j)</annotation><annotation encoding="application/x-llamapun">italic_n ( italic_w , italic_j )</annotation></semantics></math></mjx-assistive-mml></mjx-container> be the <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="20" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.3.m3.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.3.m3.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="j" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex">j</annotation><annotation encoding="application/x-llamapun">italic_j</annotation></semantics></math></mjx-assistive-mml></mjx-container>-th node on the
path from the root to <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="21" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.4.m4.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.4.m4.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.4.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex">w</annotation><annotation encoding="application/x-llamapun">italic_w</annotation></semantics></math></mjx-assistive-mml></mjx-container>, and let <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="22" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.5.m5.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.5.m5.1a"><mjx-mrow id="S2.SS1.p3.5.m5.1.2" xref="S2.SS1.p3.5.m5.1.2.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.5.m5.1.2.2" xref="S2.SS1.p3.5.m5.1.2.2.cmml"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.5.m5.1.2.1" xref="S2.SS1.p3.5.m5.1.2.1.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.5.m5.1.2.3.2" xref="S2.SS1.p3.5.m5.1.2.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.5.m5.1.2.3.2.1" xref="S2.SS1.p3.5.m5.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.5.m5.1.2.3.2.2" xref="S2.SS1.p3.5.m5.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="L(w)" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.5.m5.1.2.cmml"><mi xref="S2.SS1.p3.5.m5.1.2.2.cmml">L</mi><mo xref="S2.SS1.p3.5.m5.1.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.5.m5.1.2.cmml"><mo stretchy="false" xref="S2.SS1.p3.5.m5.1.2.cmml">(</mo><mi xref="S2.SS1.p3.5.m5.1.1.cmml">w</mi><mo stretchy="false" xref="S2.SS1.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.5.m5.1.2.cmml" xref="S2.SS1.p3.5.m5.1.2"><times id="S2.SS1.p3.5.m5.1.2.1.cmml" xref="S2.SS1.p3.5.m5.1.2.1"></times><ci id="S2.SS1.p3.5.m5.1.2.2.cmml" xref="S2.SS1.p3.5.m5.1.2.2">𝐿</ci><ci id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">L(w)</annotation><annotation encoding="application/x-llamapun">italic_L ( italic_w )</annotation></semantics></math></mjx-assistive-mml></mjx-container> be the length of this path,
so <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="23" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.6.m6.2" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.6.m6.2a"><mjx-mrow id="S2.SS1.p3.6.m6.2.3" xref="S2.SS1.p3.6.m6.2.3.cmml"><mjx-mrow id="S2.SS1.p3.6.m6.2.3.2" xref="S2.SS1.p3.6.m6.2.3.2.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.6.m6.2.3.2.2" xref="S2.SS1.p3.6.m6.2.3.2.2.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.6.m6.2.3.2.1" xref="S2.SS1.p3.6.m6.2.3.2.1.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.6.m6.2.3.2.3.2" xref="S2.SS1.p3.6.m6.2.3.2.3.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.6.m6.2.3.2.3.2.1" xref="S2.SS1.p3.6.m6.2.3.2.3.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.6.m6.2.3.2.3.2.2" xref="S2.SS1.p3.6.m6.2.3.2.3.1.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="2" id="S2.SS1.p3.6.m6.2.2" xref="S2.SS1.p3.6.m6.2.2.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" id="S2.SS1.p3.6.m6.2.3.2.3.2.3" xref="S2.SS1.p3.6.m6.2.3.2.3.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S2.SS1.p3.6.m6.2.3.1" xref="S2.SS1.p3.6.m6.2.3.1.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-n" space="4" id="S2.SS1.p3.6.m6.2.3.3" xref="S2.SS1.p3.6.m6.2.3.3.cmml"><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c74"></mjx-c></mjx-mi></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="n(w,1)=\mathrm{root}" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.6.m6.2.3.cmml"><mrow xref="S2.SS1.p3.6.m6.2.3.2.cmml"><mi xref="S2.SS1.p3.6.m6.2.3.2.2.cmml">n</mi><mo xref="S2.SS1.p3.6.m6.2.3.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.6.m6.2.3.2.3.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.6.m6.2.3.2.3.1.cmml">(</mo><mi xref="S2.SS1.p3.6.m6.1.1.cmml">w</mi><mo xref="S2.SS1.p3.6.m6.2.3.2.3.1.cmml">,</mo><mn xref="S2.SS1.p3.6.m6.2.2.cmml">1</mn><mo stretchy="false" xref="S2.SS1.p3.6.m6.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo xref="S2.SS1.p3.6.m6.2.3.1.cmml">=</mo><mi xref="S2.SS1.p3.6.m6.2.3.3.cmml">root</mi></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.6.m6.2.3.cmml" xref="S2.SS1.p3.6.m6.2.3"><eq id="S2.SS1.p3.6.m6.2.3.1.cmml" xref="S2.SS1.p3.6.m6.2.3.1"></eq><apply id="S2.SS1.p3.6.m6.2.3.2.cmml" xref="S2.SS1.p3.6.m6.2.3.2"><times id="S2.SS1.p3.6.m6.2.3.2.1.cmml" xref="S2.SS1.p3.6.m6.2.3.2.1"></times><ci id="S2.SS1.p3.6.m6.2.3.2.2.cmml" xref="S2.SS1.p3.6.m6.2.3.2.2">𝑛</ci><interval closure="open" id="S2.SS1.p3.6.m6.2.3.2.3.1.cmml" xref="S2.SS1.p3.6.m6.2.3.2.3.2"><ci id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">𝑤</ci><cn type="integer" id="S2.SS1.p3.6.m6.2.2.cmml" xref="S2.SS1.p3.6.m6.2.2">1</cn></interval></apply><ci id="S2.SS1.p3.6.m6.2.3.3.cmml" xref="S2.SS1.p3.6.m6.2.3.3">root</ci></apply></annotation-xml><annotation encoding="application/x-tex">n(w,1)=\mathrm{root}</annotation><annotation encoding="application/x-llamapun">italic_n ( italic_w , 1 ) = roman_root</annotation></semantics></math></mjx-assistive-mml></mjx-container> and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="24" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.7.m7.3" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.7.m7.3a"><mjx-mrow id="S2.SS1.p3.7.m7.3.3" xref="S2.SS1.p3.7.m7.3.3.cmml"><mjx-mrow id="S2.SS1.p3.7.m7.3.3.1" xref="S2.SS1.p3.7.m7.3.3.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.7.m7.3.3.1.3" xref="S2.SS1.p3.7.m7.3.3.1.3.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.7.m7.3.3.1.2" xref="S2.SS1.p3.7.m7.3.3.1.2.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.7.m7.3.3.1.1.1" xref="S2.SS1.p3.7.m7.3.3.1.1.2.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.7.m7.3.3.1.1.1.2" xref="S2.SS1.p3.7.m7.3.3.1.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.7.m7.2.2" xref="S2.SS1.p3.7.m7.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.7.m7.3.3.1.1.1.3" xref="S2.SS1.p3.7.m7.3.3.1.1.2.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mrow space="2" id="S2.SS1.p3.7.m7.3.3.1.1.1.1" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.7.m7.3.3.1.1.1.1.2" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.7.m7.3.3.1.1.1.1.1" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.1.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.7.m7.3.3.1.1.1.1.3.2" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.7.m7.3.3.1.1.1.1.3.2.1" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.7.m7.1.1" xref="S2.SS1.p3.7.m7.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.7.m7.3.3.1.1.1.1.3.2.2" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.7.m7.3.3.1.1.1.4" xref="S2.SS1.p3.7.m7.3.3.1.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S2.SS1.p3.7.m7.3.3.2" xref="S2.SS1.p3.7.m7.3.3.2.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="4" id="S2.SS1.p3.7.m7.3.3.3" xref="S2.SS1.p3.7.m7.3.3.3.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="n(w,L(w))=w" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.7.m7.3.3.cmml"><mrow xref="S2.SS1.p3.7.m7.3.3.1.cmml"><mi xref="S2.SS1.p3.7.m7.3.3.1.3.cmml">n</mi><mo xref="S2.SS1.p3.7.m7.3.3.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.7.m7.3.3.1.1.2.cmml"><mo stretchy="false" xref="S2.SS1.p3.7.m7.3.3.1.1.2.cmml">(</mo><mi xref="S2.SS1.p3.7.m7.2.2.cmml">w</mi><mo xref="S2.SS1.p3.7.m7.3.3.1.1.2.cmml">,</mo><mrow xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml"><mi xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.2.cmml">L</mi><mo xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml">(</mo><mi xref="S2.SS1.p3.7.m7.1.1.cmml">w</mi><mo stretchy="false" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" xref="S2.SS1.p3.7.m7.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo xref="S2.SS1.p3.7.m7.3.3.2.cmml">=</mo><mi xref="S2.SS1.p3.7.m7.3.3.3.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.7.m7.3.3.cmml" xref="S2.SS1.p3.7.m7.3.3"><eq id="S2.SS1.p3.7.m7.3.3.2.cmml" xref="S2.SS1.p3.7.m7.3.3.2"></eq><apply id="S2.SS1.p3.7.m7.3.3.1.cmml" xref="S2.SS1.p3.7.m7.3.3.1"><times id="S2.SS1.p3.7.m7.3.3.1.2.cmml" xref="S2.SS1.p3.7.m7.3.3.1.2"></times><ci id="S2.SS1.p3.7.m7.3.3.1.3.cmml" xref="S2.SS1.p3.7.m7.3.3.1.3">𝑛</ci><interval closure="open" id="S2.SS1.p3.7.m7.3.3.1.1.2.cmml" xref="S2.SS1.p3.7.m7.3.3.1.1.1"><ci id="S2.SS1.p3.7.m7.2.2.cmml" xref="S2.SS1.p3.7.m7.2.2">𝑤</ci><apply id="S2.SS1.p3.7.m7.3.3.1.1.1.1.cmml" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1"><times id="S2.SS1.p3.7.m7.3.3.1.1.1.1.1.cmml" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.1"></times><ci id="S2.SS1.p3.7.m7.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p3.7.m7.3.3.1.1.1.1.2">𝐿</ci><ci id="S2.SS1.p3.7.m7.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1">𝑤</ci></apply></interval></apply><ci id="S2.SS1.p3.7.m7.3.3.3.cmml" xref="S2.SS1.p3.7.m7.3.3.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">n(w,L(w))=w</annotation><annotation encoding="application/x-llamapun">italic_n ( italic_w , italic_L ( italic_w ) ) = italic_w</annotation></semantics></math></mjx-assistive-mml></mjx-container>. In addition, for any
inner node <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="25" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.8.m8.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.8.m8.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.8.m8.1.1" xref="S2.SS1.p3.8.m8.1.1.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="n" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.8.m8.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.8.m8.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex">n</annotation><annotation encoding="application/x-llamapun">italic_n</annotation></semantics></math></mjx-assistive-mml></mjx-container>, let <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="26" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.9.m9.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.9.m9.1a"><mjx-mrow id="S2.SS1.p3.9.m9.1.2" xref="S2.SS1.p3.9.m9.1.2.cmml"><mjx-mi class="mjx-n" id="S2.SS1.p3.9.m9.1.2.2" xref="S2.SS1.p3.9.m9.1.2.2.cmml"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.9.m9.1.2.1" xref="S2.SS1.p3.9.m9.1.2.1.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.9.m9.1.2.3.2" xref="S2.SS1.p3.9.m9.1.2.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.9.m9.1.2.3.2.1" xref="S2.SS1.p3.9.m9.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.9.m9.1.1" xref="S2.SS1.p3.9.m9.1.1.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.9.m9.1.2.3.2.2" xref="S2.SS1.p3.9.m9.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathrm{ch}(n)" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.9.m9.1.2.cmml"><mi xref="S2.SS1.p3.9.m9.1.2.2.cmml">ch</mi><mo xref="S2.SS1.p3.9.m9.1.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.9.m9.1.2.cmml"><mo stretchy="false" xref="S2.SS1.p3.9.m9.1.2.cmml">(</mo><mi xref="S2.SS1.p3.9.m9.1.1.cmml">n</mi><mo stretchy="false" xref="S2.SS1.p3.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.9.m9.1.2.cmml" xref="S2.SS1.p3.9.m9.1.2"><times id="S2.SS1.p3.9.m9.1.2.1.cmml" xref="S2.SS1.p3.9.m9.1.2.1"></times><ci id="S2.SS1.p3.9.m9.1.2.2.cmml" xref="S2.SS1.p3.9.m9.1.2.2">ch</ci><ci id="S2.SS1.p3.9.m9.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex">\mathrm{ch}(n)</annotation><annotation encoding="application/x-llamapun">roman_ch ( italic_n )</annotation></semantics></math></mjx-assistive-mml></mjx-container> be an arbitrary fixed child of
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="27" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.10.m10.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.10.m10.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.10.m10.1.1" xref="S2.SS1.p3.10.m10.1.1.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="n" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.10.m10.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.10.m10.1.1.cmml" xref="S2.SS1.p3.10.m10.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex">n</annotation><annotation encoding="application/x-llamapun">italic_n</annotation></semantics></math></mjx-assistive-mml></mjx-container> and let <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="28" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.11.m11.2" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.11.m11.2a"><mjx-mrow id="S2.SS1.p3.11.m11.2.2.1" xref="S2.SS1.p3.11.m11.2.2.2.cmml"><mjx-mpadded><mjx-block style="width: 0.247em;"><mjx-mo class="mjx-n" id="S2.SS1.p3.11.m11.2.2.1.2" xref="S2.SS1.p3.11.m11.2.2.2.1.cmml"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo></mjx-block></mjx-mpadded><mjx-mrow id="S2.SS1.p3.11.m11.2.2.1.1.2" xref="S2.SS1.p3.11.m11.2.2.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.11.m11.2.2.1.1.2.1" xref="S2.SS1.p3.11.m11.2.2.1.1.1.1.cmml"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.11.m11.1.1" xref="S2.SS1.p3.11.m11.1.1.cmml"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mpadded><mjx-block style="width: 0.247em;"><mjx-mo class="mjx-n" id="S2.SS1.p3.11.m11.2.2.1.1.2.2" xref="S2.SS1.p3.11.m11.2.2.1.1.1.1.cmml"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-block></mjx-mpadded></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.11.m11.2.2.1.3" xref="S2.SS1.p3.11.m11.2.2.2.1.cmml"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="[\![x]\!]" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.11.m11.2.2.2.cmml"><mpadded width="0.247em"><mo stretchy="false" xref="S2.SS1.p3.11.m11.2.2.2.1.cmml">[</mo></mpadded><mrow xref="S2.SS1.p3.11.m11.2.2.1.1.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.11.m11.2.2.1.1.1.1.cmml">[</mo><mi xref="S2.SS1.p3.11.m11.1.1.cmml">x</mi><mpadded width="0.247em"><mo stretchy="false" xref="S2.SS1.p3.11.m11.2.2.1.1.1.1.cmml">]</mo></mpadded></mrow><mo stretchy="false" xref="S2.SS1.p3.11.m11.2.2.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.11.m11.2.2.2.cmml" xref="S2.SS1.p3.11.m11.2.2.1"><csymbol cd="latexml" id="S2.SS1.p3.11.m11.2.2.2.1.cmml" xref="S2.SS1.p3.11.m11.2.2.1.2">delimited-[]</csymbol><apply id="S2.SS1.p3.11.m11.2.2.1.1.1.cmml" xref="S2.SS1.p3.11.m11.2.2.1.1.2"><csymbol cd="latexml" id="S2.SS1.p3.11.m11.2.2.1.1.1.1.cmml" xref="S2.SS1.p3.11.m11.2.2.1.1.2.1">delimited-[]</csymbol><ci id="S2.SS1.p3.11.m11.1.1.cmml" xref="S2.SS1.p3.11.m11.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex">[\![x]\!]</annotation><annotation encoding="application/x-llamapun">[ [ italic_x ] ]</annotation></semantics></math></mjx-assistive-mml></mjx-container> be 1 if <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="29" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.12.m12.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.12.m12.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.12.m12.1.1" xref="S2.SS1.p3.12.m12.1.1.cmml"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="x" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.12.m12.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.12.m12.1.1.cmml" xref="S2.SS1.p3.12.m12.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex">x</annotation><annotation encoding="application/x-llamapun">italic_x</annotation></semantics></math></mjx-assistive-mml></mjx-container> is true and -1 otherwise.
Then the hierarchical softmax defines <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="30" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.13.m13.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.13.m13.1a"><mjx-mrow id="S2.SS1.p3.13.m13.1.1" xref="S2.SS1.p3.13.m13.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.13.m13.1.1.3" xref="S2.SS1.p3.13.m13.1.1.3.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.13.m13.1.1.2" xref="S2.SS1.p3.13.m13.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.13.m13.1.1.1.1" xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.13.m13.1.1.1.1.2" xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p3.13.m13.1.1.1.1.1" xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml"><mjx-msub id="S2.SS1.p3.13.m13.1.1.1.1.1.2" xref="S2.SS1.p3.13.m13.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.13.m13.1.1.1.1.1.2.2" xref="S2.SS1.p3.13.m13.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.13.m13.1.1.1.1.1.2.3" xref="S2.SS1.p3.13.m13.1.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS1.p3.13.m13.1.1.1.1.1.1" xref="S2.SS1.p3.13.m13.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.SS1.p3.13.m13.1.1.1.1.1.3" xref="S2.SS1.p3.13.m13.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.13.m13.1.1.1.1.1.3.2" xref="S2.SS1.p3.13.m13.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.13.m13.1.1.1.1.1.3.3" xref="S2.SS1.p3.13.m13.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.13.m13.1.1.1.1.3" xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="p(w_{O}|w_{I})" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.13.m13.1.1.cmml"><mi xref="S2.SS1.p3.13.m13.1.1.3.cmml">p</mi><mo xref="S2.SS1.p3.13.m13.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml">(</mo><mrow xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml"><msub xref="S2.SS1.p3.13.m13.1.1.1.1.1.2.cmml"><mi xref="S2.SS1.p3.13.m13.1.1.1.1.1.2.2.cmml">w</mi><mi xref="S2.SS1.p3.13.m13.1.1.1.1.1.2.3.cmml">O</mi></msub><mo fence="false" xref="S2.SS1.p3.13.m13.1.1.1.1.1.1.cmml">|</mo><msub xref="S2.SS1.p3.13.m13.1.1.1.1.1.3.cmml"><mi xref="S2.SS1.p3.13.m13.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.SS1.p3.13.m13.1.1.1.1.1.3.3.cmml">I</mi></msub></mrow><mo stretchy="false" xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.13.m13.1.1.cmml" xref="S2.SS1.p3.13.m13.1.1"><times id="S2.SS1.p3.13.m13.1.1.2.cmml" xref="S2.SS1.p3.13.m13.1.1.2"></times><ci id="S2.SS1.p3.13.m13.1.1.3.cmml" xref="S2.SS1.p3.13.m13.1.1.3">𝑝</ci><apply id="S2.SS1.p3.13.m13.1.1.1.1.1.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.13.m13.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p3.13.m13.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m13.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p3.13.m13.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.2.2">𝑤</ci><ci id="S2.SS1.p3.13.m13.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.2.3">𝑂</ci></apply><apply id="S2.SS1.p3.13.m13.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.13.m13.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.13.m13.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.SS1.p3.13.m13.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1.3.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">p(w_{O}|w_{I})</annotation><annotation encoding="application/x-llamapun">italic_p ( italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container> as follows:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="31" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.E3.m1.8" class="ltx_Math MJX-TEX" display="true" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-semantics id="S2.E3.m1.8a"><mjx-mrow id="S2.E3.m1.8.8" xref="S2.E3.m1.8.8.cmml"><mjx-mrow id="S2.E3.m1.7.7.1" xref="S2.E3.m1.7.7.1.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.7.7.1.3" xref="S2.E3.m1.7.7.1.3.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.7.7.1.2" xref="S2.E3.m1.7.7.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E3.m1.7.7.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E3.m1.7.7.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.E3.m1.7.7.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.7.7.1.1.1.1.2" xref="S2.E3.m1.7.7.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.7.7.1.1.1.1.1" xref="S2.E3.m1.7.7.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.E3.m1.7.7.1.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.7.7.1.1.1.1.3.2" xref="S2.E3.m1.7.7.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E3.m1.7.7.1.1.1.1.3.3" xref="S2.E3.m1.7.7.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.E3.m1.7.7.1.1.1.3" xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="5" rspace="1" id="S2.E3.m1.8.8.3" xref="S2.E3.m1.8.8.3.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow id="S2.E3.m1.8.8.2" xref="S2.E3.m1.8.8.2.cmml"><mjx-munderover id="S2.E3.m1.8.8.2.2" xref="S2.E3.m1.8.8.2.2.cmml"><mjx-over style="padding-bottom: 0.111em;"><mjx-mrow size="s" id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mjx-mrow id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.3.1.cmml"></mjx-mo><mjx-mrow id="S2.E3.m1.1.1.1.3.3.2" xref="S2.E3.m1.1.1.1.3.cmml"><mjx-mo class="mjx-n" id="S2.E3.m1.1.1.1.3.3.2.1" xref="S2.E3.m1.1.1.1.3.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.1.1.1.3.3.2.2" xref="S2.E3.m1.1.1.1.3.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.E3.m1.1.1.1.4" xref="S2.E3.m1.1.1.1.4.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base style="padding-left: 0.582em;"><mjx-mo class="mjx-lop" id="S2.E3.m1.8.8.2.2.2.2" xref="S2.E3.m1.8.8.2.2.2.2.cmml"><mjx-c class="mjx-c220F TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.623em;"><mjx-mrow size="s" id="S2.E3.m1.8.8.2.2.2.3" xref="S2.E3.m1.8.8.2.2.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.8.8.2.2.2.3.2" xref="S2.E3.m1.8.8.2.2.2.3.2.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.2.2.3.1" xref="S2.E3.m1.8.8.2.2.2.3.1.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.E3.m1.8.8.2.2.2.3.3" xref="S2.E3.m1.8.8.2.2.2.3.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow space="2" id="S2.E3.m1.8.8.2.1" xref="S2.E3.m1.8.8.2.1.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.8.8.2.1.3" xref="S2.E3.m1.8.8.2.1.3.cmml"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.2" xref="S2.E3.m1.8.8.2.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.cmml"><mjx-mo class="mjx-lop" id="S2.E3.m1.8.8.2.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.cmml"><mjx-c class="mjx-c28 TEX-S2"></mjx-c></mjx-mo><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.cmml"><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.cmml"><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.2.cmml"><mjx-mpadded><mjx-block style="width: 0.247em;"><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.2.1.cmml"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo></mjx-block></mjx-mpadded><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.2.cmml"><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.2.1.cmml"><mjx-c class="mjx-c5B"></mjx-c></mjx-mo><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.cmml"><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mrow space="2" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="3" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c68"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml"></mjx-mo><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"></mjx-mo><mjx-mrow id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml"><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.1" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2" id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow><mjx-mpadded><mjx-block style="width: 0.247em;"><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.2.1.cmml"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-block></mjx-mpadded></mjx-mrow><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.2.1.cmml" style="margin-left: 0.056em; margin-right: 0.055em;"><mjx-c class="mjx-c5D"></mjx-c></mjx-mo></mjx-mrow><mjx-mo class="mjx-n" space="4" rspace="3" id="S2.E3.m1.8.8.2.1.1.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c22C5"></mjx-c></mjx-mo><mjx-mmultiscripts id="S2.E3.m1.8.8.2.1.1.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.2" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-scripts style="vertical-align: 0.413em;"><mjx-row><mjx-cell><mjx-mo class="mjx-var" size="s" id="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.3.cmml"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-cell><mjx-cell><mjx-mo class="mjx-n" size="s" id="S2.E3.m1.8.8.2.1.1.1.1.1.3.3" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c22A4"></mjx-c></mjx-mo></mjx-cell></mjx-row><mjx-row style="height: 0.18em;"></mjx-row><mjx-row><mjx-cell><mjx-mrow size="s" id="S2.E3.m1.3.3.2" xref="S2.E3.m1.3.3.2.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.3.3.2.4" xref="S2.E3.m1.3.3.2.4.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.3.3.2.3" xref="S2.E3.m1.3.3.2.3.cmml"></mjx-mo><mjx-mrow id="S2.E3.m1.3.3.2.5.2" xref="S2.E3.m1.3.3.2.5.1.cmml"><mjx-mo class="mjx-n" id="S2.E3.m1.3.3.2.5.2.1" xref="S2.E3.m1.3.3.2.5.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.3.3.2.5.2.2" xref="S2.E3.m1.3.3.2.5.1.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E3.m1.3.3.2.2" xref="S2.E3.m1.3.3.2.2.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E3.m1.3.3.2.5.2.3" xref="S2.E3.m1.3.3.2.5.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-cell><mjx-cell><mjx-mrow size="s" id="S2.E3.m1.8.8.2.1.1.1.1.1.3a" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.cmml"></mjx-mrow></mjx-cell></mjx-row></mjx-scripts></mjx-mmultiscripts></mjx-mrow><mjx-mo class="mjx-n" id="S2.E3.m1.8.8.2.1.1.1.1.2" xref="S2.E3.m1.8.8.2.1.1.1.1.2.cmml"></mjx-mo><mjx-msub id="S2.E3.m1.8.8.2.1.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.8.8.2.1.1.1.1.3.2" xref="S2.E3.m1.8.8.2.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-msub size="s" id="S2.E3.m1.8.8.2.1.1.1.1.3.3" xref="S2.E3.m1.8.8.2.1.1.1.1.3.3.cmml"><mjx-mi class="mjx-i" id="S2.E3.m1.8.8.2.1.1.1.1.3.3.2" xref="S2.E3.m1.8.8.2.1.1.1.1.3.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E3.m1.8.8.2.1.1.1.1.3.3.3" xref="S2.E3.m1.8.8.2.1.1.1.1.3.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-lop" id="S2.E3.m1.8.8.2.1.1.1.3" xref="S2.E3.m1.8.8.2.1.1.1.1.cmml"><mjx-c class="mjx-c29 TEX-S2"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="p(w|w_{I})=\prod_{j=1}^{L(w)-1}\sigma\left([\![n(w,j+1)=\mathrm{ch}(n(w,j))]\!]\cdot{v^{\prime}_{n(w,j)}}^{\top}v_{w_{I}}\right)" display="block" class="ltx_Math"><semantics><mrow xref="S2.E3.m1.8.8.cmml"><mrow xref="S2.E3.m1.7.7.1.cmml"><mi xref="S2.E3.m1.7.7.1.3.cmml">p</mi><mo xref="S2.E3.m1.7.7.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" xref="S2.E3.m1.7.7.1.1.1.1.cmml">(</mo><mrow xref="S2.E3.m1.7.7.1.1.1.1.cmml"><mi xref="S2.E3.m1.7.7.1.1.1.1.2.cmml">w</mi><mo fence="false" xref="S2.E3.m1.7.7.1.1.1.1.1.cmml">|</mo><msub xref="S2.E3.m1.7.7.1.1.1.1.3.cmml"><mi xref="S2.E3.m1.7.7.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.E3.m1.7.7.1.1.1.1.3.3.cmml">I</mi></msub></mrow><mo stretchy="false" xref="S2.E3.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" xref="S2.E3.m1.8.8.3.cmml">=</mo><mrow xref="S2.E3.m1.8.8.2.cmml"><munderover xref="S2.E3.m1.8.8.2.2.cmml"><mo movablelimits="false" xref="S2.E3.m1.8.8.2.2.2.2.cmml">∏</mo><mrow xref="S2.E3.m1.8.8.2.2.2.3.cmml"><mi xref="S2.E3.m1.8.8.2.2.2.3.2.cmml">j</mi><mo xref="S2.E3.m1.8.8.2.2.2.3.1.cmml">=</mo><mn xref="S2.E3.m1.8.8.2.2.2.3.3.cmml">1</mn></mrow><mrow xref="S2.E3.m1.1.1.1.cmml"><mrow xref="S2.E3.m1.1.1.1.3.cmml"><mi xref="S2.E3.m1.1.1.1.3.2.cmml">L</mi><mo xref="S2.E3.m1.1.1.1.3.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E3.m1.1.1.1.3.cmml"><mo stretchy="false" xref="S2.E3.m1.1.1.1.3.cmml">(</mo><mi xref="S2.E3.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" xref="S2.E3.m1.1.1.1.3.cmml">)</mo></mrow></mrow><mo xref="S2.E3.m1.1.1.1.2.cmml">−</mo><mn xref="S2.E3.m1.1.1.1.4.cmml">1</mn></mrow></munderover><mrow xref="S2.E3.m1.8.8.2.1.cmml"><mi xref="S2.E3.m1.8.8.2.1.3.cmml">σ</mi><mo xref="S2.E3.m1.8.8.2.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.cmml"><mo xref="S2.E3.m1.8.8.2.1.1.1.1.cmml">(</mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.cmml"><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.cmml"><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.2.cmml"><mpadded width="0.247em"><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.2.1.cmml">[</mo></mpadded><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.cmml"><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">n</mi><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi xref="S2.E3.m1.4.4.cmml">w</mi><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">j</mi><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.3.cmml">=</mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">ch</mi><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">n</mi><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml"><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml">(</mo><mi xref="S2.E3.m1.5.5.cmml">w</mi><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml">,</mo><mi xref="S2.E3.m1.6.6.cmml">j</mi><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mpadded width="0.247em"><mo stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mpadded></mrow><mo rspace="0.055em" stretchy="false" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo rspace="0.222em" xref="S2.E3.m1.8.8.2.1.1.1.1.1.2.cmml">⋅</mo><mmultiscripts xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.cmml"><mi xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.2.cmml">v</mi><mrow xref="S2.E3.m1.3.3.2.cmml"><mi xref="S2.E3.m1.3.3.2.4.cmml">n</mi><mo xref="S2.E3.m1.3.3.2.3.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E3.m1.3.3.2.5.1.cmml"><mo stretchy="false" xref="S2.E3.m1.3.3.2.5.1.cmml">(</mo><mi xref="S2.E3.m1.2.2.1.1.cmml">w</mi><mo xref="S2.E3.m1.3.3.2.5.1.cmml">,</mo><mi xref="S2.E3.m1.3.3.2.2.cmml">j</mi><mo stretchy="false" xref="S2.E3.m1.3.3.2.5.1.cmml">)</mo></mrow></mrow><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.3.cmml">′</mo><mrow xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.cmml"></mrow><mo xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.3.cmml">⊤</mo></mmultiscripts></mrow><mo xref="S2.E3.m1.8.8.2.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><msub xref="S2.E3.m1.8.8.2.1.1.1.1.3.cmml"><mi xref="S2.E3.m1.8.8.2.1.1.1.1.3.2.cmml">v</mi><msub xref="S2.E3.m1.8.8.2.1.1.1.1.3.3.cmml"><mi xref="S2.E3.m1.8.8.2.1.1.1.1.3.3.2.cmml">w</mi><mi xref="S2.E3.m1.8.8.2.1.1.1.1.3.3.3.cmml">I</mi></msub></msub></mrow><mo xref="S2.E3.m1.8.8.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E3.m1.8.8.cmml" xref="S2.E3.m1.8.8"><eq id="S2.E3.m1.8.8.3.cmml" xref="S2.E3.m1.8.8.3"></eq><apply id="S2.E3.m1.7.7.1.cmml" xref="S2.E3.m1.7.7.1"><times id="S2.E3.m1.7.7.1.2.cmml" xref="S2.E3.m1.7.7.1.2"></times><ci id="S2.E3.m1.7.7.1.3.cmml" xref="S2.E3.m1.7.7.1.3">𝑝</ci><apply id="S2.E3.m1.7.7.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.7.7.1.1.1.1.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.1">conditional</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.2">𝑤</ci><apply id="S2.E3.m1.7.7.1.1.1.1.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.7.7.1.1.1.1.3.1.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.7.7.1.1.1.1.3.2.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3.2">𝑤</ci><ci id="S2.E3.m1.7.7.1.1.1.1.3.3.cmml" xref="S2.E3.m1.7.7.1.1.1.1.3.3">𝐼</ci></apply></apply></apply><apply id="S2.E3.m1.8.8.2.cmml" xref="S2.E3.m1.8.8.2"><apply id="S2.E3.m1.8.8.2.2.cmml" xref="S2.E3.m1.8.8.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.2.2.1.cmml" xref="S2.E3.m1.8.8.2.2">superscript</csymbol><apply id="S2.E3.m1.8.8.2.2.2.cmml" xref="S2.E3.m1.8.8.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.2.2.2.1.cmml" xref="S2.E3.m1.8.8.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.E3.m1.8.8.2.2.2.2.cmml" xref="S2.E3.m1.8.8.2.2.2.2">product</csymbol><apply id="S2.E3.m1.8.8.2.2.2.3.cmml" xref="S2.E3.m1.8.8.2.2.2.3"><eq id="S2.E3.m1.8.8.2.2.2.3.1.cmml" xref="S2.E3.m1.8.8.2.2.2.3.1"></eq><ci id="S2.E3.m1.8.8.2.2.2.3.2.cmml" xref="S2.E3.m1.8.8.2.2.2.3.2">𝑗</ci><cn type="integer" id="S2.E3.m1.8.8.2.2.2.3.3.cmml" xref="S2.E3.m1.8.8.2.2.2.3.3">1</cn></apply></apply><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><minus id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></minus><apply id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3"><times id="S2.E3.m1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.3.1"></times><ci id="S2.E3.m1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.3.2">𝐿</ci><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑤</ci></apply><cn type="integer" id="S2.E3.m1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.4">1</cn></apply></apply><apply id="S2.E3.m1.8.8.2.1.cmml" xref="S2.E3.m1.8.8.2.1"><times id="S2.E3.m1.8.8.2.1.2.cmml" xref="S2.E3.m1.8.8.2.1.2"></times><ci id="S2.E3.m1.8.8.2.1.3.cmml" xref="S2.E3.m1.8.8.2.1.3">𝜎</ci><apply id="S2.E3.m1.8.8.2.1.1.1.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1"><times id="S2.E3.m1.8.8.2.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.2"></times><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1"><ci id="S2.E3.m1.8.8.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.2">⋅</ci><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1"><eq id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.3"></eq><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑛</ci><interval closure="open" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4">𝑤</ci><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><plus id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑗</ci><cn type="integer" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></interval></apply><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2"><times id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.2"></times><ci id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.3">ch</ci><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1"><times id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1"></times><ci id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2">𝑛</ci><interval closure="open" id="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2"><ci id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5">𝑤</ci><ci id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6">𝑗</ci></interval></apply></apply></apply></apply></apply><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.2.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.2">𝑣</ci><ci id="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.2.2.3">′</ci></apply><apply id="S2.E3.m1.3.3.2.cmml" xref="S2.E3.m1.3.3.2"><times id="S2.E3.m1.3.3.2.3.cmml" xref="S2.E3.m1.3.3.2.3"></times><ci id="S2.E3.m1.3.3.2.4.cmml" xref="S2.E3.m1.3.3.2.4">𝑛</ci><interval closure="open" id="S2.E3.m1.3.3.2.5.1.cmml" xref="S2.E3.m1.3.3.2.5.2"><ci id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1.1">𝑤</ci><ci id="S2.E3.m1.3.3.2.2.cmml" xref="S2.E3.m1.3.3.2.2">𝑗</ci></interval></apply></apply><csymbol cd="latexml" id="S2.E3.m1.8.8.2.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.1.3.3">top</csymbol></apply></apply><apply id="S2.E3.m1.8.8.2.1.1.1.1.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.8.8.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.3.2">𝑣</ci><apply id="S2.E3.m1.8.8.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.2.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E3.m1.8.8.2.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.3.3.2">𝑤</ci><ci id="S2.E3.m1.8.8.2.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.8.8.2.1.1.1.1.3.3.3">𝐼</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">p(w|w_{I})=\prod_{j=1}^{L(w)-1}\sigma\left([\![n(w,j+1)=\mathrm{ch}(n(w,j))]\!]\cdot{v^{\prime}_{n(w,j)}}^{\top}v_{w_{I}}\right)</annotation><annotation encoding="application/x-llamapun">italic_p ( italic_w | italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L ( italic_w ) - 1 end_POSTSUPERSCRIPT italic_σ ( [ [ italic_n ( italic_w , italic_j + 1 ) = roman_ch ( italic_n ( italic_w , italic_j ) ) ] ] ⋅ italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n ( italic_w , italic_j ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.26" class="ltx_p">where <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="32" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.14.m1.3" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.14.m1.3a"><mjx-mrow id="S2.SS1.p3.14.m1.3.3" xref="S2.SS1.p3.14.m1.3.3.cmml"><mjx-mrow id="S2.SS1.p3.14.m1.3.3.3" xref="S2.SS1.p3.14.m1.3.3.3.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.14.m1.3.3.3.2" xref="S2.SS1.p3.14.m1.3.3.3.2.cmml"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.3.1" xref="S2.SS1.p3.14.m1.3.3.3.1.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.14.m1.3.3.3.3.2" xref="S2.SS1.p3.14.m1.3.3.3.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.3.3.2.1" xref="S2.SS1.p3.14.m1.3.3.3.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.14.m1.1.1" xref="S2.SS1.p3.14.m1.1.1.cmml"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.3.3.2.2" xref="S2.SS1.p3.14.m1.3.3.3.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S2.SS1.p3.14.m1.3.3.2" xref="S2.SS1.p3.14.m1.3.3.2.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4" id="S2.SS1.p3.14.m1.3.3.1" xref="S2.SS1.p3.14.m1.3.3.1.cmml"><mjx-mn class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.3" xref="S2.SS1.p3.14.m1.3.3.1.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.2" xref="S2.SS1.p3.14.m1.3.3.1.2.cmml"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p3.14.m1.3.3.1.1.1" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.1.1.2" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p3.14.m1.3.3.1.1.1.1" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml"><mjx-mn class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.3" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.2" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.2.cmml"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mrow space="3" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-n" id="S2.SS1.p3.14.m1.2.2" xref="S2.SS1.p3.14.m1.2.2.cmml"><mjx-c class="mjx-c65"></mjx-c><mjx-c class="mjx-c78"></mjx-c><mjx-c class="mjx-c70"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1a" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1a" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D465 TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.14.m1.3.3.1.1.1.3" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\sigma(x)=1/(1+\exp(-x))" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.14.m1.3.3.cmml"><mrow xref="S2.SS1.p3.14.m1.3.3.3.cmml"><mi xref="S2.SS1.p3.14.m1.3.3.3.2.cmml">σ</mi><mo xref="S2.SS1.p3.14.m1.3.3.3.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.14.m1.3.3.3.cmml"><mo stretchy="false" xref="S2.SS1.p3.14.m1.3.3.3.cmml">(</mo><mi xref="S2.SS1.p3.14.m1.1.1.cmml">x</mi><mo stretchy="false" xref="S2.SS1.p3.14.m1.3.3.3.cmml">)</mo></mrow></mrow><mo xref="S2.SS1.p3.14.m1.3.3.2.cmml">=</mo><mrow xref="S2.SS1.p3.14.m1.3.3.1.cmml"><mn xref="S2.SS1.p3.14.m1.3.3.1.3.cmml">1</mn><mo xref="S2.SS1.p3.14.m1.3.3.1.2.cmml">/</mo><mrow xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml">(</mo><mrow xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml"><mn xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.3.cmml">1</mn><mo xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.2.cmml">+</mo><mrow xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml"><mi xref="S2.SS1.p3.14.m1.2.2.cmml">exp</mi><mo xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mrow xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mi xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">x</mi></mrow><mo stretchy="false" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.14.m1.3.3.cmml" xref="S2.SS1.p3.14.m1.3.3"><eq id="S2.SS1.p3.14.m1.3.3.2.cmml" xref="S2.SS1.p3.14.m1.3.3.2"></eq><apply id="S2.SS1.p3.14.m1.3.3.3.cmml" xref="S2.SS1.p3.14.m1.3.3.3"><times id="S2.SS1.p3.14.m1.3.3.3.1.cmml" xref="S2.SS1.p3.14.m1.3.3.3.1"></times><ci id="S2.SS1.p3.14.m1.3.3.3.2.cmml" xref="S2.SS1.p3.14.m1.3.3.3.2">𝜎</ci><ci id="S2.SS1.p3.14.m1.1.1.cmml" xref="S2.SS1.p3.14.m1.1.1">𝑥</ci></apply><apply id="S2.SS1.p3.14.m1.3.3.1.cmml" xref="S2.SS1.p3.14.m1.3.3.1"><divide id="S2.SS1.p3.14.m1.3.3.1.2.cmml" xref="S2.SS1.p3.14.m1.3.3.1.2"></divide><cn type="integer" id="S2.SS1.p3.14.m1.3.3.1.3.cmml" xref="S2.SS1.p3.14.m1.3.3.1.3">1</cn><apply id="S2.SS1.p3.14.m1.3.3.1.1.1.1.cmml" xref="S2.SS1.p3.14.m1.3.3.1.1.1"><plus id="S2.SS1.p3.14.m1.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.2"></plus><cn type="integer" id="S2.SS1.p3.14.m1.3.3.1.1.1.1.3.cmml" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.3">1</cn><apply id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1"><exp id="S2.SS1.p3.14.m1.2.2.cmml" xref="S2.SS1.p3.14.m1.2.2"></exp><apply id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1"></minus><ci id="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.14.m1.3.3.1.1.1.1.1.1.1.1.2">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">\sigma(x)=1/(1+\exp(-x))</annotation><annotation encoding="application/x-llamapun">italic_σ ( italic_x ) = 1 / ( 1 + roman_exp ( - italic_x ) )</annotation></semantics></math></mjx-assistive-mml></mjx-container>. It can be verified that
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="33" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.15.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.15.m2.1a"><mjx-mrow id="S2.SS1.p3.15.m2.1.1" xref="S2.SS1.p3.15.m2.1.1.cmml"><mjx-mrow id="S2.SS1.p3.15.m2.1.1.1" xref="S2.SS1.p3.15.m2.1.1.1.cmml"><mjx-msubsup id="S2.SS1.p3.15.m2.1.1.1.2" xref="S2.SS1.p3.15.m2.1.1.1.2.cmml"><mjx-mo class="mjx-sop" id="S2.SS1.p3.15.m2.1.1.1.2.2.2" xref="S2.SS1.p3.15.m2.1.1.1.2.2.2.cmml"><mjx-c class="mjx-c2211 TEX-S1"></mjx-c></mjx-mo><mjx-script style="vertical-align: -0.285em; margin-left: 0px;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.15.m2.1.1.1.2.3" xref="S2.SS1.p3.15.m2.1.1.1.2.3.cmml"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi><mjx-spacer style="margin-top: 0.276em;"></mjx-spacer><mjx-mrow size="s" id="S2.SS1.p3.15.m2.1.1.1.2.2.3" xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.15.m2.1.1.1.2.2.3.2" xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.15.m2.1.1.1.2.2.3.1" xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.1.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.SS1.p3.15.m2.1.1.1.2.2.3.3" xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-script></mjx-msubsup><mjx-mrow space="2" id="S2.SS1.p3.15.m2.1.1.1.1" xref="S2.SS1.p3.15.m2.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.15.m2.1.1.1.1.3" xref="S2.SS1.p3.15.m2.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.15.m2.1.1.1.1.2" xref="S2.SS1.p3.15.m2.1.1.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.15.m2.1.1.1.1.1.1" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.15.m2.1.1.1.1.1.1.2" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.2" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.1" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.2" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.3" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.15.m2.1.1.1.1.1.1.3" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S2.SS1.p3.15.m2.1.1.2" xref="S2.SS1.p3.15.m2.1.1.2.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4" id="S2.SS1.p3.15.m2.1.1.3" xref="S2.SS1.p3.15.m2.1.1.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\sum_{w=1}^{W}p(w|w_{I})=1" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.15.m2.1.1.cmml"><mrow xref="S2.SS1.p3.15.m2.1.1.1.cmml"><msubsup xref="S2.SS1.p3.15.m2.1.1.1.2.cmml"><mo xref="S2.SS1.p3.15.m2.1.1.1.2.2.2.cmml">∑</mo><mrow xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.cmml"><mi xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.2.cmml">w</mi><mo xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.1.cmml">=</mo><mn xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi xref="S2.SS1.p3.15.m2.1.1.1.2.3.cmml">W</mi></msubsup><mrow xref="S2.SS1.p3.15.m2.1.1.1.1.cmml"><mi xref="S2.SS1.p3.15.m2.1.1.1.1.3.cmml">p</mi><mo xref="S2.SS1.p3.15.m2.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml"><mi xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.2.cmml">w</mi><mo fence="false" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.1.cmml">|</mo><msub xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.cmml"><mi xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.3.cmml">I</mi></msub></mrow><mo stretchy="false" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo xref="S2.SS1.p3.15.m2.1.1.2.cmml">=</mo><mn xref="S2.SS1.p3.15.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.15.m2.1.1.cmml" xref="S2.SS1.p3.15.m2.1.1"><eq id="S2.SS1.p3.15.m2.1.1.2.cmml" xref="S2.SS1.p3.15.m2.1.1.2"></eq><apply id="S2.SS1.p3.15.m2.1.1.1.cmml" xref="S2.SS1.p3.15.m2.1.1.1"><apply id="S2.SS1.p3.15.m2.1.1.1.2.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.15.m2.1.1.1.2.1.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2">superscript</csymbol><apply id="S2.SS1.p3.15.m2.1.1.1.2.2.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.15.m2.1.1.1.2.2.1.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2">subscript</csymbol><sum id="S2.SS1.p3.15.m2.1.1.1.2.2.2.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2.2.2"></sum><apply id="S2.SS1.p3.15.m2.1.1.1.2.2.3.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2.2.3"><eq id="S2.SS1.p3.15.m2.1.1.1.2.2.3.1.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.1"></eq><ci id="S2.SS1.p3.15.m2.1.1.1.2.2.3.2.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.2">𝑤</ci><cn type="integer" id="S2.SS1.p3.15.m2.1.1.1.2.2.3.3.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p3.15.m2.1.1.1.2.3.cmml" xref="S2.SS1.p3.15.m2.1.1.1.2.3">𝑊</ci></apply><apply id="S2.SS1.p3.15.m2.1.1.1.1.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1"><times id="S2.SS1.p3.15.m2.1.1.1.1.2.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.2"></times><ci id="S2.SS1.p3.15.m2.1.1.1.1.3.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.3">𝑝</ci><apply id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.2">𝑤</ci><apply id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.15.m2.1.1.1.1.1.1.1.3.3">𝐼</ci></apply></apply></apply></apply><cn type="integer" id="S2.SS1.p3.15.m2.1.1.3.cmml" xref="S2.SS1.p3.15.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex">\sum_{w=1}^{W}p(w|w_{I})=1</annotation><annotation encoding="application/x-llamapun">∑ start_POSTSUBSCRIPT italic_w = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_W end_POSTSUPERSCRIPT italic_p ( italic_w | italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT ) = 1</annotation></semantics></math></mjx-assistive-mml></mjx-container>. This implies that
the cost of computing <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="34" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.16.m3.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.16.m3.1a"><mjx-mrow id="S2.SS1.p3.16.m3.1.1" xref="S2.SS1.p3.16.m3.1.1.cmml"><mjx-mrow id="S2.SS1.p3.16.m3.1.1.3" xref="S2.SS1.p3.16.m3.1.1.3.cmml"><mjx-mi class="mjx-n" id="S2.SS1.p3.16.m3.1.1.3.1" xref="S2.SS1.p3.16.m3.1.1.3.1.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="2" id="S2.SS1.p3.16.m3.1.1.3a" xref="S2.SS1.p3.16.m3.1.1.3.cmml" style="margin-right: 0.056em;"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.16.m3.1.1.3.2" xref="S2.SS1.p3.16.m3.1.1.3.2.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.16.m3.1.1.2" xref="S2.SS1.p3.16.m3.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.16.m3.1.1.1.1" xref="S2.SS1.p3.16.m3.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.16.m3.1.1.1.1.2" xref="S2.SS1.p3.16.m3.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p3.16.m3.1.1.1.1.1" xref="S2.SS1.p3.16.m3.1.1.1.1.1.cmml"><mjx-msub id="S2.SS1.p3.16.m3.1.1.1.1.1.2" xref="S2.SS1.p3.16.m3.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.16.m3.1.1.1.1.1.2.2" xref="S2.SS1.p3.16.m3.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.16.m3.1.1.1.1.1.2.3" xref="S2.SS1.p3.16.m3.1.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS1.p3.16.m3.1.1.1.1.1.1" xref="S2.SS1.p3.16.m3.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.SS1.p3.16.m3.1.1.1.1.1.3" xref="S2.SS1.p3.16.m3.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.16.m3.1.1.1.1.1.3.2" xref="S2.SS1.p3.16.m3.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.16.m3.1.1.1.1.1.3.3" xref="S2.SS1.p3.16.m3.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.16.m3.1.1.1.1.3" xref="S2.SS1.p3.16.m3.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\log p(w_{O}|w_{I})" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.16.m3.1.1.cmml"><mrow xref="S2.SS1.p3.16.m3.1.1.3.cmml"><mi xref="S2.SS1.p3.16.m3.1.1.3.1.cmml">log</mi><mo lspace="0.167em" xref="S2.SS1.p3.16.m3.1.1.3.cmml">⁡</mo><mi xref="S2.SS1.p3.16.m3.1.1.3.2.cmml">p</mi></mrow><mo xref="S2.SS1.p3.16.m3.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.16.m3.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.16.m3.1.1.1.1.1.cmml">(</mo><mrow xref="S2.SS1.p3.16.m3.1.1.1.1.1.cmml"><msub xref="S2.SS1.p3.16.m3.1.1.1.1.1.2.cmml"><mi xref="S2.SS1.p3.16.m3.1.1.1.1.1.2.2.cmml">w</mi><mi xref="S2.SS1.p3.16.m3.1.1.1.1.1.2.3.cmml">O</mi></msub><mo fence="false" xref="S2.SS1.p3.16.m3.1.1.1.1.1.1.cmml">|</mo><msub xref="S2.SS1.p3.16.m3.1.1.1.1.1.3.cmml"><mi xref="S2.SS1.p3.16.m3.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.SS1.p3.16.m3.1.1.1.1.1.3.3.cmml">I</mi></msub></mrow><mo stretchy="false" xref="S2.SS1.p3.16.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.16.m3.1.1.cmml" xref="S2.SS1.p3.16.m3.1.1"><times id="S2.SS1.p3.16.m3.1.1.2.cmml" xref="S2.SS1.p3.16.m3.1.1.2"></times><apply id="S2.SS1.p3.16.m3.1.1.3.cmml" xref="S2.SS1.p3.16.m3.1.1.3"><log id="S2.SS1.p3.16.m3.1.1.3.1.cmml" xref="S2.SS1.p3.16.m3.1.1.3.1"></log><ci id="S2.SS1.p3.16.m3.1.1.3.2.cmml" xref="S2.SS1.p3.16.m3.1.1.3.2">𝑝</ci></apply><apply id="S2.SS1.p3.16.m3.1.1.1.1.1.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.16.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p3.16.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.16.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p3.16.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.2.2">𝑤</ci><ci id="S2.SS1.p3.16.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.2.3">𝑂</ci></apply><apply id="S2.SS1.p3.16.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.16.m3.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.16.m3.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.SS1.p3.16.m3.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.16.m3.1.1.1.1.1.3.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">\log p(w_{O}|w_{I})</annotation><annotation encoding="application/x-llamapun">roman_log italic_p ( italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container> and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="35" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.17.m4.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.17.m4.1a"><mjx-mrow id="S2.SS1.p3.17.m4.1.1" xref="S2.SS1.p3.17.m4.1.1.cmml"><mjx-mrow id="S2.SS1.p3.17.m4.1.1.3" xref="S2.SS1.p3.17.m4.1.1.3.cmml"><mjx-mrow id="S2.SS1.p3.17.m4.1.1.3.1" xref="S2.SS1.p3.17.m4.1.1.3.1.cmml"><mjx-mo class="mjx-n" space="2" rspace="2" id="S2.SS1.p3.17.m4.1.1.3.1.1" xref="S2.SS1.p3.17.m4.1.1.3.1.1.cmml"><mjx-c class="mjx-c2207"></mjx-c></mjx-mo><mjx-mi class="mjx-n" id="S2.SS1.p3.17.m4.1.1.3.1.2" xref="S2.SS1.p3.17.m4.1.1.3.1.2.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" space="2" id="S2.SS1.p3.17.m4.1.1.3a" xref="S2.SS1.p3.17.m4.1.1.3.cmml" style="margin-right: 0.056em;"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.17.m4.1.1.3.2" xref="S2.SS1.p3.17.m4.1.1.3.2.cmml"><mjx-c class="mjx-c1D45D TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.17.m4.1.1.2" xref="S2.SS1.p3.17.m4.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.17.m4.1.1.1.1" xref="S2.SS1.p3.17.m4.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.17.m4.1.1.1.1.2" xref="S2.SS1.p3.17.m4.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.SS1.p3.17.m4.1.1.1.1.1" xref="S2.SS1.p3.17.m4.1.1.1.1.1.cmml"><mjx-msub id="S2.SS1.p3.17.m4.1.1.1.1.1.2" xref="S2.SS1.p3.17.m4.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.17.m4.1.1.1.1.1.2.2" xref="S2.SS1.p3.17.m4.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.17.m4.1.1.1.1.1.2.3" xref="S2.SS1.p3.17.m4.1.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS1.p3.17.m4.1.1.1.1.1.1" xref="S2.SS1.p3.17.m4.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.SS1.p3.17.m4.1.1.1.1.1.3" xref="S2.SS1.p3.17.m4.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.17.m4.1.1.1.1.1.3.2" xref="S2.SS1.p3.17.m4.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.17.m4.1.1.1.1.1.3.3" xref="S2.SS1.p3.17.m4.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS1.p3.17.m4.1.1.1.1.3" xref="S2.SS1.p3.17.m4.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\nabla\log p(w_{O}|w_{I})" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.17.m4.1.1.cmml"><mrow xref="S2.SS1.p3.17.m4.1.1.3.cmml"><mrow xref="S2.SS1.p3.17.m4.1.1.3.1.cmml"><mo rspace="0.167em" xref="S2.SS1.p3.17.m4.1.1.3.1.1.cmml">∇</mo><mi xref="S2.SS1.p3.17.m4.1.1.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" xref="S2.SS1.p3.17.m4.1.1.3.cmml">⁡</mo><mi xref="S2.SS1.p3.17.m4.1.1.3.2.cmml">p</mi></mrow><mo xref="S2.SS1.p3.17.m4.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.17.m4.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.17.m4.1.1.1.1.1.cmml">(</mo><mrow xref="S2.SS1.p3.17.m4.1.1.1.1.1.cmml"><msub xref="S2.SS1.p3.17.m4.1.1.1.1.1.2.cmml"><mi xref="S2.SS1.p3.17.m4.1.1.1.1.1.2.2.cmml">w</mi><mi xref="S2.SS1.p3.17.m4.1.1.1.1.1.2.3.cmml">O</mi></msub><mo fence="false" xref="S2.SS1.p3.17.m4.1.1.1.1.1.1.cmml">|</mo><msub xref="S2.SS1.p3.17.m4.1.1.1.1.1.3.cmml"><mi xref="S2.SS1.p3.17.m4.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.SS1.p3.17.m4.1.1.1.1.1.3.3.cmml">I</mi></msub></mrow><mo stretchy="false" xref="S2.SS1.p3.17.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.17.m4.1.1.cmml" xref="S2.SS1.p3.17.m4.1.1"><times id="S2.SS1.p3.17.m4.1.1.2.cmml" xref="S2.SS1.p3.17.m4.1.1.2"></times><apply id="S2.SS1.p3.17.m4.1.1.3.cmml" xref="S2.SS1.p3.17.m4.1.1.3"><apply id="S2.SS1.p3.17.m4.1.1.3.1.cmml" xref="S2.SS1.p3.17.m4.1.1.3.1"><ci id="S2.SS1.p3.17.m4.1.1.3.1.1.cmml" xref="S2.SS1.p3.17.m4.1.1.3.1.1">∇</ci><log id="S2.SS1.p3.17.m4.1.1.3.1.2.cmml" xref="S2.SS1.p3.17.m4.1.1.3.1.2"></log></apply><ci id="S2.SS1.p3.17.m4.1.1.3.2.cmml" xref="S2.SS1.p3.17.m4.1.1.3.2">𝑝</ci></apply><apply id="S2.SS1.p3.17.m4.1.1.1.1.1.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.17.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p3.17.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p3.17.m4.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p3.17.m4.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.2.2">𝑤</ci><ci id="S2.SS1.p3.17.m4.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.2.3">𝑂</ci></apply><apply id="S2.SS1.p3.17.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.17.m4.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.17.m4.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.SS1.p3.17.m4.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p3.17.m4.1.1.1.1.1.3.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">\nabla\log p(w_{O}|w_{I})</annotation><annotation encoding="application/x-llamapun">∇ roman_log italic_p ( italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container> is proportional to <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="36" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.18.m5.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.18.m5.1a"><mjx-mrow id="S2.SS1.p3.18.m5.1.1" xref="S2.SS1.p3.18.m5.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.18.m5.1.1.3" xref="S2.SS1.p3.18.m5.1.1.3.cmml"><mjx-c class="mjx-c1D43F TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS1.p3.18.m5.1.1.2" xref="S2.SS1.p3.18.m5.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.SS1.p3.18.m5.1.1.1.1" xref="S2.SS1.p3.18.m5.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS1.p3.18.m5.1.1.1.1.2" xref="S2.SS1.p3.18.m5.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub id="S2.SS1.p3.18.m5.1.1.1.1.1" xref="S2.SS1.p3.18.m5.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.18.m5.1.1.1.1.1.2" xref="S2.SS1.p3.18.m5.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.18.m5.1.1.1.1.1.3" xref="S2.SS1.p3.18.m5.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS1.p3.18.m5.1.1.1.1.3" xref="S2.SS1.p3.18.m5.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="L(w_{O})" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.18.m5.1.1.cmml"><mi xref="S2.SS1.p3.18.m5.1.1.3.cmml">L</mi><mo xref="S2.SS1.p3.18.m5.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS1.p3.18.m5.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS1.p3.18.m5.1.1.1.1.1.cmml">(</mo><msub xref="S2.SS1.p3.18.m5.1.1.1.1.1.cmml"><mi xref="S2.SS1.p3.18.m5.1.1.1.1.1.2.cmml">w</mi><mi xref="S2.SS1.p3.18.m5.1.1.1.1.1.3.cmml">O</mi></msub><mo stretchy="false" xref="S2.SS1.p3.18.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.18.m5.1.1.cmml" xref="S2.SS1.p3.18.m5.1.1"><times id="S2.SS1.p3.18.m5.1.1.2.cmml" xref="S2.SS1.p3.18.m5.1.1.2"></times><ci id="S2.SS1.p3.18.m5.1.1.3.cmml" xref="S2.SS1.p3.18.m5.1.1.3">𝐿</ci><apply id="S2.SS1.p3.18.m5.1.1.1.1.1.cmml" xref="S2.SS1.p3.18.m5.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.18.m5.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.18.m5.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.18.m5.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.18.m5.1.1.1.1.1.2">𝑤</ci><ci id="S2.SS1.p3.18.m5.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.18.m5.1.1.1.1.1.3">𝑂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex">L(w_{O})</annotation><annotation encoding="application/x-llamapun">italic_L ( italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container>, which on average is no greater
than <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="37" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.19.m6.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.19.m6.1a"><mjx-mrow id="S2.SS1.p3.19.m6.1.1" xref="S2.SS1.p3.19.m6.1.1.cmml"><mjx-mi class="mjx-n" id="S2.SS1.p3.19.m6.1.1.1" xref="S2.SS1.p3.19.m6.1.1.1.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="2" id="S2.SS1.p3.19.m6.1.1a" xref="S2.SS1.p3.19.m6.1.1.cmml" style="margin-right: 0.056em;"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS1.p3.19.m6.1.1.2" xref="S2.SS1.p3.19.m6.1.1.2.cmml"><mjx-c class="mjx-c1D44A TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\log W" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS1.p3.19.m6.1.1.cmml"><mi xref="S2.SS1.p3.19.m6.1.1.1.cmml">log</mi><mo lspace="0.167em" xref="S2.SS1.p3.19.m6.1.1.cmml">⁡</mo><mi xref="S2.SS1.p3.19.m6.1.1.2.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.19.m6.1.1.cmml" xref="S2.SS1.p3.19.m6.1.1"><log id="S2.SS1.p3.19.m6.1.1.1.cmml" xref="S2.SS1.p3.19.m6.1.1.1"></log><ci id="S2.SS1.p3.19.m6.1.1.2.cmml" xref="S2.SS1.p3.19.m6.1.1.2">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex">\log W</annotation><annotation encoding="application/x-llamapun">roman_log italic_W</annotation></semantics></math></mjx-assistive-mml></mjx-container>. Also, unlike the standard softmax formulation of the Skip-gram
which assigns two representations <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="38" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.20.m7.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.20.m7.1a"><mjx-msub id="S2.SS1.p3.20.m7.1.1" xref="S2.SS1.p3.20.m7.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.20.m7.1.1.2" xref="S2.SS1.p3.20.m7.1.1.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.20.m7.1.1.3" xref="S2.SS1.p3.20.m7.1.1.3.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="v_{w}" display="inline" class="ltx_Math"><semantics><msub xref="S2.SS1.p3.20.m7.1.1.cmml"><mi xref="S2.SS1.p3.20.m7.1.1.2.cmml">v</mi><mi xref="S2.SS1.p3.20.m7.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.20.m7.1.1.cmml" xref="S2.SS1.p3.20.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.20.m7.1.1.1.cmml" xref="S2.SS1.p3.20.m7.1.1">subscript</csymbol><ci id="S2.SS1.p3.20.m7.1.1.2.cmml" xref="S2.SS1.p3.20.m7.1.1.2">𝑣</ci><ci id="S2.SS1.p3.20.m7.1.1.3.cmml" xref="S2.SS1.p3.20.m7.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">v_{w}</annotation><annotation encoding="application/x-llamapun">italic_v start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="39" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.21.m8.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.21.m8.1a"><mjx-msubsup id="S2.SS1.p3.21.m8.1.1" xref="S2.SS1.p3.21.m8.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.21.m8.1.1.2.2" xref="S2.SS1.p3.21.m8.1.1.2.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mo class="mjx-var" size="s" id="S2.SS1.p3.21.m8.1.1.2.3" xref="S2.SS1.p3.21.m8.1.1.2.3.cmml"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo><mjx-spacer style="margin-top: 0.327em;"></mjx-spacer><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.21.m8.1.1.3" xref="S2.SS1.p3.21.m8.1.1.3.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="v^{\prime}_{w}" display="inline" class="ltx_Math"><semantics><msubsup xref="S2.SS1.p3.21.m8.1.1.cmml"><mi xref="S2.SS1.p3.21.m8.1.1.2.2.cmml">v</mi><mi xref="S2.SS1.p3.21.m8.1.1.3.cmml">w</mi><mo xref="S2.SS1.p3.21.m8.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.21.m8.1.1.cmml" xref="S2.SS1.p3.21.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.21.m8.1.1.1.cmml" xref="S2.SS1.p3.21.m8.1.1">subscript</csymbol><apply id="S2.SS1.p3.21.m8.1.1.2.cmml" xref="S2.SS1.p3.21.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.21.m8.1.1.2.1.cmml" xref="S2.SS1.p3.21.m8.1.1">superscript</csymbol><ci id="S2.SS1.p3.21.m8.1.1.2.2.cmml" xref="S2.SS1.p3.21.m8.1.1.2.2">𝑣</ci><ci id="S2.SS1.p3.21.m8.1.1.2.3.cmml" xref="S2.SS1.p3.21.m8.1.1.2.3">′</ci></apply><ci id="S2.SS1.p3.21.m8.1.1.3.cmml" xref="S2.SS1.p3.21.m8.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">v^{\prime}_{w}</annotation><annotation encoding="application/x-llamapun">italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> to each word <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="40" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.22.m9.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.22.m9.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.22.m9.1.1" xref="S2.SS1.p3.22.m9.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.22.m9.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.22.m9.1.1.cmml" xref="S2.SS1.p3.22.m9.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex">w</annotation><annotation encoding="application/x-llamapun">italic_w</annotation></semantics></math></mjx-assistive-mml></mjx-container>, the
hierarchical softmax formulation has
one representation <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="41" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.23.m10.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.23.m10.1a"><mjx-msub id="S2.SS1.p3.23.m10.1.1" xref="S2.SS1.p3.23.m10.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.23.m10.1.1.2" xref="S2.SS1.p3.23.m10.1.1.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.23.m10.1.1.3" xref="S2.SS1.p3.23.m10.1.1.3.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="v_{w}" display="inline" class="ltx_Math"><semantics><msub xref="S2.SS1.p3.23.m10.1.1.cmml"><mi xref="S2.SS1.p3.23.m10.1.1.2.cmml">v</mi><mi xref="S2.SS1.p3.23.m10.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.23.m10.1.1.cmml" xref="S2.SS1.p3.23.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.23.m10.1.1.1.cmml" xref="S2.SS1.p3.23.m10.1.1">subscript</csymbol><ci id="S2.SS1.p3.23.m10.1.1.2.cmml" xref="S2.SS1.p3.23.m10.1.1.2">𝑣</ci><ci id="S2.SS1.p3.23.m10.1.1.3.cmml" xref="S2.SS1.p3.23.m10.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">v_{w}</annotation><annotation encoding="application/x-llamapun">italic_v start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> for each word <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="42" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.24.m11.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.24.m11.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.24.m11.1.1" xref="S2.SS1.p3.24.m11.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.24.m11.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.24.m11.1.1.cmml" xref="S2.SS1.p3.24.m11.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex">w</annotation><annotation encoding="application/x-llamapun">italic_w</annotation></semantics></math></mjx-assistive-mml></mjx-container> and one representation <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="43" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.25.m12.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.25.m12.1a"><mjx-msubsup id="S2.SS1.p3.25.m12.1.1" xref="S2.SS1.p3.25.m12.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS1.p3.25.m12.1.1.2.2" xref="S2.SS1.p3.25.m12.1.1.2.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.247em; margin-left: 0px;"><mjx-mo class="mjx-var" size="s" id="S2.SS1.p3.25.m12.1.1.2.3" xref="S2.SS1.p3.25.m12.1.1.2.3.cmml"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo><mjx-spacer style="margin-top: 0.328em;"></mjx-spacer><mjx-mi class="mjx-i" size="s" id="S2.SS1.p3.25.m12.1.1.3" xref="S2.SS1.p3.25.m12.1.1.3.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msubsup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="v^{\prime}_{n}" display="inline" class="ltx_Math"><semantics><msubsup xref="S2.SS1.p3.25.m12.1.1.cmml"><mi xref="S2.SS1.p3.25.m12.1.1.2.2.cmml">v</mi><mi xref="S2.SS1.p3.25.m12.1.1.3.cmml">n</mi><mo xref="S2.SS1.p3.25.m12.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.25.m12.1.1.cmml" xref="S2.SS1.p3.25.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.25.m12.1.1.1.cmml" xref="S2.SS1.p3.25.m12.1.1">subscript</csymbol><apply id="S2.SS1.p3.25.m12.1.1.2.cmml" xref="S2.SS1.p3.25.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.25.m12.1.1.2.1.cmml" xref="S2.SS1.p3.25.m12.1.1">superscript</csymbol><ci id="S2.SS1.p3.25.m12.1.1.2.2.cmml" xref="S2.SS1.p3.25.m12.1.1.2.2">𝑣</ci><ci id="S2.SS1.p3.25.m12.1.1.2.3.cmml" xref="S2.SS1.p3.25.m12.1.1.2.3">′</ci></apply><ci id="S2.SS1.p3.25.m12.1.1.3.cmml" xref="S2.SS1.p3.25.m12.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex">v^{\prime}_{n}</annotation><annotation encoding="application/x-llamapun">italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container>
for every inner node <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="44" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS1.p3.26.m13.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS1.p3.26.m13.1a"><mjx-mi class="mjx-i" id="S2.SS1.p3.26.m13.1.1" xref="S2.SS1.p3.26.m13.1.1.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="n" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS1.p3.26.m13.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS1.p3.26.m13.1.1.cmml" xref="S2.SS1.p3.26.m13.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex">n</annotation><annotation encoding="application/x-llamapun">italic_n</annotation></semantics></math></mjx-assistive-mml></mjx-container> of the binary tree.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para ltx_noindent">
<p id="S2.SS1.p4.1" class="ltx_p">The structure of the tree used by the hierarchical softmax has
a considerable effect on the performance. Mnih and Hinton
explored a number of methods for constructing the tree structure
and the effect on both the training time and the resulting model accuracy&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
In our work we use a binary Huffman tree, as it assigns short codes to the frequent words
which results in fast training. It has been observed before that grouping words together
by their frequency works well as a very simple speedup technique for the neural
network based language models&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<figure id="S2.F2" class="ltx_figure">
<p id="S2.F2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S2.F2.1.1" class="ltx_text"><img src="/html/1310.4546/assets/x2.png" id="S2.F2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="685" height="479" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Two-dimensional PCA projection of the
1000-dimensional Skip-gram vectors of countries and their capital
cities. The figure illustrates ability of the model to automatically organize
concepts and learn implicitly the relationships between them, as during the
training we did not provide any supervised information about what a capital
city means.</figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Negative Sampling</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">An alternative to the hierarchical softmax is Noise Contrastive
Estimation (NCE), which was introduced by Gutmann and Hyvarinen&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>
and applied to language modeling by Mnih and Teh&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
NCE posits that a good model should be able to
differentiate data from noise by means of logistic regression. This is
similar to hinge loss used by Collobert and Weston&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> who trained
the models by ranking the data above noise.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.7" class="ltx_p">While NCE can be shown to approximately maximize the log
probability of the softmax, the Skip-gram model is only concerned with learning
high-quality vector representations, so we are free to simplify NCE as
long as the vector representations retain their quality. We define Negative sampling (NEG)
by the objective</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="45" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.E4.m1.3" class="ltx_Math MJX-TEX" display="true" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-semantics id="S2.E4.m1.3a"><mjx-mrow id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml"><mjx-mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.cmml"><mjx-mrow id="S2.E4.m1.2.2.1.3" xref="S2.E4.m1.2.2.1.3.cmml"><mjx-mi class="mjx-n" id="S2.E4.m1.2.2.1.3.1" xref="S2.E4.m1.2.2.1.3.1.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="2" id="S2.E4.m1.2.2.1.3a" xref="S2.E4.m1.2.2.1.3.cmml" style="margin-right: 0.056em;"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E4.m1.2.2.1.3.2" xref="S2.E4.m1.2.2.1.3.2.cmml"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E4.m1.2.2.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.E4.m1.2.2.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><mjx-mmultiscripts id="S2.E4.m1.2.2.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.2.2.1.1.1.1.2.2.2.2" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-scripts style="vertical-align: 0.413em;"><mjx-row><mjx-cell><mjx-mo class="mjx-var" size="s" id="S2.E4.m1.2.2.1.1.1.1.2.2.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.3.cmml"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-cell><mjx-cell><mjx-mo class="mjx-n" size="s" id="S2.E4.m1.2.2.1.1.1.1.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c22A4"></mjx-c></mjx-mo></mjx-cell></mjx-row><mjx-row style="height: 0.347em;"></mjx-row><mjx-row><mjx-cell><mjx-msub size="s" id="S2.E4.m1.2.2.1.1.1.1.2.2.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E4.m1.2.2.1.1.1.1.2.2.3.3" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-cell><mjx-cell><mjx-mrow size="s" id="S2.E4.m1.2.2.1.1.1.1.2a" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"></mjx-mrow></mjx-cell></mjx-row></mjx-scripts></mjx-mmultiscripts><mjx-mo class="mjx-n" id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.cmml"></mjx-mo><mjx-msub id="S2.E4.m1.2.2.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.2.2.1.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-msub size="s" id="S2.E4.m1.2.2.1.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.1.3.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.2.2.1.1.1.1.3.3.2" xref="S2.E4.m1.2.2.1.1.1.1.3.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E4.m1.2.2.1.1.1.1.3.3.3" xref="S2.E4.m1.2.2.1.1.1.1.3.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S2.E4.m1.3.3.3" xref="S2.E4.m1.3.3.3.cmml" style="margin-right: 0.055em;"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mrow id="S2.E4.m1.3.3.2" xref="S2.E4.m1.3.3.2.cmml"><mjx-munderover id="S2.E4.m1.3.3.2.2" xref="S2.E4.m1.3.3.2.2.cmml"><mjx-over style="padding-bottom: 0.192em; padding-left: 0.538em;"><mjx-mi class="mjx-i" size="s" id="S2.E4.m1.3.3.2.2.3" xref="S2.E4.m1.3.3.2.2.3.cmml"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop" id="S2.E4.m1.3.3.2.2.2.2" xref="S2.E4.m1.3.3.2.2.2.2.cmml"><mjx-c class="mjx-c2211 TEX-S2"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top: 0.167em; padding-left: 0.148em;"><mjx-mrow size="s" id="S2.E4.m1.3.3.2.2.2.3" xref="S2.E4.m1.3.3.2.2.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.3.3.2.2.2.3.2" xref="S2.E4.m1.3.3.2.2.2.3.2.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E4.m1.3.3.2.2.2.3.1" xref="S2.E4.m1.3.3.2.2.2.3.1.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.E4.m1.3.3.2.2.2.3.3" xref="S2.E4.m1.3.3.2.2.2.3.3.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn></mjx-mrow></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mrow space="2" id="S2.E4.m1.3.3.2.1" xref="S2.E4.m1.3.3.2.1.cmml"><mjx-msub id="S2.E4.m1.3.3.2.1.3" xref="S2.E4.m1.3.3.2.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.3.3.2.1.3.2" xref="S2.E4.m1.3.3.2.1.3.2.cmml"><mjx-c class="mjx-c1D53C TEX-A"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.177em;"><mjx-mrow size="s" id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.cmml"><mjx-msub id="S2.E4.m1.1.1.1.3" xref="S2.E4.m1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E4.m1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.E4.m1.1.1.1.2" xref="S2.E4.m1.1.1.1.2.cmml"><mjx-c class="mjx-c223C"></mjx-c></mjx-mo><mjx-mrow id="S2.E4.m1.1.1.1.4" xref="S2.E4.m1.1.1.1.4.cmml"><mjx-msub id="S2.E4.m1.1.1.1.4.2" xref="S2.E4.m1.1.1.1.4.2.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.1.1.1.4.2.2" xref="S2.E4.m1.1.1.1.4.2.2.cmml"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.109em;"><mjx-mi class="mjx-i" size="s" id="S2.E4.m1.1.1.1.4.2.3" xref="S2.E4.m1.1.1.1.4.2.3.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.E4.m1.1.1.1.4.1" xref="S2.E4.m1.1.1.1.4.1.cmml"></mjx-mo><mjx-mrow id="S2.E4.m1.1.1.1.4.3.2" xref="S2.E4.m1.1.1.1.4.cmml"><mjx-mo class="mjx-n" id="S2.E4.m1.1.1.1.4.3.2.1" xref="S2.E4.m1.1.1.1.4.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E4.m1.1.1.1.4.3.2.2" xref="S2.E4.m1.1.1.1.4.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.E4.m1.3.3.2.1.2" xref="S2.E4.m1.3.3.2.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E4.m1.3.3.2.1.1.1" xref="S2.E4.m1.3.3.2.1.1.2.cmml"><mjx-mo class="mjx-sop" id="S2.E4.m1.3.3.2.1.1.1.2" xref="S2.E4.m1.3.3.2.1.1.2.1.cmml"><mjx-c class="mjx-c5B TEX-S1"></mjx-c></mjx-mo><mjx-mrow id="S2.E4.m1.3.3.2.1.1.1.1" xref="S2.E4.m1.3.3.2.1.1.1.1.cmml"><mjx-mrow id="S2.E4.m1.3.3.2.1.1.1.1.3" xref="S2.E4.m1.3.3.2.1.1.1.1.3.cmml"><mjx-mi class="mjx-n" id="S2.E4.m1.3.3.2.1.1.1.1.3.1" xref="S2.E4.m1.3.3.2.1.1.1.1.3.1.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="2" id="S2.E4.m1.3.3.2.1.1.1.1.3a" xref="S2.E4.m1.3.3.2.1.1.1.1.3.cmml" style="margin-right: 0.056em;"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.E4.m1.3.3.2.1.1.1.1.3.2" xref="S2.E4.m1.3.3.2.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D70E TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.E4.m1.3.3.2.1.1.1.1.2" xref="S2.E4.m1.3.3.2.1.1.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E4.m1.3.3.2.1.1.1.1.1.1" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.2" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1a" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mrow id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.cmml"><mjx-mmultiscripts id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-scripts style="vertical-align: 0.413em;"><mjx-row><mjx-cell><mjx-mo class="mjx-var" size="s" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mjx-c class="mjx-c2032"></mjx-c></mjx-mo></mjx-cell><mjx-cell><mjx-mo class="mjx-n" size="s" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.3" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.3.cmml"><mjx-c class="mjx-c22A4"></mjx-c></mjx-mo></mjx-cell></mjx-row><mjx-row style="height: 0.347em;"></mjx-row><mjx-row><mjx-cell><mjx-msub size="s" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.2" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.3" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-cell><mjx-cell><mjx-mrow size="s" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2a" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.cmml"></mjx-mrow></mjx-cell></mjx-row></mjx-scripts></mjx-mmultiscripts><mjx-mo class="mjx-n" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.1" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.1.cmml"></mjx-mo><mjx-msub id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.2" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.2.cmml"><mjx-c class="mjx-c1D463 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-msub size="s" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.cmml"><mjx-mi class="mjx-i" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.2" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.3" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-script></mjx-msub></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.3" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-sop" id="S2.E4.m1.3.3.2.1.1.1.3" xref="S2.E4.m1.3.3.2.1.1.2.1.cmml"><mjx-c class="mjx-c5D TEX-S1"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\log\sigma({v^{\prime}_{w_{O}}}^{\top}v_{w_{I}})+\sum_{i=1}^{k}\mathbb{E}_{w_{i}\sim P_{n}(w)}\left[\log\sigma(-{v^{\prime}_{w_{i}}}^{\top}v_{w_{I}})\right]" display="block" class="ltx_Math"><semantics><mrow xref="S2.E4.m1.3.3.cmml"><mrow xref="S2.E4.m1.2.2.1.cmml"><mrow xref="S2.E4.m1.2.2.1.3.cmml"><mi xref="S2.E4.m1.2.2.1.3.1.cmml">log</mi><mo lspace="0.167em" xref="S2.E4.m1.2.2.1.3.cmml">⁡</mo><mi xref="S2.E4.m1.2.2.1.3.2.cmml">σ</mi></mrow><mo xref="S2.E4.m1.2.2.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E4.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.cmml">(</mo><mrow xref="S2.E4.m1.2.2.1.1.1.1.cmml"><mmultiscripts xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"><mi xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.2.cmml">v</mi><msub xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml"><mi xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml">w</mi><mi xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml">O</mi></msub><mo xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.3.cmml">′</mo><mrow xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"></mrow><mo xref="S2.E4.m1.2.2.1.1.1.1.2.3.cmml">⊤</mo></mmultiscripts><mo xref="S2.E4.m1.2.2.1.1.1.1.1.cmml" lspace="0px" rspace="0px"></mo><msub xref="S2.E4.m1.2.2.1.1.1.1.3.cmml"><mi xref="S2.E4.m1.2.2.1.1.1.1.3.2.cmml">v</mi><msub xref="S2.E4.m1.2.2.1.1.1.1.3.3.cmml"><mi xref="S2.E4.m1.2.2.1.1.1.1.3.3.2.cmml">w</mi><mi xref="S2.E4.m1.2.2.1.1.1.1.3.3.3.cmml">I</mi></msub></msub></mrow><mo stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.055em" xref="S2.E4.m1.3.3.3.cmml">+</mo><mrow xref="S2.E4.m1.3.3.2.cmml"><munderover xref="S2.E4.m1.3.3.2.2.cmml"><mo movablelimits="false" xref="S2.E4.m1.3.3.2.2.2.2.cmml">∑</mo><mrow xref="S2.E4.m1.3.3.2.2.2.3.cmml"><mi xref="S2.E4.m1.3.3.2.2.2.3.2.cmml">i</mi><mo xref="S2.E4.m1.3.3.2.2.2.3.1.cmml">=</mo><mn xref="S2.E4.m1.3.3.2.2.2.3.3.cmml">1</mn></mrow><mi xref="S2.E4.m1.3.3.2.2.3.cmml">k</mi></munderover><mrow xref="S2.E4.m1.3.3.2.1.cmml"><msub xref="S2.E4.m1.3.3.2.1.3.cmml"><mi xref="S2.E4.m1.3.3.2.1.3.2.cmml">𝔼</mi><mrow xref="S2.E4.m1.1.1.1.cmml"><msub xref="S2.E4.m1.1.1.1.3.cmml"><mi xref="S2.E4.m1.1.1.1.3.2.cmml">w</mi><mi xref="S2.E4.m1.1.1.1.3.3.cmml">i</mi></msub><mo xref="S2.E4.m1.1.1.1.2.cmml">∼</mo><mrow xref="S2.E4.m1.1.1.1.4.cmml"><msub xref="S2.E4.m1.1.1.1.4.2.cmml"><mi xref="S2.E4.m1.1.1.1.4.2.2.cmml">P</mi><mi xref="S2.E4.m1.1.1.1.4.2.3.cmml">n</mi></msub><mo xref="S2.E4.m1.1.1.1.4.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E4.m1.1.1.1.4.cmml"><mo stretchy="false" xref="S2.E4.m1.1.1.1.4.cmml">(</mo><mi xref="S2.E4.m1.1.1.1.1.cmml">w</mi><mo stretchy="false" xref="S2.E4.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo xref="S2.E4.m1.3.3.2.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E4.m1.3.3.2.1.1.2.cmml"><mo xref="S2.E4.m1.3.3.2.1.1.2.1.cmml">[</mo><mrow xref="S2.E4.m1.3.3.2.1.1.1.1.cmml"><mrow xref="S2.E4.m1.3.3.2.1.1.1.1.3.cmml"><mi xref="S2.E4.m1.3.3.2.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" xref="S2.E4.m1.3.3.2.1.1.1.1.3.cmml">⁡</mo><mi xref="S2.E4.m1.3.3.2.1.1.1.1.3.2.cmml">σ</mi></mrow><mo xref="S2.E4.m1.3.3.2.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml">(</mo><mrow xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mo xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml">−</mo><mrow xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.cmml"><mmultiscripts xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.cmml"><mi xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml">v</mi><msub xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml">w</mi><mi xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml">i</mi></msub><mo xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">′</mo><mrow xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.cmml"></mrow><mo xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.3.cmml">⊤</mo></mmultiscripts><mo xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.1.cmml" lspace="0px" rspace="0px"></mo><msub xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.cmml"><mi xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.2.cmml">v</mi><msub xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.cmml"><mi xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.2.cmml">w</mi><mi xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.3.cmml">I</mi></msub></msub></mrow></mrow><mo stretchy="false" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo xref="S2.E4.m1.3.3.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3"><plus id="S2.E4.m1.3.3.3.cmml" xref="S2.E4.m1.3.3.3"></plus><apply id="S2.E4.m1.2.2.1.cmml" xref="S2.E4.m1.2.2.1"><times id="S2.E4.m1.2.2.1.2.cmml" xref="S2.E4.m1.2.2.1.2"></times><apply id="S2.E4.m1.2.2.1.3.cmml" xref="S2.E4.m1.2.2.1.3"><log id="S2.E4.m1.2.2.1.3.1.cmml" xref="S2.E4.m1.2.2.1.3.1"></log><ci id="S2.E4.m1.2.2.1.3.2.cmml" xref="S2.E4.m1.2.2.1.3.2">𝜎</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"></times><apply id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">subscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.2">𝑣</ci><ci id="S2.E4.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.2.3">′</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.2">𝑤</ci><ci id="S2.E4.m1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.2.3.3">𝑂</ci></apply></apply><csymbol cd="latexml" id="S2.E4.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.2.3">top</csymbol></apply><apply id="S2.E4.m1.2.2.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3.2">𝑣</ci><apply id="S2.E4.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3.3.2">𝑤</ci><ci id="S2.E4.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3.3.3">𝐼</ci></apply></apply></apply></apply><apply id="S2.E4.m1.3.3.2.cmml" xref="S2.E4.m1.3.3.2"><apply id="S2.E4.m1.3.3.2.2.cmml" xref="S2.E4.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.2.1.cmml" xref="S2.E4.m1.3.3.2.2">superscript</csymbol><apply id="S2.E4.m1.3.3.2.2.2.cmml" xref="S2.E4.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.2.2.1.cmml" xref="S2.E4.m1.3.3.2.2">subscript</csymbol><sum id="S2.E4.m1.3.3.2.2.2.2.cmml" xref="S2.E4.m1.3.3.2.2.2.2"></sum><apply id="S2.E4.m1.3.3.2.2.2.3.cmml" xref="S2.E4.m1.3.3.2.2.2.3"><eq id="S2.E4.m1.3.3.2.2.2.3.1.cmml" xref="S2.E4.m1.3.3.2.2.2.3.1"></eq><ci id="S2.E4.m1.3.3.2.2.2.3.2.cmml" xref="S2.E4.m1.3.3.2.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E4.m1.3.3.2.2.2.3.3.cmml" xref="S2.E4.m1.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.3.3.2.2.3.cmml" xref="S2.E4.m1.3.3.2.2.3">𝑘</ci></apply><apply id="S2.E4.m1.3.3.2.1.cmml" xref="S2.E4.m1.3.3.2.1"><times id="S2.E4.m1.3.3.2.1.2.cmml" xref="S2.E4.m1.3.3.2.1.2"></times><apply id="S2.E4.m1.3.3.2.1.3.cmml" xref="S2.E4.m1.3.3.2.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.1.3.1.cmml" xref="S2.E4.m1.3.3.2.1.3">subscript</csymbol><ci id="S2.E4.m1.3.3.2.1.3.2.cmml" xref="S2.E4.m1.3.3.2.1.3.2">𝔼</ci><apply id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.2">similar-to</csymbol><apply id="S2.E4.m1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.3.2">𝑤</ci><ci id="S2.E4.m1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.E4.m1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.4"><times id="S2.E4.m1.1.1.1.4.1.cmml" xref="S2.E4.m1.1.1.1.4.1"></times><apply id="S2.E4.m1.1.1.1.4.2.cmml" xref="S2.E4.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.4.2.1.cmml" xref="S2.E4.m1.1.1.1.4.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.4.2.2.cmml" xref="S2.E4.m1.1.1.1.4.2.2">𝑃</ci><ci id="S2.E4.m1.1.1.1.4.2.3.cmml" xref="S2.E4.m1.1.1.1.4.2.3">𝑛</ci></apply><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑤</ci></apply></apply></apply><apply id="S2.E4.m1.3.3.2.1.1.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.3.3.2.1.1.2.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.3.3.2.1.1.1.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1"><times id="S2.E4.m1.3.3.2.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.2"></times><apply id="S2.E4.m1.3.3.2.1.1.1.1.3.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.3"><log id="S2.E4.m1.3.3.2.1.1.1.1.3.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.3.1"></log><ci id="S2.E4.m1.3.3.2.1.1.1.1.3.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.3.2">𝜎</ci></apply><apply id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1"><minus id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1"></minus><apply id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2"><times id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.1"></times><apply id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.2">𝑣</ci><ci id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.2.3">′</ci></apply><apply id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.2">𝑤</ci><ci id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.2.3.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.2.3">top</csymbol></apply><apply id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.2">𝑣</ci><apply id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.2">𝑤</ci><ci id="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S2.E4.m1.3.3.2.1.1.1.1.1.1.1.2.3.3.3">𝐼</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">\log\sigma({v^{\prime}_{w_{O}}}^{\top}v_{w_{I}})+\sum_{i=1}^{k}\mathbb{E}_{w_{i}\sim P_{n}(w)}\left[\log\sigma(-{v^{\prime}_{w_{i}}}^{\top}v_{w_{I}})\right]</annotation><annotation encoding="application/x-llamapun">roman_log italic_σ ( italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT blackboard_E start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∼ italic_P start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_w ) end_POSTSUBSCRIPT [ roman_log italic_σ ( - italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_v start_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ]</annotation></semantics></math></mjx-assistive-mml></mjx-container></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.6" class="ltx_p">which is used to replace every <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="46" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p2.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p2.1.m1.1a"><mjx-mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mjx-mrow id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml"><mjx-mi class="mjx-n" id="S2.SS2.p2.1.m1.1.1.3.1" xref="S2.SS2.p2.1.m1.1.1.3.1.cmml"><mjx-c class="mjx-c6C"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c67"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="2" id="S2.SS2.p2.1.m1.1.1.3a" xref="S2.SS2.p2.1.m1.1.1.3.cmml" style="margin-right: 0.056em;"><mjx-c class="mjx-c2061"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS2.p2.1.m1.1.1.3.2" xref="S2.SS2.p2.1.m1.1.1.3.2.cmml"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.SS2.p2.1.m1.1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS2.p2.1.m1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S2.SS2.p2.1.m1.1.1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><mjx-msub id="S2.SS2.p2.1.m1.1.1.1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S2.SS2.p2.1.m1.1.1.1.1.1.2.2" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS2.p2.1.m1.1.1.1.1.1.2.3" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS2.p2.1.m1.1.1.1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo><mjx-msub id="S2.SS2.p2.1.m1.1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S2.SS2.p2.1.m1.1.1.1.1.1.3.2" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS2.p2.1.m1.1.1.1.1.1.3.3" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D43C TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS2.p2.1.m1.1.1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\log P(w_{O}|w_{I})" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS2.p2.1.m1.1.1.cmml"><mrow xref="S2.SS2.p2.1.m1.1.1.3.cmml"><mi xref="S2.SS2.p2.1.m1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" xref="S2.SS2.p2.1.m1.1.1.3.cmml">⁡</mo><mi xref="S2.SS2.p2.1.m1.1.1.3.2.cmml">P</mi></mrow><mo xref="S2.SS2.p2.1.m1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml"><msub xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.cmml"><mi xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml">w</mi><mi xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml">O</mi></msub><mo fence="false" xref="S2.SS2.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><msub xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.cmml"><mi xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml">I</mi></msub></mrow><mo stretchy="false" xref="S2.SS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><times id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2"></times><apply id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3"><log id="S2.SS2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.1.1.3.1"></log><ci id="S2.SS2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.1.1.3.2">𝑃</ci></apply><apply id="S2.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.2">𝑤</ci><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.2.3">𝑂</ci></apply><apply id="S2.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.SS2.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.1.m1.1.1.1.1.1.3.3">𝐼</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">\log P(w_{O}|w_{I})</annotation><annotation encoding="application/x-llamapun">roman_log italic_P ( italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT | italic_w start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container> term in the Skip-gram objective.
Thus the task is to distinguish the target word
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="47" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p2.2.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p2.2.m2.1a"><mjx-msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml"><mjx-c class="mjx-c1D442 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w_{O}" display="inline" class="ltx_Math"><semantics><msub xref="S2.SS2.p2.2.m2.1.1.cmml"><mi xref="S2.SS2.p2.2.m2.1.1.2.cmml">w</mi><mi xref="S2.SS2.p2.2.m2.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝑤</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex">w_{O}</annotation><annotation encoding="application/x-llamapun">italic_w start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> from draws from the noise distribution <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="48" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p2.3.m3.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p2.3.m3.1a"><mjx-mrow id="S2.SS2.p2.3.m3.1.2" xref="S2.SS2.p2.3.m3.1.2.cmml"><mjx-msub id="S2.SS2.p2.3.m3.1.2.2" xref="S2.SS2.p2.3.m3.1.2.2.cmml"><mjx-mi class="mjx-i" id="S2.SS2.p2.3.m3.1.2.2.2" xref="S2.SS2.p2.3.m3.1.2.2.2.cmml"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.109em;"><mjx-mi class="mjx-i" size="s" id="S2.SS2.p2.3.m3.1.2.2.3" xref="S2.SS2.p2.3.m3.1.2.2.3.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS2.p2.3.m3.1.2.1" xref="S2.SS2.p2.3.m3.1.2.1.cmml"></mjx-mo><mjx-mrow id="S2.SS2.p2.3.m3.1.2.3.2" xref="S2.SS2.p2.3.m3.1.2.cmml"><mjx-mo class="mjx-n" id="S2.SS2.p2.3.m3.1.2.3.2.1" xref="S2.SS2.p2.3.m3.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS2.p2.3.m3.1.2.3.2.2" xref="S2.SS2.p2.3.m3.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="P_{n}(w)" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS2.p2.3.m3.1.2.cmml"><msub xref="S2.SS2.p2.3.m3.1.2.2.cmml"><mi xref="S2.SS2.p2.3.m3.1.2.2.2.cmml">P</mi><mi xref="S2.SS2.p2.3.m3.1.2.2.3.cmml">n</mi></msub><mo xref="S2.SS2.p2.3.m3.1.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS2.p2.3.m3.1.2.cmml"><mo stretchy="false" xref="S2.SS2.p2.3.m3.1.2.cmml">(</mo><mi xref="S2.SS2.p2.3.m3.1.1.cmml">w</mi><mo stretchy="false" xref="S2.SS2.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p2.3.m3.1.2.cmml" xref="S2.SS2.p2.3.m3.1.2"><times id="S2.SS2.p2.3.m3.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.2.1"></times><apply id="S2.SS2.p2.3.m3.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.2.2.1.cmml" xref="S2.SS2.p2.3.m3.1.2.2">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.2.2.2.cmml" xref="S2.SS2.p2.3.m3.1.2.2.2">𝑃</ci><ci id="S2.SS2.p2.3.m3.1.2.2.3.cmml" xref="S2.SS2.p2.3.m3.1.2.2.3">𝑛</ci></apply><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">P_{n}(w)</annotation><annotation encoding="application/x-llamapun">italic_P start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_w )</annotation></semantics></math></mjx-assistive-mml></mjx-container> using logistic regression,
where there are <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="49" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p2.4.m4.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p2.4.m4.1a"><mjx-mi class="mjx-i" id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS2.p2.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math></mjx-assistive-mml></mjx-container> negative
samples for each data sample. Our experiments indicate that values of <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="50" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p2.5.m5.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p2.5.m5.1a"><mjx-mi class="mjx-i" id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS2.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math></mjx-assistive-mml></mjx-container>
in the range 5–20 are useful for small training datasets, while for large datasets
the <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="51" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p2.6.m6.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p2.6.m6.1a"><mjx-mi class="mjx-i" id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS2.p2.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math></mjx-assistive-mml></mjx-container> can be as small as 2–5. The main difference between the Negative sampling and NCE is that NCE
needs both samples and the numerical probabilities of the noise distribution,
while Negative sampling uses only samples. And while NCE approximately maximizes the log probability
of the softmax, this property is not important for our application.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.5" class="ltx_p">Both NCE and NEG have the noise distribution <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="52" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p3.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p3.1.m1.1a"><mjx-mrow id="S2.SS2.p3.1.m1.1.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mjx-msub id="S2.SS2.p3.1.m1.1.2.2" xref="S2.SS2.p3.1.m1.1.2.2.cmml"><mjx-mi class="mjx-i" id="S2.SS2.p3.1.m1.1.2.2.2" xref="S2.SS2.p3.1.m1.1.2.2.2.cmml"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.109em;"><mjx-mi class="mjx-i" size="s" id="S2.SS2.p3.1.m1.1.2.2.3" xref="S2.SS2.p3.1.m1.1.2.2.3.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS2.p3.1.m1.1.2.1" xref="S2.SS2.p3.1.m1.1.2.1.cmml"></mjx-mo><mjx-mrow id="S2.SS2.p3.1.m1.1.2.3.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mjx-mo class="mjx-n" id="S2.SS2.p3.1.m1.1.2.3.2.1" xref="S2.SS2.p3.1.m1.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS2.p3.1.m1.1.2.3.2.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="P_{n}(w)" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS2.p3.1.m1.1.2.cmml"><msub xref="S2.SS2.p3.1.m1.1.2.2.cmml"><mi xref="S2.SS2.p3.1.m1.1.2.2.2.cmml">P</mi><mi xref="S2.SS2.p3.1.m1.1.2.2.3.cmml">n</mi></msub><mo xref="S2.SS2.p3.1.m1.1.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS2.p3.1.m1.1.2.cmml"><mo stretchy="false" xref="S2.SS2.p3.1.m1.1.2.cmml">(</mo><mi xref="S2.SS2.p3.1.m1.1.1.cmml">w</mi><mo stretchy="false" xref="S2.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p3.1.m1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.2"><times id="S2.SS2.p3.1.m1.1.2.1.cmml" xref="S2.SS2.p3.1.m1.1.2.1"></times><apply id="S2.SS2.p3.1.m1.1.2.2.cmml" xref="S2.SS2.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.2.2.1.cmml" xref="S2.SS2.p3.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.2.2.2.cmml" xref="S2.SS2.p3.1.m1.1.2.2.2">𝑃</ci><ci id="S2.SS2.p3.1.m1.1.2.2.3.cmml" xref="S2.SS2.p3.1.m1.1.2.2.3">𝑛</ci></apply><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">P_{n}(w)</annotation><annotation encoding="application/x-llamapun">italic_P start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_w )</annotation></semantics></math></mjx-assistive-mml></mjx-container> as
a free parameter. We investigated a number of choices for <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="53" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p3.2.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p3.2.m2.1a"><mjx-mrow id="S2.SS2.p3.2.m2.1.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><mjx-msub id="S2.SS2.p3.2.m2.1.2.2" xref="S2.SS2.p3.2.m2.1.2.2.cmml"><mjx-mi class="mjx-i" id="S2.SS2.p3.2.m2.1.2.2.2" xref="S2.SS2.p3.2.m2.1.2.2.2.cmml"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em; margin-left: -0.109em;"><mjx-mi class="mjx-i" size="s" id="S2.SS2.p3.2.m2.1.2.2.3" xref="S2.SS2.p3.2.m2.1.2.2.3.cmml"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS2.p3.2.m2.1.2.1" xref="S2.SS2.p3.2.m2.1.2.1.cmml"></mjx-mo><mjx-mrow id="S2.SS2.p3.2.m2.1.2.3.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><mjx-mo class="mjx-n" id="S2.SS2.p3.2.m2.1.2.3.2.1" xref="S2.SS2.p3.2.m2.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS2.p3.2.m2.1.2.3.2.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="P_{n}(w)" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS2.p3.2.m2.1.2.cmml"><msub xref="S2.SS2.p3.2.m2.1.2.2.cmml"><mi xref="S2.SS2.p3.2.m2.1.2.2.2.cmml">P</mi><mi xref="S2.SS2.p3.2.m2.1.2.2.3.cmml">n</mi></msub><mo xref="S2.SS2.p3.2.m2.1.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS2.p3.2.m2.1.2.cmml"><mo stretchy="false" xref="S2.SS2.p3.2.m2.1.2.cmml">(</mo><mi xref="S2.SS2.p3.2.m2.1.1.cmml">w</mi><mo stretchy="false" xref="S2.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p3.2.m2.1.2.cmml" xref="S2.SS2.p3.2.m2.1.2"><times id="S2.SS2.p3.2.m2.1.2.1.cmml" xref="S2.SS2.p3.2.m2.1.2.1"></times><apply id="S2.SS2.p3.2.m2.1.2.2.cmml" xref="S2.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.2.2.1.cmml" xref="S2.SS2.p3.2.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.2.m2.1.2.2.2.cmml" xref="S2.SS2.p3.2.m2.1.2.2.2">𝑃</ci><ci id="S2.SS2.p3.2.m2.1.2.2.3.cmml" xref="S2.SS2.p3.2.m2.1.2.2.3">𝑛</ci></apply><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">P_{n}(w)</annotation><annotation encoding="application/x-llamapun">italic_P start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ( italic_w )</annotation></semantics></math></mjx-assistive-mml></mjx-container>
and found that the unigram distribution <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="54" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p3.3.m3.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p3.3.m3.1a"><mjx-mrow id="S2.SS2.p3.3.m3.1.2" xref="S2.SS2.p3.3.m3.1.2.cmml"><mjx-mi class="mjx-i" id="S2.SS2.p3.3.m3.1.2.2" xref="S2.SS2.p3.3.m3.1.2.2.cmml"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS2.p3.3.m3.1.2.1" xref="S2.SS2.p3.3.m3.1.2.1.cmml"></mjx-mo><mjx-mrow id="S2.SS2.p3.3.m3.1.2.3.2" xref="S2.SS2.p3.3.m3.1.2.cmml"><mjx-mo class="mjx-n" id="S2.SS2.p3.3.m3.1.2.3.2.1" xref="S2.SS2.p3.3.m3.1.2.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS2.p3.3.m3.1.2.3.2.2" xref="S2.SS2.p3.3.m3.1.2.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="U(w)" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS2.p3.3.m3.1.2.cmml"><mi xref="S2.SS2.p3.3.m3.1.2.2.cmml">U</mi><mo xref="S2.SS2.p3.3.m3.1.2.1.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS2.p3.3.m3.1.2.cmml"><mo stretchy="false" xref="S2.SS2.p3.3.m3.1.2.cmml">(</mo><mi xref="S2.SS2.p3.3.m3.1.1.cmml">w</mi><mo stretchy="false" xref="S2.SS2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p3.3.m3.1.2.cmml" xref="S2.SS2.p3.3.m3.1.2"><times id="S2.SS2.p3.3.m3.1.2.1.cmml" xref="S2.SS2.p3.3.m3.1.2.1"></times><ci id="S2.SS2.p3.3.m3.1.2.2.cmml" xref="S2.SS2.p3.3.m3.1.2.2">𝑈</ci><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex">U(w)</annotation><annotation encoding="application/x-llamapun">italic_U ( italic_w )</annotation></semantics></math></mjx-assistive-mml></mjx-container> raised to the <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="55" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p3.4.m4.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p3.4.m4.1a"><mjx-mrow id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml"><mjx-mn class="mjx-n" id="S2.SS2.p3.4.m4.1.1.2" xref="S2.SS2.p3.4.m4.1.1.2.cmml"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" id="S2.SS2.p3.4.m4.1.1.1" xref="S2.SS2.p3.4.m4.1.1.1.cmml"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.SS2.p3.4.m4.1.1.3" xref="S2.SS2.p3.4.m4.1.1.3.cmml"><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="3/4" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS2.p3.4.m4.1.1.cmml"><mn xref="S2.SS2.p3.4.m4.1.1.2.cmml">3</mn><mo xref="S2.SS2.p3.4.m4.1.1.1.cmml">/</mo><mn xref="S2.SS2.p3.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1"><divide id="S2.SS2.p3.4.m4.1.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1.1"></divide><cn type="integer" id="S2.SS2.p3.4.m4.1.1.2.cmml" xref="S2.SS2.p3.4.m4.1.1.2">3</cn><cn type="integer" id="S2.SS2.p3.4.m4.1.1.3.cmml" xref="S2.SS2.p3.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex">3/4</annotation><annotation encoding="application/x-llamapun">3 / 4</annotation></semantics></math></mjx-assistive-mml></mjx-container>rd
power (i.e., <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="56" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS2.p3.5.m5.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS2.p3.5.m5.1a"><mjx-mrow id="S2.SS2.p3.5.m5.1.2" xref="S2.SS2.p3.5.m5.1.2.cmml"><mjx-mrow id="S2.SS2.p3.5.m5.1.2.2" xref="S2.SS2.p3.5.m5.1.2.2.cmml"><mjx-mi class="mjx-i" id="S2.SS2.p3.5.m5.1.2.2.2" xref="S2.SS2.p3.5.m5.1.2.2.2.cmml"><mjx-c class="mjx-c1D448 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS2.p3.5.m5.1.2.2.1" xref="S2.SS2.p3.5.m5.1.2.2.1.cmml"></mjx-mo><mjx-msup id="S2.SS2.p3.5.m5.1.2.2.3" xref="S2.SS2.p3.5.m5.1.2.2.3.cmml"><mjx-mrow id="S2.SS2.p3.5.m5.1.2.2.3.2.2" xref="S2.SS2.p3.5.m5.1.2.2.3.cmml"><mjx-mo class="mjx-n" id="S2.SS2.p3.5.m5.1.2.2.3.2.2.1" xref="S2.SS2.p3.5.m5.1.2.2.3.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS2.p3.5.m5.1.2.2.3.2.2.2" xref="S2.SS2.p3.5.m5.1.2.2.3.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow><mjx-script style="vertical-align: 0.477em;"><mjx-mrow size="s" id="S2.SS2.p3.5.m5.1.2.2.3.3" xref="S2.SS2.p3.5.m5.1.2.2.3.3.cmml"><mjx-mn class="mjx-n" id="S2.SS2.p3.5.m5.1.2.2.3.3.2" xref="S2.SS2.p3.5.m5.1.2.2.3.3.2.cmml"><mjx-c class="mjx-c33"></mjx-c></mjx-mn><mjx-mo class="mjx-n" id="S2.SS2.p3.5.m5.1.2.2.3.3.1" xref="S2.SS2.p3.5.m5.1.2.2.3.3.1.cmml"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.SS2.p3.5.m5.1.2.2.3.3.3" xref="S2.SS2.p3.5.m5.1.2.2.3.3.3.cmml"><mjx-c class="mjx-c34"></mjx-c></mjx-mn></mjx-mrow></mjx-script></mjx-msup></mjx-mrow><mjx-mo class="mjx-n" id="S2.SS2.p3.5.m5.1.2.1" xref="S2.SS2.p3.5.m5.1.2.1.cmml"><mjx-c class="mjx-c2F"></mjx-c></mjx-mo><mjx-mi class="mjx-i" id="S2.SS2.p3.5.m5.1.2.3" xref="S2.SS2.p3.5.m5.1.2.3.cmml"><mjx-c class="mjx-c1D44D TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="U(w)^{3/4}/Z" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS2.p3.5.m5.1.2.cmml"><mrow xref="S2.SS2.p3.5.m5.1.2.2.cmml"><mi xref="S2.SS2.p3.5.m5.1.2.2.2.cmml">U</mi><mo xref="S2.SS2.p3.5.m5.1.2.2.1.cmml" lspace="0px" rspace="0px"></mo><msup xref="S2.SS2.p3.5.m5.1.2.2.3.cmml"><mrow xref="S2.SS2.p3.5.m5.1.2.2.3.cmml"><mo stretchy="false" xref="S2.SS2.p3.5.m5.1.2.2.3.cmml">(</mo><mi xref="S2.SS2.p3.5.m5.1.1.cmml">w</mi><mo stretchy="false" xref="S2.SS2.p3.5.m5.1.2.2.3.cmml">)</mo></mrow><mrow xref="S2.SS2.p3.5.m5.1.2.2.3.3.cmml"><mn xref="S2.SS2.p3.5.m5.1.2.2.3.3.2.cmml">3</mn><mo xref="S2.SS2.p3.5.m5.1.2.2.3.3.1.cmml">/</mo><mn xref="S2.SS2.p3.5.m5.1.2.2.3.3.3.cmml">4</mn></mrow></msup></mrow><mo xref="S2.SS2.p3.5.m5.1.2.1.cmml">/</mo><mi xref="S2.SS2.p3.5.m5.1.2.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS2.p3.5.m5.1.2.cmml" xref="S2.SS2.p3.5.m5.1.2"><divide id="S2.SS2.p3.5.m5.1.2.1.cmml" xref="S2.SS2.p3.5.m5.1.2.1"></divide><apply id="S2.SS2.p3.5.m5.1.2.2.cmml" xref="S2.SS2.p3.5.m5.1.2.2"><times id="S2.SS2.p3.5.m5.1.2.2.1.cmml" xref="S2.SS2.p3.5.m5.1.2.2.1"></times><ci id="S2.SS2.p3.5.m5.1.2.2.2.cmml" xref="S2.SS2.p3.5.m5.1.2.2.2">𝑈</ci><apply id="S2.SS2.p3.5.m5.1.2.2.3.cmml" xref="S2.SS2.p3.5.m5.1.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.1.2.2.3.1.cmml" xref="S2.SS2.p3.5.m5.1.2.2.3">superscript</csymbol><ci id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">𝑤</ci><apply id="S2.SS2.p3.5.m5.1.2.2.3.3.cmml" xref="S2.SS2.p3.5.m5.1.2.2.3.3"><divide id="S2.SS2.p3.5.m5.1.2.2.3.3.1.cmml" xref="S2.SS2.p3.5.m5.1.2.2.3.3.1"></divide><cn type="integer" id="S2.SS2.p3.5.m5.1.2.2.3.3.2.cmml" xref="S2.SS2.p3.5.m5.1.2.2.3.3.2">3</cn><cn type="integer" id="S2.SS2.p3.5.m5.1.2.2.3.3.3.cmml" xref="S2.SS2.p3.5.m5.1.2.2.3.3.3">4</cn></apply></apply></apply><ci id="S2.SS2.p3.5.m5.1.2.3.cmml" xref="S2.SS2.p3.5.m5.1.2.3">𝑍</ci></apply></annotation-xml><annotation encoding="application/x-tex">U(w)^{3/4}/Z</annotation><annotation encoding="application/x-llamapun">italic_U ( italic_w ) start_POSTSUPERSCRIPT 3 / 4 end_POSTSUPERSCRIPT / italic_Z</annotation></semantics></math></mjx-assistive-mml></mjx-container>) outperformed significantly the unigram
and the uniform distributions, for both NCE and NEG on every task we tried
including language modeling (not reported here).</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Subsampling of Frequent Words</h3>

<div id="S2.SS3.p1" class="ltx_para ltx_noindent">
<p id="S2.SS3.p1.1" class="ltx_p">In very large corpora, the most frequent words can easily occur hundreds of millions
of times (e.g., “in”, “the”, and “a”). Such words usually
provide less information value than the rare words. For example, while the
Skip-gram model benefits from observing the co-occurrences of “France” and
“Paris”, it benefits much less from observing the frequent co-occurrences of “France”
and “the”, as nearly every word co-occurs frequently within a sentence
with “the”. This idea can also be applied in the opposite
direction; the vector representations of frequent words do not change
significantly after training on several million examples.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para ltx_noindent">
<p id="S2.SS3.p2.1" class="ltx_p">To counter the imbalance between the rare and frequent words, we used a
simple subsampling approach: each word <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="57" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS3.p2.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS3.p2.1.m1.1a"><mjx-msub id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w_{i}" display="inline" class="ltx_Math"><semantics><msub xref="S2.SS3.p2.1.m1.1.1.cmml"><mi xref="S2.SS3.p2.1.m1.1.1.2.cmml">w</mi><mi xref="S2.SS3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝑤</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex">w_{i}</annotation><annotation encoding="application/x-llamapun">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> in the training set is
discarded with probability computed by the formula</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="58" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.E5.m1.2" class="ltx_Math MJX-TEX" display="true" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-semantics id="S2.E5.m1.2a"><mjx-mrow id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml"><mjx-mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.cmml"><mjx-mi class="mjx-i" id="S2.E5.m1.2.2.1.3" xref="S2.E5.m1.2.2.1.3.cmml"><mjx-c class="mjx-c1D443 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E5.m1.2.2.1.2" xref="S2.E5.m1.2.2.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E5.m1.2.2.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub id="S2.E5.m1.2.2.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.E5.m1.2.2.1.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E5.m1.2.2.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.E5.m1.2.2.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S2.E5.m1.2.2.2" xref="S2.E5.m1.2.2.2.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mrow space="4" id="S2.E5.m1.2.2.3" xref="S2.E5.m1.2.2.3.cmml"><mjx-mn class="mjx-n" id="S2.E5.m1.2.2.3.2" xref="S2.E5.m1.2.2.3.2.cmml"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3" id="S2.E5.m1.2.2.3.1" xref="S2.E5.m1.2.2.3.1.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-msqrt space="3" id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><mjx-sqrt><mjx-surd><mjx-mo class="mjx-s4"><mjx-c class="mjx-c221A TEX-S4"></mjx-c></mjx-mo></mjx-surd><mjx-box style="padding-top: 0.424em;"><mjx-mfrac id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mi class="mjx-i" id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.3.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.E5.m1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.E5.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.E5.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.E5.m1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-box></mjx-sqrt></mjx-msqrt></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="P(w_{i})=1-\sqrt{\frac{t}{f(w_{i})}}" display="block" class="ltx_Math"><semantics><mrow xref="S2.E5.m1.2.2.cmml"><mrow xref="S2.E5.m1.2.2.1.cmml"><mi xref="S2.E5.m1.2.2.1.3.cmml">P</mi><mo xref="S2.E5.m1.2.2.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" xref="S2.E5.m1.2.2.1.1.1.1.cmml">(</mo><msub xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mi xref="S2.E5.m1.2.2.1.1.1.1.2.cmml">w</mi><mi xref="S2.E5.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" xref="S2.E5.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo xref="S2.E5.m1.2.2.2.cmml">=</mo><mrow xref="S2.E5.m1.2.2.3.cmml"><mn xref="S2.E5.m1.2.2.3.2.cmml">1</mn><mo xref="S2.E5.m1.2.2.3.1.cmml">−</mo><msqrt xref="S2.E5.m1.1.1.cmml"><mfrac xref="S2.E5.m1.1.1.1.cmml"><mi xref="S2.E5.m1.1.1.1.3.cmml">t</mi><mrow xref="S2.E5.m1.1.1.1.1.1.cmml"><mi xref="S2.E5.m1.1.1.1.1.1.3.cmml">f</mi><mo xref="S2.E5.m1.1.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></msqrt></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"><eq id="S2.E5.m1.2.2.2.cmml" xref="S2.E5.m1.2.2.2"></eq><apply id="S2.E5.m1.2.2.1.cmml" xref="S2.E5.m1.2.2.1"><times id="S2.E5.m1.2.2.1.2.cmml" xref="S2.E5.m1.2.2.1.2"></times><ci id="S2.E5.m1.2.2.1.3.cmml" xref="S2.E5.m1.2.2.1.3">𝑃</ci><apply id="S2.E5.m1.2.2.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2">𝑤</ci><ci id="S2.E5.m1.2.2.1.1.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.E5.m1.2.2.3.cmml" xref="S2.E5.m1.2.2.3"><minus id="S2.E5.m1.2.2.3.1.cmml" xref="S2.E5.m1.2.2.3.1"></minus><cn type="integer" id="S2.E5.m1.2.2.3.2.cmml" xref="S2.E5.m1.2.2.3.2">1</cn><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><root id="S2.E5.m1.1.1a.cmml" xref="S2.E5.m1.1.1"></root><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><divide id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1"></divide><ci id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.3">𝑡</ci><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2"></times><ci id="S2.E5.m1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3">𝑓</ci><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">P(w_{i})=1-\sqrt{\frac{t}{f(w_{i})}}</annotation><annotation encoding="application/x-llamapun">italic_P ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = 1 - square-root start_ARG divide start_ARG italic_t end_ARG start_ARG italic_f ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG end_ARG</annotation></semantics></math></mjx-assistive-mml></mjx-container></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.6" class="ltx_p">where <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="59" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS3.p2.2.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS3.p2.2.m1.1a"><mjx-mrow id="S2.SS3.p2.2.m1.1.1" xref="S2.SS3.p2.2.m1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS3.p2.2.m1.1.1.3" xref="S2.SS3.p2.2.m1.1.1.3.cmml"><mjx-c class="mjx-c1D453 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" id="S2.SS3.p2.2.m1.1.1.2" xref="S2.SS3.p2.2.m1.1.1.2.cmml"></mjx-mo><mjx-mrow id="S2.SS3.p2.2.m1.1.1.1.1" xref="S2.SS3.p2.2.m1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S2.SS3.p2.2.m1.1.1.1.1.2" xref="S2.SS3.p2.2.m1.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub id="S2.SS3.p2.2.m1.1.1.1.1.1" xref="S2.SS3.p2.2.m1.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS3.p2.2.m1.1.1.1.1.1.2" xref="S2.SS3.p2.2.m1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS3.p2.2.m1.1.1.1.1.1.3" xref="S2.SS3.p2.2.m1.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S2.SS3.p2.2.m1.1.1.1.1.3" xref="S2.SS3.p2.2.m1.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="f(w_{i})" display="inline" class="ltx_Math"><semantics><mrow xref="S2.SS3.p2.2.m1.1.1.cmml"><mi xref="S2.SS3.p2.2.m1.1.1.3.cmml">f</mi><mo xref="S2.SS3.p2.2.m1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S2.SS3.p2.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" xref="S2.SS3.p2.2.m1.1.1.1.1.1.cmml">(</mo><msub xref="S2.SS3.p2.2.m1.1.1.1.1.1.cmml"><mi xref="S2.SS3.p2.2.m1.1.1.1.1.1.2.cmml">w</mi><mi xref="S2.SS3.p2.2.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" xref="S2.SS3.p2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS3.p2.2.m1.1.1.cmml" xref="S2.SS3.p2.2.m1.1.1"><times id="S2.SS3.p2.2.m1.1.1.2.cmml" xref="S2.SS3.p2.2.m1.1.1.2"></times><ci id="S2.SS3.p2.2.m1.1.1.3.cmml" xref="S2.SS3.p2.2.m1.1.1.3">𝑓</ci><apply id="S2.SS3.p2.2.m1.1.1.1.1.1.cmml" xref="S2.SS3.p2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.2.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.2.m1.1.1.1.1.1.2">𝑤</ci><ci id="S2.SS3.p2.2.m1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex">f(w_{i})</annotation><annotation encoding="application/x-llamapun">italic_f ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></mjx-assistive-mml></mjx-container> is the frequency of word <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="60" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS3.p2.3.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS3.p2.3.m2.1a"><mjx-msub id="S2.SS3.p2.3.m2.1.1" xref="S2.SS3.p2.3.m2.1.1.cmml"><mjx-mi class="mjx-i" id="S2.SS3.p2.3.m2.1.1.2" xref="S2.SS3.p2.3.m2.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S2.SS3.p2.3.m2.1.1.3" xref="S2.SS3.p2.3.m2.1.1.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="w_{i}" display="inline" class="ltx_Math"><semantics><msub xref="S2.SS3.p2.3.m2.1.1.cmml"><mi xref="S2.SS3.p2.3.m2.1.1.2.cmml">w</mi><mi xref="S2.SS3.p2.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS3.p2.3.m2.1.1.cmml" xref="S2.SS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m2.1.1.1.cmml" xref="S2.SS3.p2.3.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.3.m2.1.1.2.cmml" xref="S2.SS3.p2.3.m2.1.1.2">𝑤</ci><ci id="S2.SS3.p2.3.m2.1.1.3.cmml" xref="S2.SS3.p2.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex">w_{i}</annotation><annotation encoding="application/x-llamapun">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> and <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="61" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS3.p2.4.m3.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS3.p2.4.m3.1a"><mjx-mi class="mjx-i" id="S2.SS3.p2.4.m3.1.1" xref="S2.SS3.p2.4.m3.1.1.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="t" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS3.p2.4.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS3.p2.4.m3.1.1.cmml" xref="S2.SS3.p2.4.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math></mjx-assistive-mml></mjx-container> is a chosen
threshold, typically around <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="62" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS3.p2.5.m4.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS3.p2.5.m4.1a"><mjx-msup id="S2.SS3.p2.5.m4.1.1" xref="S2.SS3.p2.5.m4.1.1.cmml"><mjx-mn class="mjx-n" id="S2.SS3.p2.5.m4.1.1.2" xref="S2.SS3.p2.5.m4.1.1.2.cmml"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mrow size="s" id="S2.SS3.p2.5.m4.1.1.3" xref="S2.SS3.p2.5.m4.1.1.3.cmml"><mjx-mo class="mjx-n" id="S2.SS3.p2.5.m4.1.1.3a" xref="S2.SS3.p2.5.m4.1.1.3.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S2.SS3.p2.5.m4.1.1.3.2" xref="S2.SS3.p2.5.m4.1.1.3.2.cmml"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-mrow></mjx-script></mjx-msup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="10^{-5}" display="inline" class="ltx_Math"><semantics><msup xref="S2.SS3.p2.5.m4.1.1.cmml"><mn xref="S2.SS3.p2.5.m4.1.1.2.cmml">10</mn><mrow xref="S2.SS3.p2.5.m4.1.1.3.cmml"><mo xref="S2.SS3.p2.5.m4.1.1.3.cmml">−</mo><mn xref="S2.SS3.p2.5.m4.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS3.p2.5.m4.1.1.cmml" xref="S2.SS3.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m4.1.1.1.cmml" xref="S2.SS3.p2.5.m4.1.1">superscript</csymbol><cn type="integer" id="S2.SS3.p2.5.m4.1.1.2.cmml" xref="S2.SS3.p2.5.m4.1.1.2">10</cn><apply id="S2.SS3.p2.5.m4.1.1.3.cmml" xref="S2.SS3.p2.5.m4.1.1.3"><minus id="S2.SS3.p2.5.m4.1.1.3.1.cmml" xref="S2.SS3.p2.5.m4.1.1.3"></minus><cn type="integer" id="S2.SS3.p2.5.m4.1.1.3.2.cmml" xref="S2.SS3.p2.5.m4.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex">10^{-5}</annotation><annotation encoding="application/x-llamapun">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container>. We chose this subsampling
formula because it aggressively subsamples words whose frequency is
greater than <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="63" style="font-size: 121.4%; position: relative;"><mjx-math id="S2.SS3.p2.6.m5.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S2.SS3.p2.6.m5.1a"><mjx-mi class="mjx-i" id="S2.SS3.p2.6.m5.1.1" xref="S2.SS3.p2.6.m5.1.1.cmml"><mjx-c class="mjx-c1D461 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="t" display="inline" class="ltx_Math"><semantics><mi xref="S2.SS3.p2.6.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S2.SS3.p2.6.m5.1.1.cmml" xref="S2.SS3.p2.6.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex">t</annotation><annotation encoding="application/x-llamapun">italic_t</annotation></semantics></math></mjx-assistive-mml></mjx-container> while preserving the ranking of the frequencies.
Although this subsampling formula was chosen heuristically, we found
it to work well in practice. It accelerates learning and even significantly improves
the accuracy of the learned vectors of the rare words, as will be shown in the following sections.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Empirical Results</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.3" class="ltx_p">In this section we evaluate the Hierarchical Softmax (HS), Noise Contrastive Estimation,
Negative Sampling, and subsampling of the training words. We used
the analogical reasoning task<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a href="code.google.com/p/word2vec/source/browse/trunk/questions-words.txt" title="" class="ltx_ref ltx_url ltx_font_typewriter">code.google.com/p/word2vec/source/browse/trunk/questions-words.txt</a></span></span></span>
introduced by Mikolov et al.&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
The task consists of analogies such as “Germany” : “Berlin” :: “France” : ?,
which are solved by finding a vector <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="64" style="font-size: 121.4%; position: relative;"><mjx-math id="S3.p1.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S3.p1.1.m1.1a"><mjx-mi class="mjx-i" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{x}" display="inline" class="ltx_Math"><semantics><mi xref="S3.p1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex">\mathbf{x}</annotation><annotation encoding="application/x-llamapun">bold_x</annotation></semantics></math></mjx-assistive-mml></mjx-container>
such that vec(<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="65" style="font-size: 121.4%; position: relative;"><mjx-math id="S3.p1.2.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S3.p1.2.m2.1a"><mjx-mi class="mjx-i" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{x}" display="inline" class="ltx_Math"><semantics><mi xref="S3.p1.2.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex">\mathbf{x}</annotation><annotation encoding="application/x-llamapun">bold_x</annotation></semantics></math></mjx-assistive-mml></mjx-container>) is closest to
vec(“Berlin”) - vec(“Germany”) + vec(“France”) according to the
cosine distance (we discard the input words from the search).
This specific example is considered to have been
answered correctly if <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="66" style="font-size: 121.4%; position: relative;"><mjx-math id="S3.p1.3.m3.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S3.p1.3.m3.1a"><mjx-mi class="mjx-i" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mjx-c class="mjx-c1D431 TEX-B"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\mathbf{x}" display="inline" class="ltx_Math"><semantics><mi xref="S3.p1.3.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex">\mathbf{x}</annotation><annotation encoding="application/x-llamapun">bold_x</annotation></semantics></math></mjx-assistive-mml></mjx-container> is “Paris”. The task has
two broad categories: the syntactic analogies (such as
“quick” : “quickly” :: “slow” : “slowly”) and the semantic analogies, such
as the country to capital city relationship.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">For training the Skip-gram models, we have used a large dataset
consisting of various news articles (an internal Google dataset with one billion words).
We discarded from the vocabulary all words that occurred
less than 5 times in the training data, which resulted in a vocabulary of size 692K.
The performance of various Skip-gram models on the word
analogy test set is reported in Table&nbsp;<a href="#S3.T1" title="Table 1 ‣ 3 Empirical Results ‣ Distributed Representations of Words and Phrases and their Compositionality" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
The table shows that Negative Sampling
outperforms the Hierarchical Softmax on the analogical
reasoning task, and has even slightly better performance than the Noise Contrastive Estimation.
The subsampling of the frequent words improves the training speed several times
and makes the word representations significantly more accurate.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.1" class="ltx_p">It can be argued that the linearity of the skip-gram model makes its vectors
more suitable for such linear analogical reasoning, but the results of
Mikolov et al.&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> also show that the vectors learned by the
standard sigmoidal recurrent neural networks (which are highly non-linear)
improve on this task significantly as the amount of the training data increases,
suggesting that non-linear models also have a preference for a linear
structure of the word representations.
</p>
</div>
<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Method</th>
<th id="S3.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Time [min]</th>
<td id="S3.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">Syntactic [%]</td>
<td id="S3.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Semantic [%]</td>
<td id="S3.T1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Total accuracy [%]</td>
</tr>
<tr id="S3.T1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">NEG-5</th>
<th id="S3.T1.1.3.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">38</th>
<td id="S3.T1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t">63</td>
<td id="S3.T1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54</td>
<td id="S3.T1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59</td>
</tr>
<tr id="S3.T1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">NEG-15</th>
<th id="S3.T1.1.4.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">97</th>
<td id="S3.T1.1.4.3.3" class="ltx_td ltx_align_center">63</td>
<td id="S3.T1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r">58</td>
<td id="S3.T1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.1.4.3.5.1" class="ltx_text ltx_font_bold">61</span></td>
</tr>
<tr id="S3.T1.1.5.4" class="ltx_tr">
<th id="S3.T1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">HS-Huffman</th>
<th id="S3.T1.1.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">41</th>
<td id="S3.T1.1.5.4.3" class="ltx_td ltx_align_center">53</td>
<td id="S3.T1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r">40</td>
<td id="S3.T1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r">47</td>
</tr>
<tr id="S3.T1.1.6.5" class="ltx_tr">
<th id="S3.T1.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">NCE-5</th>
<th id="S3.T1.1.6.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">38</th>
<td id="S3.T1.1.6.5.3" class="ltx_td ltx_align_center">60</td>
<td id="S3.T1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r">45</td>
<td id="S3.T1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r">53</td>
</tr>
<tr id="S3.T1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="5">The following results use <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="67" style="font-size: 113.1%; position: relative;"><mjx-math id="S3.T1.1.1.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S3.T1.1.1.1.m1.1a"><mjx-msup id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml"><mjx-mn class="mjx-n" id="S3.T1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.m1.1.1.2.cmml"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mrow size="s" id="S3.T1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.m1.1.1.3.cmml"><mjx-mo class="mjx-n" id="S3.T1.1.1.1.m1.1.1.3a" xref="S3.T1.1.1.1.m1.1.1.3.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S3.T1.1.1.1.m1.1.1.3.2" xref="S3.T1.1.1.1.m1.1.1.3.2.cmml"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-mrow></mjx-script></mjx-msup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="10^{-5}" display="inline" class="ltx_Math"><semantics><msup xref="S3.T1.1.1.1.m1.1.1.cmml"><mn xref="S3.T1.1.1.1.m1.1.1.2.cmml">10</mn><mrow xref="S3.T1.1.1.1.m1.1.1.3.cmml"><mo xref="S3.T1.1.1.1.m1.1.1.3.cmml">−</mo><mn xref="S3.T1.1.1.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S3.T1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.1.2">10</cn><apply id="S3.T1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.m1.1.1.3"><minus id="S3.T1.1.1.1.m1.1.1.3.1.cmml" xref="S3.T1.1.1.1.m1.1.1.3"></minus><cn type="integer" id="S3.T1.1.1.1.m1.1.1.3.2.cmml" xref="S3.T1.1.1.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex">10^{-5}</annotation><annotation encoding="application/x-llamapun">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> subsampling</th>
</tr>
<tr id="S3.T1.1.7.6" class="ltx_tr">
<th id="S3.T1.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">NEG-5</th>
<th id="S3.T1.1.7.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">14</th>
<td id="S3.T1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_t">61</td>
<td id="S3.T1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">58</td>
<td id="S3.T1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60</td>
</tr>
<tr id="S3.T1.1.8.7" class="ltx_tr">
<th id="S3.T1.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">NEG-15</th>
<th id="S3.T1.1.8.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">36</th>
<td id="S3.T1.1.8.7.3" class="ltx_td ltx_align_center">61</td>
<td id="S3.T1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r">61</td>
<td id="S3.T1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.1.8.7.5.1" class="ltx_text ltx_font_bold">61</span></td>
</tr>
<tr id="S3.T1.1.9.8" class="ltx_tr">
<th id="S3.T1.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">HS-Huffman</th>
<th id="S3.T1.1.9.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r">21</th>
<td id="S3.T1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_b">52</td>
<td id="S3.T1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">59</td>
<td id="S3.T1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">55</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span> Accuracy of
various Skip-gram 300-dimensional models on the
analogical reasoning task as defined in&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
NEG-<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="68" style="font-size: 121.4%; position: relative;"><mjx-math id="S3.T1.4.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S3.T1.4.m1.1b"><mjx-mi class="mjx-i" id="S3.T1.4.m1.1.1" xref="S3.T1.4.m1.1.1.cmml"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline" class="ltx_Math"><semantics><mi xref="S3.T1.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S3.T1.4.m1.1.1.cmml" xref="S3.T1.4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math></mjx-assistive-mml></mjx-container> stands for Negative Sampling with <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="69" style="font-size: 121.4%; position: relative;"><mjx-math id="S3.T1.5.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S3.T1.5.m2.1b"><mjx-mi class="mjx-i" id="S3.T1.5.m2.1.1" xref="S3.T1.5.m2.1.1.cmml"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k" display="inline" class="ltx_Math"><semantics><mi xref="S3.T1.5.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S3.T1.5.m2.1.1.cmml" xref="S3.T1.5.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex">k</annotation><annotation encoding="application/x-llamapun">italic_k</annotation></semantics></math></mjx-assistive-mml></mjx-container>
negative samples for each positive sample; NCE stands for Noise Contrastive Estimation and
HS-Huffman stands for the Hierarchical Softmax with the frequency-based Huffman
codes.</figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Learning Phrases</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">As discussed earlier, many phrases have a
meaning that is not a simple composition of the meanings of its individual
words. To learn vector representation for phrases, we first
find words that appear frequently together, and infrequently
in other contexts. For example, “New York Times” and
“Toronto Maple Leafs” are replaced by unique tokens in the training data,
while a bigram “this is” will remain unchanged.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.2" class="ltx_p">This way, we can form many reasonable phrases without greatly increasing the size
of the vocabulary; in theory, we can train the Skip-gram model
using all n-grams, but that would
be too memory intensive. Many techniques have been previously developed
to identify phrases in the text;
however, it is out of scope of our work to compare them. We decided to use
a simple data-driven approach, where phrases are formed
based on the unigram and bigram counts, using</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" display="true" tabindex="0" ctxtmenu_counter="70" style="font-size: 121.4%; position: relative;"><mjx-math id="S4.E6.m1.4" class="ltx_Math MJX-TEX" display="true" aria-hidden="true" style="margin-left: 0px; margin-right: 0px;"><mjx-semantics id="S4.E6.m1.4a"><mjx-mrow id="S4.E6.m1.4.4.1" xref="S4.E6.m1.4.4.1.1.cmml"><mjx-mrow id="S4.E6.m1.4.4.1.1" xref="S4.E6.m1.4.4.1.1.cmml"><mjx-mrow id="S4.E6.m1.4.4.1.1.2" xref="S4.E6.m1.4.4.1.1.2.cmml"><mjx-mtext class="mjx-n" id="S4.E6.m1.4.4.1.1.2.4" xref="S4.E6.m1.4.4.1.1.2.4a.cmml"><mjx-c class="mjx-c73"></mjx-c><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c72"></mjx-c><mjx-c class="mjx-c65"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" id="S4.E6.m1.4.4.1.1.2.3" xref="S4.E6.m1.4.4.1.1.2.3.cmml"></mjx-mo><mjx-mrow id="S4.E6.m1.4.4.1.1.2.2.2" xref="S4.E6.m1.4.4.1.1.2.2.3.cmml"><mjx-mo class="mjx-n" id="S4.E6.m1.4.4.1.1.2.2.2.3" xref="S4.E6.m1.4.4.1.1.2.2.3.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub id="S4.E6.m1.4.4.1.1.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S4.E6.m1.4.4.1.1.1.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S4.E6.m1.4.4.1.1.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S4.E6.m1.4.4.1.1.2.2.2.4" xref="S4.E6.m1.4.4.1.1.2.2.3.cmml"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2" id="S4.E6.m1.4.4.1.1.2.2.2.2" xref="S4.E6.m1.4.4.1.1.2.2.2.2.cmml"><mjx-mi class="mjx-i" id="S4.E6.m1.4.4.1.1.2.2.2.2.2" xref="S4.E6.m1.4.4.1.1.2.2.2.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S4.E6.m1.4.4.1.1.2.2.2.2.3" xref="S4.E6.m1.4.4.1.1.2.2.2.2.3.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S4.E6.m1.4.4.1.1.2.2.2.5" xref="S4.E6.m1.4.4.1.1.2.2.3.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" id="S4.E6.m1.4.4.1.1.3" xref="S4.E6.m1.4.4.1.1.3.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mfrac space="4" id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml"><mjx-frac type="d"><mjx-num><mjx-nstrut type="d"></mjx-nstrut><mjx-mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mjx-mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mjx-mtext class="mjx-n" id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3a.cmml"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c74"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml"></mjx-mo><mjx-mrow id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S4.E6.m1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mjx-msub id="S4.E6.m1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.2.cmml"><mjx-mi class="mjx-i" id="S4.E6.m1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.1.2.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S4.E6.m1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"></mjx-mo><mjx-msub id="S4.E6.m1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.3.cmml"><mjx-mi class="mjx-i" id="S4.E6.m1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.3.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S4.E6.m1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub></mjx-mrow><mjx-mo class="mjx-n" id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="3" id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="3" id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3.cmml"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi></mjx-mrow></mjx-num><mjx-dbox><mjx-dtable><mjx-line type="d"></mjx-line><mjx-row><mjx-den><mjx-dstrut type="d"></mjx-dstrut><mjx-mrow id="S4.E6.m1.3.3.3" xref="S4.E6.m1.3.3.3.cmml"><mjx-mrow id="S4.E6.m1.2.2.2.1" xref="S4.E6.m1.2.2.2.1.cmml"><mjx-mrow id="S4.E6.m1.2.2.2.1.1" xref="S4.E6.m1.2.2.2.1.1.cmml"><mjx-mtext class="mjx-n" id="S4.E6.m1.2.2.2.1.1.3" xref="S4.E6.m1.2.2.2.1.1.3a.cmml"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c74"></mjx-c></mjx-mtext><mjx-mo class="mjx-n" id="S4.E6.m1.2.2.2.1.1.2" xref="S4.E6.m1.2.2.2.1.1.2.cmml"></mjx-mo><mjx-mrow id="S4.E6.m1.2.2.2.1.1.1.1" xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml"><mjx-mo class="mjx-n" id="S4.E6.m1.2.2.2.1.1.1.1.2" xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub id="S4.E6.m1.2.2.2.1.1.1.1.1" xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml"><mjx-mi class="mjx-i" id="S4.E6.m1.2.2.2.1.1.1.1.1.2" xref="S4.E6.m1.2.2.2.1.1.1.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S4.E6.m1.2.2.2.1.1.1.1.1.3" xref="S4.E6.m1.2.2.2.1.1.1.1.1.3.cmml"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S4.E6.m1.2.2.2.1.1.1.1.3" xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml" style="margin-left: 0.056em; margin-right: 0.055em;"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow><mjx-mo class="mjx-n" space="4" rspace="3" id="S4.E6.m1.2.2.2.1.2" xref="S4.E6.m1.2.2.2.1.2.cmml"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mtext class="mjx-n" id="S4.E6.m1.2.2.2.1.3" xref="S4.E6.m1.2.2.2.1.3a.cmml"><mjx-c class="mjx-c63"></mjx-c><mjx-c class="mjx-c6F"></mjx-c><mjx-c class="mjx-c75"></mjx-c><mjx-c class="mjx-c6E"></mjx-c><mjx-c class="mjx-c74"></mjx-c></mjx-mtext></mjx-mrow><mjx-mo class="mjx-n" id="S4.E6.m1.3.3.3.3" xref="S4.E6.m1.3.3.3.3.cmml"></mjx-mo><mjx-mrow id="S4.E6.m1.3.3.3.2.1" xref="S4.E6.m1.3.3.3.2.1.1.cmml"><mjx-mo class="mjx-n" id="S4.E6.m1.3.3.3.2.1.2" xref="S4.E6.m1.3.3.3.2.1.1.cmml"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub id="S4.E6.m1.3.3.3.2.1.1" xref="S4.E6.m1.3.3.3.2.1.1.cmml"><mjx-mi class="mjx-i" id="S4.E6.m1.3.3.3.2.1.1.2" xref="S4.E6.m1.3.3.3.2.1.1.2.cmml"><mjx-c class="mjx-c1D464 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s" id="S4.E6.m1.3.3.3.2.1.1.3" xref="S4.E6.m1.3.3.3.2.1.1.3.cmml"><mjx-c class="mjx-c1D457 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" id="S4.E6.m1.3.3.3.2.1.3" xref="S4.E6.m1.3.3.3.2.1.1.cmml"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-mrow></mjx-mrow></mjx-den></mjx-row></mjx-dtable></mjx-dbox></mjx-frac></mjx-mfrac></mjx-mrow><mjx-mo class="mjx-n" rspace="3" id="S4.E6.m1.4.4.1.2" xref="S4.E6.m1.4.4.1.1.cmml"><mjx-c class="mjx-c2E"></mjx-c></mjx-mo></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\textrm{score}(w_{i},w_{j})=\frac{\textrm{count}(w_{i}w_{j})-\delta}{\textrm{count}(w_{i})\times\textrm{count}(w_{j})}." display="block" class="ltx_Math"><semantics><mrow xref="S4.E6.m1.4.4.1.1.cmml"><mrow xref="S4.E6.m1.4.4.1.1.cmml"><mrow xref="S4.E6.m1.4.4.1.1.2.cmml"><mtext xref="S4.E6.m1.4.4.1.1.2.4a.cmml">score</mtext><mo xref="S4.E6.m1.4.4.1.1.2.3.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S4.E6.m1.4.4.1.1.2.2.3.cmml"><mo stretchy="false" xref="S4.E6.m1.4.4.1.1.2.2.3.cmml">(</mo><msub xref="S4.E6.m1.4.4.1.1.1.1.1.1.cmml"><mi xref="S4.E6.m1.4.4.1.1.1.1.1.1.2.cmml">w</mi><mi xref="S4.E6.m1.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo xref="S4.E6.m1.4.4.1.1.2.2.3.cmml">,</mo><msub xref="S4.E6.m1.4.4.1.1.2.2.2.2.cmml"><mi xref="S4.E6.m1.4.4.1.1.2.2.2.2.2.cmml">w</mi><mi xref="S4.E6.m1.4.4.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" xref="S4.E6.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo xref="S4.E6.m1.4.4.1.1.3.cmml">=</mo><mfrac xref="S4.E6.m1.3.3.cmml"><mrow xref="S4.E6.m1.1.1.1.cmml"><mrow xref="S4.E6.m1.1.1.1.1.cmml"><mtext xref="S4.E6.m1.1.1.1.1.3a.cmml">count</mtext><mo xref="S4.E6.m1.1.1.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><msub xref="S4.E6.m1.1.1.1.1.1.1.1.2.cmml"><mi xref="S4.E6.m1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi xref="S4.E6.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" lspace="0px" rspace="0px"></mo><msub xref="S4.E6.m1.1.1.1.1.1.1.1.3.cmml"><mi xref="S4.E6.m1.1.1.1.1.1.1.1.3.2.cmml">w</mi><mi xref="S4.E6.m1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo xref="S4.E6.m1.1.1.1.2.cmml">−</mo><mi xref="S4.E6.m1.1.1.1.3.cmml">δ</mi></mrow><mrow xref="S4.E6.m1.3.3.3.cmml"><mrow xref="S4.E6.m1.2.2.2.1.cmml"><mrow xref="S4.E6.m1.2.2.2.1.1.cmml"><mtext xref="S4.E6.m1.2.2.2.1.1.3a.cmml">count</mtext><mo xref="S4.E6.m1.2.2.2.1.1.2.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml">(</mo><msub xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml"><mi xref="S4.E6.m1.2.2.2.1.1.1.1.1.2.cmml">w</mi><mi xref="S4.E6.m1.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.055em" stretchy="false" xref="S4.E6.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" xref="S4.E6.m1.2.2.2.1.2.cmml">×</mo><mtext xref="S4.E6.m1.2.2.2.1.3a.cmml">count</mtext></mrow><mo xref="S4.E6.m1.3.3.3.3.cmml" lspace="0px" rspace="0px"></mo><mrow xref="S4.E6.m1.3.3.3.2.1.1.cmml"><mo stretchy="false" xref="S4.E6.m1.3.3.3.2.1.1.cmml">(</mo><msub xref="S4.E6.m1.3.3.3.2.1.1.cmml"><mi xref="S4.E6.m1.3.3.3.2.1.1.2.cmml">w</mi><mi xref="S4.E6.m1.3.3.3.2.1.1.3.cmml">j</mi></msub><mo stretchy="false" xref="S4.E6.m1.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo lspace="0em" xref="S4.E6.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S4.E6.m1.4.4.1.1.cmml" xref="S4.E6.m1.4.4.1"><eq id="S4.E6.m1.4.4.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.3"></eq><apply id="S4.E6.m1.4.4.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.2"><times id="S4.E6.m1.4.4.1.1.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.3"></times><ci id="S4.E6.m1.4.4.1.1.2.4a.cmml" xref="S4.E6.m1.4.4.1.1.2.4"><mtext id="S4.E6.m1.4.4.1.1.2.4.cmml" xref="S4.E6.m1.4.4.1.1.2.4">score</mtext></ci><interval closure="open" id="S4.E6.m1.4.4.1.1.2.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2"><apply id="S4.E6.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.E6.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E6.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.2.2">𝑤</ci><ci id="S4.E6.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.4.4.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3"><divide id="S4.E6.m1.3.3.4.cmml" xref="S4.E6.m1.3.3"></divide><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><minus id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></minus><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.1.3a.cmml" xref="S4.E6.m1.1.1.1.1.3"><mtext id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3">count</mtext></ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"></times><apply id="S4.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3.2">𝑤</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><ci id="S4.E6.m1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.3">𝛿</ci></apply><apply id="S4.E6.m1.3.3.3.cmml" xref="S4.E6.m1.3.3.3"><times id="S4.E6.m1.3.3.3.3.cmml" xref="S4.E6.m1.3.3.3.3"></times><apply id="S4.E6.m1.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.1"><times id="S4.E6.m1.2.2.2.1.2.cmml" xref="S4.E6.m1.2.2.2.1.2"></times><apply id="S4.E6.m1.2.2.2.1.1.cmml" xref="S4.E6.m1.2.2.2.1.1"><times id="S4.E6.m1.2.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.2.1.1.2"></times><ci id="S4.E6.m1.2.2.2.1.1.3a.cmml" xref="S4.E6.m1.2.2.2.1.1.3"><mtext id="S4.E6.m1.2.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.2.1.1.3">count</mtext></ci><apply id="S4.E6.m1.2.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.1.2">𝑤</ci><ci id="S4.E6.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.2.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S4.E6.m1.2.2.2.1.3a.cmml" xref="S4.E6.m1.2.2.2.1.3"><mtext id="S4.E6.m1.2.2.2.1.3.cmml" xref="S4.E6.m1.2.2.2.1.3">count</mtext></ci></apply><apply id="S4.E6.m1.3.3.3.2.1.1.cmml" xref="S4.E6.m1.3.3.3.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.3.2.1.1.1.cmml" xref="S4.E6.m1.3.3.3.2.1">subscript</csymbol><ci id="S4.E6.m1.3.3.3.2.1.1.2.cmml" xref="S4.E6.m1.3.3.3.2.1.1.2">𝑤</ci><ci id="S4.E6.m1.3.3.3.2.1.1.3.cmml" xref="S4.E6.m1.3.3.3.2.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex">\textrm{score}(w_{i},w_{j})=\frac{\textrm{count}(w_{i}w_{j})-\delta}{\textrm{count}(w_{i})\times\textrm{count}(w_{j})}.</annotation><annotation encoding="application/x-llamapun">score ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) = divide start_ARG count ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) - italic_δ end_ARG start_ARG count ( italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) × count ( italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG .</annotation></semantics></math></mjx-assistive-mml></mjx-container></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.p2.1" class="ltx_p">The <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="71" style="font-size: 121.4%; position: relative;"><mjx-math id="S4.p2.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S4.p2.1.m1.1a"><mjx-mi class="mjx-i" id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mjx-c class="mjx-c1D6FF TEX-I"></mjx-c></mjx-mi></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="\delta" display="inline" class="ltx_Math"><semantics><mi xref="S4.p2.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content"><ci xmlns="http://www.w3.org/1998/Math/MathML" id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex">\delta</annotation><annotation encoding="application/x-llamapun">italic_δ</annotation></semantics></math></mjx-assistive-mml></mjx-container> is used as a discounting coefficient and prevents too many
phrases consisting of very infrequent words to be formed.
The bigrams with score above the chosen threshold are then used as phrases.
Typically, we run 2-4 passes over the training data with decreasing
threshold value, allowing longer phrases that consists of several words to be formed.
We evaluate the quality of the phrase representations using a new analogical
reasoning task that involves phrases. Table&nbsp;<a href="#S4.T2" title="Table 2 ‣ 4 Learning Phrases ‣ Distributed Representations of Words and Phrases and their Compositionality" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows
examples of the five categories of analogies used in this task. This dataset is publicly available
on the web<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a href="code.google.com/p/word2vec/source/browse/trunk/questions-phrases.txt" title="" class="ltx_ref ltx_url ltx_font_typewriter">code.google.com/p/word2vec/source/browse/trunk/questions-phrases.txt</a></span></span></span>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="4">Newspapers</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<th id="S4.T2.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_t">New York</th>
<td id="S4.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">New York Times</td>
<th id="S4.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Baltimore</th>
<td id="S4.T2.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Baltimore Sun</td>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<th id="S4.T2.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l">San Jose</th>
<td id="S4.T2.1.3.2.2" class="ltx_td ltx_align_center ltx_border_rr">San Jose Mercury News</td>
<th id="S4.T2.1.3.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row">Cincinnati</th>
<td id="S4.T2.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r">Cincinnati Enquirer</td>
</tr>
<tr id="S4.T2.1.4.3" class="ltx_tr">
<th id="S4.T2.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="4">NHL Teams</th>
</tr>
<tr id="S4.T2.1.5.4" class="ltx_tr">
<th id="S4.T2.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_t">Boston</th>
<td id="S4.T2.1.5.4.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Boston Bruins</td>
<th id="S4.T2.1.5.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Montreal</th>
<td id="S4.T2.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Montreal Canadiens</td>
</tr>
<tr id="S4.T2.1.6.5" class="ltx_tr">
<th id="S4.T2.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l">Phoenix</th>
<td id="S4.T2.1.6.5.2" class="ltx_td ltx_align_center ltx_border_rr">Phoenix Coyotes</td>
<th id="S4.T2.1.6.5.3" class="ltx_td ltx_align_center ltx_th ltx_th_row">Nashville</th>
<td id="S4.T2.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r">Nashville Predators</td>
</tr>
<tr id="S4.T2.1.7.6" class="ltx_tr">
<th id="S4.T2.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="4">NBA Teams</th>
</tr>
<tr id="S4.T2.1.8.7" class="ltx_tr">
<th id="S4.T2.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_t">Detroit</th>
<td id="S4.T2.1.8.7.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Detroit Pistons</td>
<th id="S4.T2.1.8.7.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Toronto</th>
<td id="S4.T2.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Toronto Raptors</td>
</tr>
<tr id="S4.T2.1.9.8" class="ltx_tr">
<th id="S4.T2.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l">Oakland</th>
<td id="S4.T2.1.9.8.2" class="ltx_td ltx_align_center ltx_border_rr">Golden State Warriors</td>
<th id="S4.T2.1.9.8.3" class="ltx_td ltx_align_center ltx_th ltx_th_row">Memphis</th>
<td id="S4.T2.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r">Memphis Grizzlies</td>
</tr>
<tr id="S4.T2.1.10.9" class="ltx_tr">
<th id="S4.T2.1.10.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="4">Airlines</th>
</tr>
<tr id="S4.T2.1.11.10" class="ltx_tr">
<th id="S4.T2.1.11.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_t">Austria</th>
<td id="S4.T2.1.11.10.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Austrian Airlines</td>
<th id="S4.T2.1.11.10.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Spain</th>
<td id="S4.T2.1.11.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Spainair</td>
</tr>
<tr id="S4.T2.1.12.11" class="ltx_tr">
<th id="S4.T2.1.12.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l">Belgium</th>
<td id="S4.T2.1.12.11.2" class="ltx_td ltx_align_center ltx_border_rr">Brussels Airlines</td>
<th id="S4.T2.1.12.11.3" class="ltx_td ltx_align_center ltx_th ltx_th_row">Greece</th>
<td id="S4.T2.1.12.11.4" class="ltx_td ltx_align_center ltx_border_r">Aegean Airlines</td>
</tr>
<tr id="S4.T2.1.13.12" class="ltx_tr">
<th id="S4.T2.1.13.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" colspan="4">Company executives</th>
</tr>
<tr id="S4.T2.1.14.13" class="ltx_tr">
<th id="S4.T2.1.14.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_t">Steve Ballmer</th>
<td id="S4.T2.1.14.13.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t">Microsoft</td>
<th id="S4.T2.1.14.13.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Larry Page</th>
<td id="S4.T2.1.14.13.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Google</td>
</tr>
<tr id="S4.T2.1.15.14" class="ltx_tr">
<th id="S4.T2.1.15.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l">Samuel J. Palmisano</th>
<td id="S4.T2.1.15.14.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr">IBM</td>
<th id="S4.T2.1.15.14.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b">Werner Vogels</th>
<td id="S4.T2.1.15.14.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Amazon</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>
 Examples of the
analogical reasoning task for phrases (the full test set has 3218 examples).
The goal is to compute the fourth phrase using the first three. Our best model achieved an accuracy of 72% on this dataset.</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Phrase Skip-Gram Results</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Starting with the same news data as in the previous experiments,
we first constructed the phrase based training corpus and then we trained several
Skip-gram models using different hyper-parameters. As before, we used vector
dimensionality 300 and context size 5. This
setting already achieves good performance on the phrase
dataset, and allowed us to quickly compare the Negative Sampling
and the Hierarchical Softmax, both with and without subsampling
of the frequent tokens. The results are summarized in Table&nbsp;<a href="#S4.T3" title="Table 3 ‣ 4.1 Phrase Skip-Gram Results ‣ 4 Learning Phrases ‣ Distributed Representations of Words and Phrases and their Compositionality" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1" class="ltx_tr">
<th id="S4.T3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Method</th>
<th id="S4.T3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Dimensionality</th>
<th id="S4.T3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">No subsampling [%]</th>
<th id="S4.T3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">
<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="72" style="font-size: 113.1%; position: relative;"><mjx-math id="S4.T3.1.1.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S4.T3.1.1.1.m1.1a"><mjx-msup id="S4.T3.1.1.1.m1.1.1" xref="S4.T3.1.1.1.m1.1.1.cmml"><mjx-mn class="mjx-n" id="S4.T3.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.m1.1.1.2.cmml"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mrow size="s" id="S4.T3.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.m1.1.1.3.cmml"><mjx-mo class="mjx-n" id="S4.T3.1.1.1.m1.1.1.3a" xref="S4.T3.1.1.1.m1.1.1.3.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S4.T3.1.1.1.m1.1.1.3.2" xref="S4.T3.1.1.1.m1.1.1.3.2.cmml"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-mrow></mjx-script></mjx-msup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="10^{-5}" display="inline" class="ltx_Math"><semantics><msup xref="S4.T3.1.1.1.m1.1.1.cmml"><mn xref="S4.T3.1.1.1.m1.1.1.2.cmml">10</mn><mrow xref="S4.T3.1.1.1.m1.1.1.3.cmml"><mo xref="S4.T3.1.1.1.m1.1.1.3.cmml">−</mo><mn xref="S4.T3.1.1.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S4.T3.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T3.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.m1.1.1.2">10</cn><apply id="S4.T3.1.1.1.m1.1.1.3.cmml" xref="S4.T3.1.1.1.m1.1.1.3"><minus id="S4.T3.1.1.1.m1.1.1.3.1.cmml" xref="S4.T3.1.1.1.m1.1.1.3"></minus><cn type="integer" id="S4.T3.1.1.1.m1.1.1.3.2.cmml" xref="S4.T3.1.1.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex">10^{-5}</annotation><annotation encoding="application/x-llamapun">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> subsampling [%]</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<th id="S4.T3.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">NEG-5</th>
<td id="S4.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">300</td>
<td id="S4.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24</td>
<td id="S4.T3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">27</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<th id="S4.T3.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r">NEG-15</th>
<td id="S4.T3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">300</td>
<td id="S4.T3.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r">27</td>
<td id="S4.T3.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r">42</td>
</tr>
<tr id="S4.T3.1.4.3" class="ltx_tr">
<th id="S4.T3.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">HS-Huffman</th>
<td id="S4.T3.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">300</td>
<td id="S4.T3.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">19</td>
<td id="S4.T3.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r"><span id="S4.T3.1.4.3.4.1" class="ltx_text ltx_font_bold">47</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>

Accuracies of the Skip-gram models on the phrase analogy dataset. The models were
trained on approximately one billion words from the news dataset.</figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.2" class="ltx_p">The results show that while Negative Sampling achieves a respectable
accuracy even with <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="73" style="font-size: 121.4%; position: relative;"><mjx-math id="S4.SS1.p2.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S4.SS1.p2.1.m1.1a"><mjx-mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mjx-mi class="mjx-i" id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4" id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4" id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k=5" display="inline" class="ltx_Math"><semantics><mrow xref="S4.SS1.p2.1.m1.1.1.cmml"><mi xref="S4.SS1.p2.1.m1.1.1.2.cmml">k</mi><mo xref="S4.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn xref="S4.SS1.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></eq><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑘</ci><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex">k=5</annotation><annotation encoding="application/x-llamapun">italic_k = 5</annotation></semantics></math></mjx-assistive-mml></mjx-container>, using <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="74" style="font-size: 121.4%; position: relative;"><mjx-math id="S4.SS1.p2.2.m2.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S4.SS1.p2.2.m2.1a"><mjx-mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mjx-mi class="mjx-i" id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4" id="S4.SS1.p2.2.m2.1.1.1" xref="S4.SS1.p2.2.m2.1.1.1.cmml"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4" id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-mrow></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="k=15" display="inline" class="ltx_Math"><semantics><mrow xref="S4.SS1.p2.2.m2.1.1.cmml"><mi xref="S4.SS1.p2.2.m2.1.1.2.cmml">k</mi><mo xref="S4.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn xref="S4.SS1.p2.2.m2.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><eq id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></eq><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑘</ci><cn type="integer" id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex">k=15</annotation><annotation encoding="application/x-llamapun">italic_k = 15</annotation></semantics></math></mjx-assistive-mml></mjx-container> achieves considerably better
performance. Surprisingly, while we found the Hierarchical Softmax to
achieve lower performance when trained without subsampling,
it became the best performing method when we
downsampled the frequent words. This shows that the subsampling
can result in faster training and can also improve accuracy, at least in some cases.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p">To maximize the accuracy on the phrase analogy task, we increased
the amount of the training data by using a dataset with about 33 billion words. We
used the hierarchical softmax, dimensionality of 1000, and
the entire sentence for the context.
This resulted in a model that reached an accuracy of <span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">72%</span>. We achieved lower accuracy
66% when we reduced the size of the training dataset to 6B words, which suggests
that the large amount of the training data is crucial.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">To gain further insight into how different the representations learned by different
models are, we did inspect manually the nearest neighbours of infrequent phrases
using various models. In Table&nbsp;<a href="#S4.T4" title="Table 4 ‣ 4.1 Phrase Skip-Gram Results ‣ 4 Learning Phrases ‣ Distributed Representations of Words and Phrases and their Compositionality" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we show a sample of such comparison.
Consistently with the previous results, it seems that the best representations of
phrases are learned by a model with the hierarchical softmax and subsampling.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.2.2" class="ltx_tr">
<th id="S4.T4.2.2.3" class="ltx_td ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S4.T4.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">NEG-15 with <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="75" style="font-size: 113.1%; position: relative;"><mjx-math id="S4.T4.1.1.1.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S4.T4.1.1.1.m1.1a"><mjx-msup id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml"><mjx-mn class="mjx-n" id="S4.T4.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.m1.1.1.2.cmml"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mrow size="s" id="S4.T4.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.m1.1.1.3.cmml"><mjx-mo class="mjx-n" id="S4.T4.1.1.1.m1.1.1.3a" xref="S4.T4.1.1.1.m1.1.1.3.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S4.T4.1.1.1.m1.1.1.3.2" xref="S4.T4.1.1.1.m1.1.1.3.2.cmml"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-mrow></mjx-script></mjx-msup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="10^{-5}" display="inline" class="ltx_Math"><semantics><msup xref="S4.T4.1.1.1.m1.1.1.cmml"><mn xref="S4.T4.1.1.1.m1.1.1.2.cmml">10</mn><mrow xref="S4.T4.1.1.1.m1.1.1.3.cmml"><mo xref="S4.T4.1.1.1.m1.1.1.3.cmml">−</mo><mn xref="S4.T4.1.1.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T4.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.m1.1.1.2">10</cn><apply id="S4.T4.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.m1.1.1.3"><minus id="S4.T4.1.1.1.m1.1.1.3.1.cmml" xref="S4.T4.1.1.1.m1.1.1.3"></minus><cn type="integer" id="S4.T4.1.1.1.m1.1.1.3.2.cmml" xref="S4.T4.1.1.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex">10^{-5}</annotation><annotation encoding="application/x-llamapun">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> subsampling</th>
<th id="S4.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">HS with <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="76" style="font-size: 113.1%; position: relative;"><mjx-math id="S4.T4.2.2.2.m1.1" class="ltx_Math MJX-TEX" aria-hidden="true"><mjx-semantics id="S4.T4.2.2.2.m1.1a"><mjx-msup id="S4.T4.2.2.2.m1.1.1" xref="S4.T4.2.2.2.m1.1.1.cmml"><mjx-mn class="mjx-n" id="S4.T4.2.2.2.m1.1.1.2" xref="S4.T4.2.2.2.m1.1.1.2.cmml"><mjx-c class="mjx-c31"></mjx-c><mjx-c class="mjx-c30"></mjx-c></mjx-mn><mjx-script style="vertical-align: 0.393em;"><mjx-mrow size="s" id="S4.T4.2.2.2.m1.1.1.3" xref="S4.T4.2.2.2.m1.1.1.3.cmml"><mjx-mo class="mjx-n" id="S4.T4.2.2.2.m1.1.1.3a" xref="S4.T4.2.2.2.m1.1.1.3.cmml"><mjx-c class="mjx-c2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n" id="S4.T4.2.2.2.m1.1.1.3.2" xref="S4.T4.2.2.2.m1.1.1.3.2.cmml"><mjx-c class="mjx-c35"></mjx-c></mjx-mn></mjx-mrow></mjx-script></mjx-msup></mjx-semantics></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML" alttext="10^{-5}" display="inline" class="ltx_Math"><semantics><msup xref="S4.T4.2.2.2.m1.1.1.cmml"><mn xref="S4.T4.2.2.2.m1.1.1.2.cmml">10</mn><mrow xref="S4.T4.2.2.2.m1.1.1.3.cmml"><mo xref="S4.T4.2.2.2.m1.1.1.3.cmml">−</mo><mn xref="S4.T4.2.2.2.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content"><apply xmlns="http://www.w3.org/1998/Math/MathML" id="S4.T4.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.2.2.2.m1.1.1.1.cmml" xref="S4.T4.2.2.2.m1.1.1">superscript</csymbol><cn type="integer" id="S4.T4.2.2.2.m1.1.1.2.cmml" xref="S4.T4.2.2.2.m1.1.1.2">10</cn><apply id="S4.T4.2.2.2.m1.1.1.3.cmml" xref="S4.T4.2.2.2.m1.1.1.3"><minus id="S4.T4.2.2.2.m1.1.1.3.1.cmml" xref="S4.T4.2.2.2.m1.1.1.3"></minus><cn type="integer" id="S4.T4.2.2.2.m1.1.1.3.2.cmml" xref="S4.T4.2.2.2.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex">10^{-5}</annotation><annotation encoding="application/x-llamapun">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math></mjx-assistive-mml></mjx-container> subsampling</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.2.3.1" class="ltx_tr">
<td id="S4.T4.2.3.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Vasco de Gama</td>
<td id="S4.T4.2.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Lingsugur</td>
<td id="S4.T4.2.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Italian explorer</td>
</tr>
<tr id="S4.T4.2.4.2" class="ltx_tr">
<td id="S4.T4.2.4.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">Lake Baikal</td>
<td id="S4.T4.2.4.2.2" class="ltx_td ltx_align_center ltx_border_r">Great Rift Valley</td>
<td id="S4.T4.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r">Aral Sea</td>
</tr>
<tr id="S4.T4.2.5.3" class="ltx_tr">
<td id="S4.T4.2.5.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">Alan Bean</td>
<td id="S4.T4.2.5.3.2" class="ltx_td ltx_align_center ltx_border_r">Rebbeca Naomi</td>
<td id="S4.T4.2.5.3.3" class="ltx_td ltx_align_center ltx_border_r">moonwalker</td>
</tr>
<tr id="S4.T4.2.6.4" class="ltx_tr">
<td id="S4.T4.2.6.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">Ionian Sea</td>
<td id="S4.T4.2.6.4.2" class="ltx_td ltx_align_center ltx_border_r">Ruegen</td>
<td id="S4.T4.2.6.4.3" class="ltx_td ltx_align_center ltx_border_r">Ionian Islands</td>
</tr>
<tr id="S4.T4.2.7.5" class="ltx_tr">
<td id="S4.T4.2.7.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r">chess master</td>
<td id="S4.T4.2.7.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">chess grandmaster</td>
<td id="S4.T4.2.7.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Garry Kasparov</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span> Examples of the closest entities to the given short phrases, using two different models.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Additive Compositionality</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">We demonstrated that the word and phrase representations learned by the Skip-gram
model exhibit a linear structure that makes it possible to perform
precise analogical reasoning using simple vector arithmetics.
Interestingly, we found that the Skip-gram representations exhibit
another kind of linear structure that makes it possible to meaningfully combine
words by an element-wise addition of their vector representations.
This phenomenon is illustrated in Table&nbsp;<a href="#S5.T5" title="Table 5 ‣ 5 Additive Compositionality ‣ Distributed Representations of Words and Phrases and their Compositionality" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.
</p>
</div>
<figure id="S5.T5" class="ltx_table">
<table id="S5.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.1.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t">Czech + currency</th>
<th id="S5.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Vietnam + capital</th>
<th id="S5.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">German + airlines</th>
<th id="S5.T5.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Russian + river</th>
<th id="S5.T5.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">French + actress</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.1.2.1" class="ltx_tr">
<td id="S5.T5.1.2.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">koruna</td>
<td id="S5.T5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Hanoi</td>
<td id="S5.T5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">airline Lufthansa</td>
<td id="S5.T5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Moscow</td>
<td id="S5.T5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Juliette Binoche</td>
</tr>
<tr id="S5.T5.1.3.2" class="ltx_tr">
<td id="S5.T5.1.3.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">Check crown</td>
<td id="S5.T5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">Ho Chi Minh City</td>
<td id="S5.T5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r">carrier Lufthansa</td>
<td id="S5.T5.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r">Volga River</td>
<td id="S5.T5.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r">Vanessa Paradis</td>
</tr>
<tr id="S5.T5.1.4.3" class="ltx_tr">
<td id="S5.T5.1.4.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">Polish zolty</td>
<td id="S5.T5.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">Viet Nam</td>
<td id="S5.T5.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r">flag carrier Lufthansa</td>
<td id="S5.T5.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r">upriver</td>
<td id="S5.T5.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r">Charlotte Gainsbourg</td>
</tr>
<tr id="S5.T5.1.5.4" class="ltx_tr">
<td id="S5.T5.1.5.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r">CTK</td>
<td id="S5.T5.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Vietnamese</td>
<td id="S5.T5.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Lufthansa</td>
<td id="S5.T5.1.5.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Russia</td>
<td id="S5.T5.1.5.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Cecile De</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span> Vector compositionality using element-wise addition. Four closest tokens to the sum
of two vectors are shown, using the best Skip-gram model.</figcaption>
</figure>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p">The additive property of the vectors can be explained by inspecting the
training objective.
The word vectors are in a linear relationship with the inputs
to the softmax nonlinearity.
As the word vectors are trained
to predict the surrounding words in the sentence, the vectors
can be seen as representing the distribution of the context in which a word
appears. These values are related logarithmically to the probabilities
computed by the output layer, so the sum of two word vectors is related to
the product of the two context distributions.
The product works here as the AND function: words that are
assigned high probabilities by both word vectors will have high probability, and
the other words will have low probability.
Thus, if “Volga River” appears frequently in the same sentence together
with the words “Russian” and “river”, the sum of these two word vectors
will result in such a feature vector that is close to the vector of “Volga River”.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Comparison to Published Word Representations</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">Many authors who previously worked on the neural network based representations of words have published their resulting
models for further use and comparison: amongst the most well known authors
are Collobert and Weston&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, Turian et al.&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>,
and Mnih and Hinton&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. We downloaded their word vectors from
the web<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="http://metaoptimize.com/projects/wordreprs/" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://metaoptimize.com/projects/wordreprs/</a></span></span></span>. Mikolov et al.&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> have already evaluated these word representations on the word analogy task,
where the Skip-gram models achieved the best performance with a huge margin.</p>
</div>
<div id="S6.p2" class="ltx_para ltx_noindent">
<p id="S6.p2.1" class="ltx_p">To give more insight into the difference of the quality of the learned
vectors, we provide empirical comparison by showing the nearest neighbours of infrequent
words in Table&nbsp;<a href="#S6.T6" title="Table 6 ‣ 6 Comparison to Published Word Representations ‣ Distributed Representations of Words and Phrases and their Compositionality" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. These examples show that the big Skip-gram model trained on a large
corpus visibly outperforms all the other models in the quality of the learned representations.
This can be attributed in part to the fact that this model
has been trained on about 30 billion words, which is about two to three orders of magnitude more data than
the typical size used in the prior work. Interestingly, although the training set is much larger,
the training time of the Skip-gram model is just a fraction
of the time complexity required by the previous model architectures.</p>
</div>
<figure id="S6.T6" class="ltx_table">
<table id="S6.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T6.1.1.1" class="ltx_tr">
<th id="S6.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_rr ltx_border_t">Model</th>
<th id="S6.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Redmond</th>
<th id="S6.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">Havel</th>
<th id="S6.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">ninjutsu</th>
<th id="S6.T6.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">graffiti</th>
<th id="S6.T6.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t">capitulate</th>
</tr>
<tr id="S6.T6.1.2.2" class="ltx_tr">
<th id="S6.T6.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_rr">(training time)</th>
<th id="S6.T6.1.2.2.2" class="ltx_td ltx_th ltx_th_column ltx_border_r"></th>
<th id="S6.T6.1.2.2.3" class="ltx_td ltx_th ltx_th_column ltx_border_r"></th>
<th id="S6.T6.1.2.2.4" class="ltx_td ltx_th ltx_th_column ltx_border_r"></th>
<th id="S6.T6.1.2.2.5" class="ltx_td ltx_th ltx_th_column ltx_border_r"></th>
<th id="S6.T6.1.2.2.6" class="ltx_td ltx_th ltx_th_column ltx_border_r"></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T6.1.3.1" class="ltx_tr">
<th id="S6.T6.1.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_rr ltx_border_tt">Collobert (50d)</th>
<td id="S6.T6.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">conyers</td>
<td id="S6.T6.1.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">plauen</td>
<td id="S6.T6.1.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">reiki</td>
<td id="S6.T6.1.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">cheesecake</td>
<td id="S6.T6.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">abdicate</td>
</tr>
<tr id="S6.T6.1.4.2" class="ltx_tr">
<th id="S6.T6.1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_rr">(2 months)</th>
<td id="S6.T6.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">lubbock</td>
<td id="S6.T6.1.4.2.3" class="ltx_td ltx_align_center ltx_border_r">dzerzhinsky</td>
<td id="S6.T6.1.4.2.4" class="ltx_td ltx_align_center ltx_border_r">kohona</td>
<td id="S6.T6.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r">gossip</td>
<td id="S6.T6.1.4.2.6" class="ltx_td ltx_align_center ltx_border_r">accede</td>
</tr>
<tr id="S6.T6.1.5.3" class="ltx_tr">
<th id="S6.T6.1.5.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_rr"></th>
<td id="S6.T6.1.5.3.2" class="ltx_td ltx_align_center ltx_border_r">keene</td>
<td id="S6.T6.1.5.3.3" class="ltx_td ltx_align_center ltx_border_r">osterreich</td>
<td id="S6.T6.1.5.3.4" class="ltx_td ltx_align_center ltx_border_r">karate</td>
<td id="S6.T6.1.5.3.5" class="ltx_td ltx_align_center ltx_border_r">dioramas</td>
<td id="S6.T6.1.5.3.6" class="ltx_td ltx_align_center ltx_border_r">rearm</td>
</tr>
<tr id="S6.T6.1.6.4" class="ltx_tr">
<th id="S6.T6.1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_rr ltx_border_t">Turian (200d)</th>
<td id="S6.T6.1.6.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">McCarthy</td>
<td id="S6.T6.1.6.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Jewell</td>
<td id="S6.T6.1.6.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S6.T6.1.6.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">gunfire</td>
<td id="S6.T6.1.6.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
</tr>
<tr id="S6.T6.1.7.5" class="ltx_tr">
<th id="S6.T6.1.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_rr">(few weeks)</th>
<td id="S6.T6.1.7.5.2" class="ltx_td ltx_align_center ltx_border_r">Alston</td>
<td id="S6.T6.1.7.5.3" class="ltx_td ltx_align_center ltx_border_r">Arzu</td>
<td id="S6.T6.1.7.5.4" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S6.T6.1.7.5.5" class="ltx_td ltx_align_center ltx_border_r">emotion</td>
<td id="S6.T6.1.7.5.6" class="ltx_td ltx_align_center ltx_border_r">-</td>
</tr>
<tr id="S6.T6.1.8.6" class="ltx_tr">
<th id="S6.T6.1.8.6.1" class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_rr"></th>
<td id="S6.T6.1.8.6.2" class="ltx_td ltx_align_center ltx_border_r">Cousins</td>
<td id="S6.T6.1.8.6.3" class="ltx_td ltx_align_center ltx_border_r">Ovitz</td>
<td id="S6.T6.1.8.6.4" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S6.T6.1.8.6.5" class="ltx_td ltx_align_center ltx_border_r">impunity</td>
<td id="S6.T6.1.8.6.6" class="ltx_td ltx_align_center ltx_border_r">-</td>
</tr>
<tr id="S6.T6.1.9.7" class="ltx_tr">
<th id="S6.T6.1.9.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_rr ltx_border_t">Mnih (100d)</th>
<td id="S6.T6.1.9.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Podhurst</td>
<td id="S6.T6.1.9.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Pontiff</td>
<td id="S6.T6.1.9.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S6.T6.1.9.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">anaesthetics</td>
<td id="S6.T6.1.9.7.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mavericks</td>
</tr>
<tr id="S6.T6.1.10.8" class="ltx_tr">
<th id="S6.T6.1.10.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_rr">(7 days)</th>
<td id="S6.T6.1.10.8.2" class="ltx_td ltx_align_center ltx_border_r">Harlang</td>
<td id="S6.T6.1.10.8.3" class="ltx_td ltx_align_center ltx_border_r">Pinochet</td>
<td id="S6.T6.1.10.8.4" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S6.T6.1.10.8.5" class="ltx_td ltx_align_center ltx_border_r">monkeys</td>
<td id="S6.T6.1.10.8.6" class="ltx_td ltx_align_center ltx_border_r">planning</td>
</tr>
<tr id="S6.T6.1.11.9" class="ltx_tr">
<th id="S6.T6.1.11.9.1" class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_rr"></th>
<td id="S6.T6.1.11.9.2" class="ltx_td ltx_align_center ltx_border_r">Agarwal</td>
<td id="S6.T6.1.11.9.3" class="ltx_td ltx_align_center ltx_border_r">Rodionov</td>
<td id="S6.T6.1.11.9.4" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S6.T6.1.11.9.5" class="ltx_td ltx_align_center ltx_border_r">Jews</td>
<td id="S6.T6.1.11.9.6" class="ltx_td ltx_align_center ltx_border_r">hesitated</td>
</tr>
<tr id="S6.T6.1.12.10" class="ltx_tr">
<th id="S6.T6.1.12.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_rr ltx_border_t">Skip-Phrase</th>
<td id="S6.T6.1.12.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Redmond Wash.</td>
<td id="S6.T6.1.12.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Vaclav Havel</td>
<td id="S6.T6.1.12.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">ninja</td>
<td id="S6.T6.1.12.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">spray paint</td>
<td id="S6.T6.1.12.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">capitulation</td>
</tr>
<tr id="S6.T6.1.13.11" class="ltx_tr">
<th id="S6.T6.1.13.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_rr">(1000d, 1 day)</th>
<td id="S6.T6.1.13.11.2" class="ltx_td ltx_align_center ltx_border_r">Redmond Washington</td>
<td id="S6.T6.1.13.11.3" class="ltx_td ltx_align_center ltx_border_r">president Vaclav Havel</td>
<td id="S6.T6.1.13.11.4" class="ltx_td ltx_align_center ltx_border_r">martial arts</td>
<td id="S6.T6.1.13.11.5" class="ltx_td ltx_align_center ltx_border_r">grafitti</td>
<td id="S6.T6.1.13.11.6" class="ltx_td ltx_align_center ltx_border_r">capitulated</td>
</tr>
<tr id="S6.T6.1.14.12" class="ltx_tr">
<th id="S6.T6.1.14.12.1" class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_rr"></th>
<td id="S6.T6.1.14.12.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Microsoft</td>
<td id="S6.T6.1.14.12.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Velvet Revolution</td>
<td id="S6.T6.1.14.12.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">swordsmanship</td>
<td id="S6.T6.1.14.12.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">taggers</td>
<td id="S6.T6.1.14.12.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">capitulating</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span> Examples of the closest tokens given various
well known models and the Skip-gram model trained on phrases using over 30 billion training words. An empty cell
means that the word was not in the vocabulary.</figcaption>
</figure>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p id="S7.p1.1" class="ltx_p">This work has several key contributions. We show how to train distributed
representations of words and phrases with the Skip-gram model and demonstrate that these
representations exhibit linear structure that makes precise analogical reasoning
possible. The techniques introduced in this paper can be used also for training
the continuous bag-of-words model introduced in&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S7.p2" class="ltx_para ltx_noindent">
<p id="S7.p2.1" class="ltx_p">We successfully trained models on several orders of magnitude more data than
the previously published models, thanks to the computationally efficient model architecture.
This results in a great improvement in the quality of the learned word and phrase representations,
especially for the rare entities.
We also found that the subsampling of the frequent
words results in both faster training and significantly better representations of uncommon
words. Another contribution of our paper is the Negative sampling algorithm,
which is an extremely simple training method
that learns accurate representations especially for frequent words.</p>
</div>
<div id="S7.p3" class="ltx_para ltx_noindent">
<p id="S7.p3.1" class="ltx_p">The choice of the training algorithm and the hyper-parameter selection
is a task specific decision, as we found that different problems have
different optimal hyperparameter configurations. In our experiments,
the most crucial decisions that affect the performance are the choice of
the model architecture, the size of the vectors, the subsampling rate,
and the size of the training window.</p>
</div>
<div id="S7.p4" class="ltx_para ltx_noindent">
<p id="S7.p4.1" class="ltx_p">A very interesting result of this work is that the word vectors
can be somewhat meaningfully combined using
just simple vector addition. Another approach for learning representations
of phrases presented in this paper is to simply represent the phrases with a single
token. Combination of these two approaches gives a powerful yet simple way
how to represent longer pieces of text, while having minimal computational
complexity. Our work can thus be seen as complementary to the existing
approach that attempts to represent phrases using recursive
matrix-vector operations&nbsp;<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
<div id="S7.p5" class="ltx_para ltx_noindent">
<p id="S7.p5.1" class="ltx_p">We made the code for training the word and phrase vectors based on the techniques
described in this paper available as an open-source project<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a href="code.google.com/p/word2vec" title="" class="ltx_ref ltx_url ltx_font_typewriter">code.google.com/p/word2vec</a></span></span></span>.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Yoshua Bengio, Réjean Ducharme, Pascal Vincent, and Christian Janvin.

</span>
<span class="ltx_bibblock">A neural probabilistic language model.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">The Journal of Machine Learning Research</span>, 3:1137–1155, 2003.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Ronan Collobert and Jason Weston.

</span>
<span class="ltx_bibblock">A unified architecture for natural language processing: deep neural
networks with multitask learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Proceedings of the 25th international conference on Machine
learning</span>, pages 160–167. ACM, 2008.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Xavier Glorot, Antoine Bordes, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Domain adaptation for large-scale sentiment classification: A deep
learning approach.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">ICML</span>, 513–520, 2011.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Michael&nbsp;U Gutmann and Aapo Hyvärinen.

</span>
<span class="ltx_bibblock">Noise-contrastive estimation of unnormalized statistical models, with
applications to natural image statistics.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">The Journal of Machine Learning Research</span>, 13:307–361, 2012.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Tomas Mikolov, Stefan Kombrink, Lukas Burget, Jan Cernocky, and Sanjeev
Khudanpur.

</span>
<span class="ltx_bibblock">Extensions of recurrent neural network language model.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Acoustics, Speech and Signal Processing (ICASSP), 2011 IEEE
International Conference on</span>, pages 5528–5531. IEEE, 2011.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Tomas Mikolov, Anoop Deoras, Daniel Povey, Lukas Burget and Jan Cernocky.

</span>
<span class="ltx_bibblock">Strategies for Training Large Scale Neural Network Language Models.

</span>
<span class="ltx_bibblock">In Proc. <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Automatic Speech Recognition and Understanding</span>, 2011.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Tomas Mikolov.

</span>
<span class="ltx_bibblock">Statistical Language Models Based on Neural Networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">PhD thesis, PhD Thesis, Brno University of Technology</span>, 2012.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Tomas Mikolov, Kai Chen, Greg Corrado, and Jeffrey Dean.

</span>
<span class="ltx_bibblock">Efficient estimation of word representations in vector space.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">ICLR Workshop</span>, 2013.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Tomas Mikolov, Wen-tau Yih and Geoffrey Zweig.

</span>
<span class="ltx_bibblock">Linguistic Regularities in Continuous Space Word Representations.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Proceedings of NAACL HLT</span>, 2013.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Andriy Mnih and Geoffrey&nbsp;E Hinton.

</span>
<span class="ltx_bibblock">A scalable hierarchical distributed language model.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>,
21:1081–1088, 2009.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Andriy Mnih and Yee&nbsp;Whye Teh.

</span>
<span class="ltx_bibblock">A fast and simple algorithm for training neural probabilistic
language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1206.6426</span>, 2012.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Frederic Morin and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Hierarchical probabilistic neural network language model.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Proceedings of the international workshop on artificial
intelligence and statistics</span>, pages 246–252, 2005.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
David&nbsp;E Rumelhart, Geoffrey&nbsp;E Hintont, and Ronald&nbsp;J Williams.

</span>
<span class="ltx_bibblock">Learning representations by back-propagating errors.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Nature</span>, 323(6088):533–536, 1986.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Holger Schwenk.

</span>
<span class="ltx_bibblock">Continuous space language models.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Computer Speech and Language</span>, vol. 21, 2007.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Richard Socher, Cliff C. Lin, Andrew Y. Ng, and Christopher D. Manning.

</span>
<span class="ltx_bibblock">Parsing natural scenes and natural language with recursive neural
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the 26th International Conference on Machine
Learning (ICML)</span>, volume&nbsp;2, 2011.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Richard Socher, Brody Huval, Christopher D. Manning, and Andrew Y. Ng.

</span>
<span class="ltx_bibblock">Semantic Compositionality Through Recursive Matrix-Vector Spaces.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2012 Conference on Empirical Methods in Natural Language Processing (EMNLP)</span>, 2012.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Joseph Turian, Lev Ratinov, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Word representations: a simple and general method for semi-supervised
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Proceedings of the 48th Annual Meeting of the Association for
Computational Linguistics</span>, pages 384–394. Association for Computational
Linguistics, 2010.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Peter D. Turney and Patrick Pantel.

</span>
<span class="ltx_bibblock">From frequency to meaning: Vector space models of semantics.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Journal of Artificial Intelligence Research</span>, 37:141-188, 2010.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Peter D. Turney.

</span>
<span class="ltx_bibblock">Distributional semantics beyond words: Supervised learning of analogy and paraphrase.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Transactions of the Association for Computational Linguistics (TACL)</span>, 353–366, 2013.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Jason Weston, Samy Bengio, and Nicolas Usunier.

</span>
<span class="ltx_bibblock">Wsabie: Scaling up to large vocabulary image annotation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Proceedings of the Twenty-Second international joint
conference on Artificial Intelligence-Volume Volume Three</span>, pages 2764–2770.
AAAI Press, 2011.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1310.4545" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1310.4546" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&amp;title=Improve+article+1310.4546">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1310.4546" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1310.4547" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Dec 19 10:00:48 2022 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span style="font-size:70%;position:relative; bottom:2.2pt;">A</span>T<span style="position:relative; bottom:-0.4ex;">E</span></span><span class="ltx_font_smallcaps">xml</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    

</body></html>